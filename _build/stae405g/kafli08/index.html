<!DOCTYPE html>
<html class="writer-html5" lang="is" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>8. Jöfnuhneppi &mdash; Töluleg greining (STÆ405G) </title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/eqt.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/datacamp-custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/edbook.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_2.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/js/eqt.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
        <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

<script>
    // the buttonText string says what will be written on the 
    // sage cell evaluation button.
    // It can be changed here.
    var buttonText = "Keyra"
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sage",
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsage",
        languages: ["r"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osage",
        languages: ["octave"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAuto",
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAuto",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAuto",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAutoHidden",
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAutoHidden",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAutoHidden",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>


<style type="text/css">
    .sagecell .CodeMirror-scroll {
        overflow-y: hidden;
        overflow-x: auto;
    }
    
    .sagecell .CodeMirror {
        height: auto;
    }
</style>


    <link rel="index" title="Atriðaskrá" href="../genindex/" />
    <link rel="search" title="Leit" href="../search/" />
    <link rel="next" title="9. Eigingildisverkefni" href="../kafli09/" />
    <link rel="prev" title="7. Jaðargildisverkefni" href="../kafli07/" />  
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Töluleg greining (STÆ405G)
              <img src="../_static/haskoli_islands-edbook.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../kafli01/">1. Inngangur</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli02/">2. Núllstöðvar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli03/">3. Brúun</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli04/">4. Töluleg diffrun</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli05/">5. Töluleg heildun</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli06/">6. Upphafsgildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli07/">7. Jaðargildisverkefni</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8. Jöfnuhneppi</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#linuleg-jofnuhneppi">8.1. Línuleg jöfnuhneppi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#verkefni">8.1.1. Verkefnið</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lausnir">8.1.2. Lausnir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fjoldi-agera">8.1.3. Fjöldi aðgerða</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vandamal-me-stougleika">8.1.4. Vandamál með stöðugleika</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vending-e-pivoting">8.2. Vending (e. pivoting)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inngangur">8.2.1. Inngangur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hlutvending-e-partial-pivoting">8.2.2. Hlutvending (e. partial pivoting)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vankantar">8.2.3. Vankantar</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skolu-hlutvending-e-scaled-partial-pivoting">8.2.4. Sköluð hlutvending (e. scaled partial pivoting)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#athugasemd">8.2.5. Athugasemd</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fylkjastaall">8.3. Fylkjastaðall</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-maela-fjarlaeg-milli-hluta">8.3.1. Að mæla fjarlægð milli hluta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vigurstaall">8.3.2. Vigurstaðall</a></li>
<li class="toctree-l3"><a class="reference internal" href="#daemi-um-stala">8.3.3. Dæmi um staðla</a></li>
<li class="toctree-l3"><a class="reference internal" href="#index-7">8.3.4. Fylkjastaðall</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fylkjastaall-skilgreindur-ut-fra-vigurstali">8.3.5. Fylkjastaðall skilgreindur út frá vigurstaðli</a></li>
<li class="toctree-l3"><a class="reference internal" href="#daemi-um-fylkjastaal">8.3.6. Dæmi um fylkjastaðal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eigingildi">8.3.7. Eigingildi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rof-og-rofgeisli">8.3.8. Róf og rófgeisli</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setning-um-rofgeisla">8.3.9. Setning um rófgeisla</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#skekkjumat-og-astandstala">8.4. Skekkjumat og ástandstala</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hvernig-a-a-maela-skekkju">8.4.1. Hvernig á að mæla skekkju</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skekkjumat">8.4.2. Skekkjumat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#astandstala-fylkis-og-mat-a-hlutfallslegri-skekkju">8.4.3. Ástandstala fylkis og mat á hlutfallslegri skekkju</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ahrif-gagnaskekkju">8.4.4. Áhrif gagnaskekkju</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lu-attun">8.5. LU-þáttun</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nokkrar-skilgreiningar">8.5.1. Nokkrar skilgreiningar</a></li>
<li class="toctree-l3"><a class="reference internal" href="#urlausn-a-jofnuhneppi-me-nera-rihyrningsfylki">8.5.2. Úrlausn á jöfnuhneppi með neðra þríhyrningsfylki</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">8.5.3. Fjöldi aðgerða</a></li>
<li class="toctree-l3"><a class="reference internal" href="#urlausn-a-jofnuhneppi-me-efra-rihyrningsfylki">8.5.4. Úrlausn á jöfnuhneppi með efra þríhyrningsfylki</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linuagerir">8.5.5. Línuaðgerðir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ny-syn-a-gauss-eyingu">8.5.6. Ný sýn á Gauss-eyðingu</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nanar-um-m-i">8.5.7. Nánar um <span class="math notranslate nohighlight">\(M_i\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#index-15">8.5.8. LU-þáttun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lu-attun-og-skolu-hlutvending">8.5.9. <span class="math notranslate nohighlight">\(LU\)</span>-þáttun og sköluð hlutvending</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jofnuhneppi-leyst-me-lu-attun">8.5.10. Jöfnuhneppi leyst með LU-þáttun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fjoldi-reikniagera-fyrir-lu-attun">8.5.11. Fjöldi reikniaðgerða fyrir <span class="math notranslate nohighlight">\(LU\)</span>-þáttun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#morg-jofnuhneppi">8.5.12. Mörg jöfnuhneppi</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastapunktsaferir-fyrir-linuleg-jofnuhneppi">8.6. Fastapunktsaðferðir fyrir línuleg jöfnuhneppi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#itrekunaraferir-til-ess-a-leysa-linuleg-jofnuhneppi">8.6.1. Ítrekunaraðferðir til þess að leysa línuleg jöfnuhneppi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastapunktsitrekun-til-ess-a-leysa-linuleg-jofnuhneppi">8.6.2. Fastapunktsítrekun til þess að leysa línuleg jöfnuhneppi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastapunktsitrekun-skekkjumat">8.6.3. Fastapunktsítrekun - skekkjumat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skilyri-fyrir-samleitni">8.6.4. Skilyrði fyrir samleitni</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skiptingarafer-e-splitting-method">8.6.5. Skiptingaraðferð (e. splitting method)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jacobi-afer">8.6.6. Jacobi-aðferð</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gauss-seidel-afer">8.6.7. Gauss-Seidel-aðferð</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sor-afer-e-successive-over-relaxation">8.6.8. SOR-aðferð (e. successive over-relaxation)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setning-um-samleitni-gauss-seidel-aferarinnar">8.6.9. Setning um samleitni Gauss-Seidel-aðferðarinnar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#newton-afer-fyrir-jofnuhneppi">8.7. Newton-aðferð fyrir jöfnuhneppi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jacobi-fylki">8.7.1. Jacobi-fylki</a></li>
<li class="toctree-l3"><a class="reference internal" href="#afer-newtons-fyrir-hneppi">8.7.2. Aðferð Newtons fyrir hneppi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#matlab-forrit-fyrir-hneppi">8.7.3. Matlab-forrit fyrir hneppi</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kafli09/">9. Eigingildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli10/">10. Monte Carlo hermanir</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vidauki/">Viðauki</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Töluleg greining (STÆ405G)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">8. </span>Jöfnuhneppi</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/edbook/haskoli-islands/blob/master/projects/stae405g/kafli08.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="upphafsgildisverkefni"></span><section id="jofnuhneppi">
<span id="index-0"></span><h1><span class="section-number">8. </span>Jöfnuhneppi<a class="headerlink" href="#jofnuhneppi" title="Permalink to this heading"></a></h1>
<p><em>Why do you go away? So that you can come back. So that you can see the place you came from with new eyes and extra colors. And the people there see you differently, too. Coming back to where you started is not the same as never leaving.</em>
– Terry Pratchett</p>
<section id="linuleg-jofnuhneppi">
<h2><span class="section-number">8.1. </span>Línuleg jöfnuhneppi<a class="headerlink" href="#linuleg-jofnuhneppi" title="Permalink to this heading"></a></h2>
<section id="verkefni">
<h3><span class="section-number">8.1.1. </span>Verkefnið<a class="headerlink" href="#verkefni" title="Permalink to this heading"></a></h3>
<p>Verkefnið í þessum kafla er eftirfarandi.
Gefið <span class="math notranslate nohighlight">\(n\times n\)</span> fylki <span class="math notranslate nohighlight">\(A\)</span> og <span class="math notranslate nohighlight">\(n\)</span>-vigur
<span class="math notranslate nohighlight">\(\mbox{${\bf b}$}\)</span> þá leitum við að vigri <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span>
þannig að</p>
<div class="math notranslate nohighlight">
\[A\mbox{${\bf x}$}= \mbox{${\bf b}$}.\]</div>
</section>
<section id="lausnir">
<h3><span class="section-number">8.1.2. </span>Lausnir<a class="headerlink" href="#lausnir" title="Permalink to this heading"></a></h3>
<p>Við höfum almennt tvær leiðir til þess að leysa línuleg jöfnuhneppi:</p>
<ul>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_elimination">Gauss-eyðing</a> og innsetning.</p></li>
<li><p>Reikna andhverfu <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(A^{-1}\)</span>, en þá er</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}= A^{-1}\mbox{${\bf b}$}.\]</div>
</li>
</ul>
</section>
<section id="fjoldi-agera">
<span id="index-1"></span><h3><span class="section-number">8.1.3. </span>Fjöldi aðgerða<a class="headerlink" href="#fjoldi-agera" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Gauss-eyðing fyrir <span class="math notranslate nohighlight">\(n\times n\)</span> fylki krefst um það bil
<span class="math notranslate nohighlight">\(\frac 23n^3\)</span> reikniaðgerða.
Innsetningin krefst svo <span class="math notranslate nohighlight">\(n^2\)</span> aðgerða til viðbótar. Samanlagður
fjöldi aðgerða er því</p>
<div class="math notranslate nohighlight">
\[\frac 23n^3+\frac 32n^2 -\frac 76n.\]</div>
</li>
<li><p>Það að reikna <span class="math notranslate nohighlight">\(A^{-1}\)</span> krefst hins vegar <span class="math notranslate nohighlight">\(2n^3-2n^2+n\)</span>
aðgerða og margföldunin <span class="math notranslate nohighlight">\(A^{-1}b\)</span>, krefst <span class="math notranslate nohighlight">\(2n^2-n\)</span>
aðgerða til viðbótar. Samanlagður fjöldi aðgerða er því</p>
<div class="math notranslate nohighlight">
\[2n^3.\]</div>
</li>
</ul>
<p>Hér er greinilega gáfulegra að nota Gauss-eyðingu. Auk þess er ekki skynsamlegt
að ætla að reikna andhverfuna ef ákveða fylkisins er 0 eða nálægt 0.
Almennt þá forðumst við eins og mögulegt er að reikna <span class="math notranslate nohighlight">\(A^{-1}\)</span>.</p>
</section>
<section id="vandamal-me-stougleika">
<h3><span class="section-number">8.1.4. </span>Vandamál með stöðugleika<a class="headerlink" href="#vandamal-me-stougleika" title="Permalink to this heading"></a></h3>
<p>Skoðum jöfnuhneppið</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{ll}
\varepsilon&amp; 1\\
1 &amp; 1
\end{array}\right] \left[\begin{array}{l}
x_1\\
x_2
\end{array}\right]
=\left[\begin{array}{l}
1\\
2
\end{array}\right]\end{split}\]</div>
<p>Nákvæm lausn er <span class="math notranslate nohighlight">\(x_1=1+\frac{\varepsilon}{1-\varepsilon},
x_2=1-\frac{\varepsilon}{1-\varepsilon}\)</span>.</p>
<p>Ef hins vegar <span class="math notranslate nohighlight">\(\varepsilon\)</span> er minna en nákvæmnin í tölvunni sem
erum að vinna á, þá gefur Gauss-eyðing í tölvu, þar sem eytt er með
1. línu, svarið <span class="math notranslate nohighlight">\(x_1 = 0, x_2 = 1\)</span>.</p>
<p>Ef línunum væri víxlað, þá gæfi tölvan hins vegar <span class="math notranslate nohighlight">\(x_1=1, x_2=1\)</span>
sem er miklu nær réttu svari.</p>
<div class="admonition warning">
<p class="admonition-title">Aðvörun</p>
<p>Það er alveg ljóst að megum ekki framkvæma Gauss-eyðingu blindandi því
þá geta magnast upp styttingarskekkjur sem skemma lausnina okkar.</p>
</div>
</section>
</section>
<section id="vending-e-pivoting">
<span id="index-2"></span><h2><span class="section-number">8.2. </span>Vending (e. pivoting)<a class="headerlink" href="#vending-e-pivoting" title="Permalink to this heading"></a></h2>
<section id="inngangur">
<h3><span class="section-number">8.2.1. </span>Inngangur<a class="headerlink" href="#inngangur" title="Permalink to this heading"></a></h3>
<p>Það sem olli vandræðum í dæminu hér á undan var það að forystustuðull
fyrstu línunnar var hlutfallslega miklu minni en forystustuðull annarrar
línu.</p>
<p>Lausnin felst í því að víxla á línum þannig að við þurfum ekki að notast
við litla forystustuðla.</p>
</section>
<section id="hlutvending-e-partial-pivoting">
<span id="index-3"></span><h3><span class="section-number">8.2.2. </span>Hlutvending (e. partial pivoting)<a class="headerlink" href="#hlutvending-e-partial-pivoting" title="Permalink to this heading"></a></h3>
<p>Í grófum dráttum: Í umferð <span class="math notranslate nohighlight">\(i\)</span> í Gauss-eyðingunni þá athugum við
hvort tölugildi forystustuðla línanna fyrir neðan línu <span class="math notranslate nohighlight">\(i\)</span> eru
stærri en forystustuðull línu <span class="math notranslate nohighlight">\(i\)</span>, ef svo er þá víxlum við á
þeirri línu og línu <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Það er, í <span class="math notranslate nohighlight">\(i\)</span>-tu ítrun Gauss-eyðingar þá látum við
<span class="math notranslate nohighlight">\(M_i = \max_{i\leq j \leq n} |a_{ji}|\)</span>. Ef <span class="math notranslate nohighlight">\(|a_{ii}| &lt; M_i\)</span>
þá víxlum við á línu <span class="math notranslate nohighlight">\(i\)</span> og fyrstu línunni fyrir neðan sem hefur
forystustuðul með tölugildi jafnt og <span class="math notranslate nohighlight">\(M_i\)</span>. Það er, ef
<span class="math notranslate nohighlight">\(j_0 = \min\{ j ; i \leq j\leq n \text{ og } a_{ji} = M_i \}\)</span> þá
víxlum við á línu <span class="math notranslate nohighlight">\(i\)</span> og <span class="math notranslate nohighlight">\(j_0\)</span>.</p>
</section>
<section id="vankantar">
<h3><span class="section-number">8.2.3. </span>Vankantar<a class="headerlink" href="#vankantar" title="Permalink to this heading"></a></h3>
<p>Hlutvending virkar oft vel en getur búið til skekkju þar sem hún tekur
bara tillit til forystustuðlanna í hverri línu.</p>
<div class="daemi dropdown admonition">
<p class="admonition-title">Dæmi þar sem hlutvending virkar illa</p>
<blockquote>
<div><p>Ef jöfnuhneppið</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
0.7 x_1 + 1725 x_2 &amp;= 1739\\
0.4352 x_1 - 5.433 x_2 = 3.271
\end{aligned}\end{split}\]</div>
<p>er leyst með fjögra stafa nákvæmni og hlutvendingu þá fæst
<span class="math notranslate nohighlight">\(x_2=1.001\)</span> og <span class="math notranslate nohighlight">\(x_1=17.14\)</span> en rétt
svar er <span class="math notranslate nohighlight">\(x_2=1\)</span> og <span class="math notranslate nohighlight">\(x_1=20\)</span>. Það er því ljóst að hlutvending
tekst ekki alltaf til að halda skekkju í skefjum.</p>
</div></blockquote>
</div>
</section>
<section id="skolu-hlutvending-e-scaled-partial-pivoting">
<span id="index-4"></span><h3><span class="section-number">8.2.4. </span>Sköluð hlutvending (e. scaled partial pivoting)<a class="headerlink" href="#skolu-hlutvending-e-scaled-partial-pivoting" title="Permalink to this heading"></a></h3>
<p>Ein leið til að koma í veg fyrir þessi vandræði er sköluð hlutvending.</p>
<p>Skilgreinum vigurinn <span class="math notranslate nohighlight">\(\mbox{${\bf s}$}\)</span> sem heldur utan um
,,stærð‘‘ línanna í <span class="math notranslate nohighlight">\(A\)</span>,</p>
<div class="math notranslate nohighlight">
\[s_i = \max_{1\leq j \leq n} |a_{ij}|.\]</div>
<p>Látum dálkvigurinn <span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span> halda utan um það hvernig
við umröðum línunum í <span class="math notranslate nohighlight">\(A\)</span>. Byrjum með</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf r}$}= [1\ 2\ 3\ 4\ \ldots\ n]^T.\]</div>
</section>
<section id="athugasemd">
<h3><span class="section-number">8.2.5. </span>Athugasemd<a class="headerlink" href="#athugasemd" title="Permalink to this heading"></a></h3>
<p>Við munum uppfæra <span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span> eftir þörfum en breytum ekki
<span class="math notranslate nohighlight">\(\mbox{${\bf s}$}\)</span> (of dýrt ef <span class="math notranslate nohighlight">\(n\)</span> er stórt).</p>
<p>Í ítrun <span class="math notranslate nohighlight">\(i\)</span> þá látum við</p>
<div class="math notranslate nohighlight">
\[M_i = \max_{i \leq j \leq n} \frac{|a_{{r_j}i}|}{s_{r_j}},\]</div>
<p>og látum <span class="math notranslate nohighlight">\(j_0\)</span> vera minnsta <span class="math notranslate nohighlight">\(j\)</span> þannig að hámarkinu er náð,</p>
<div class="math notranslate nohighlight">
\[\frac{ |a_{r_{j_0}i}|}{s_{r_{j_0}}} = M_i.\]</div>
<p>Ef <span class="math notranslate nohighlight">\(i &lt; j_0\)</span> þá skiptum við á línum <span class="math notranslate nohighlight">\(i\)</span> og <span class="math notranslate nohighlight">\(j_0\)</span>, þ.e.</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf r}$}= [\ldots\ i\ \ldots\ j_0\ \ldots]^T \text{ breytist í }
\mbox{${\bf r}$}= [\ldots\ j_0\ \ldots\ i\ \ldots]^T.\]</div>
<p>Þannig að í ítrun <span class="math notranslate nohighlight">\(i\)</span> þá segir <span class="math notranslate nohighlight">\(i\)</span>-ta stakið í
<span class="math notranslate nohighlight">\(\bf r\)</span> okkur hvaða línu við eigum að eyða með.</p>
<div class="admonition warning">
<p class="admonition-title">Aðvörun</p>
<p>Athugið að hér umröðum við ekki línunum í fylkinu því það er miklu ódýrara
að nota vigurinn <span class="math notranslate nohighlight">\(\bf r\)</span> til þess að halda utanum í hvaða röð á
að framkvæma Gauss-eyðinguna.</p>
</div>
</section>
</section>
<section id="fylkjastaall">
<span id="index-5"></span><h2><span class="section-number">8.3. </span>Fylkjastaðall<a class="headerlink" href="#fylkjastaall" title="Permalink to this heading"></a></h2>
<section id="a-maela-fjarlaeg-milli-hluta">
<h3><span class="section-number">8.3.1. </span>Að mæla fjarlægð milli hluta<a class="headerlink" href="#a-maela-fjarlaeg-milli-hluta" title="Permalink to this heading"></a></h3>
<p>Á rauntalnalínunni þá mælum við fjarlægð með tölugildinu, þannig að
fjarlægðin á milli <span class="math notranslate nohighlight">\(x\)</span> og <span class="math notranslate nohighlight">\(y\)</span> er gefin með
<span class="math notranslate nohighlight">\(d(x,y)=|x-y|\)</span>.</p>
<p>Í <span class="math notranslate nohighlight">\(\mathbb R^n\)</span> þá finnst okkur evklíðski staðallinn
náttúrulegur, enda svarar hann til þess að mæla fjarlægð milli punkta
með reglustiku;</p>
<div class="math notranslate nohighlight">
\[d(\mbox{${\bf x}$},\mbox{${\bf y}$}) = \sqrt{ (x_1-y_1)^2 + \ldots + (x_n-y_n)^2 }.\]</div>
<p>Þetta er hins vegar ekki eina leiðin til þess mæla fjarlægð í
<span class="math notranslate nohighlight">\({\mathbb  R}^n\)</span> og, eins og við sjáum fljótlega, ekki endilega
réttari en aðrar aðferðir.</p>
<p>Almennt viljum við geta mælt ,,fjarlægð‘‘ á milli allra þeirra hluta
sem við erum skoða, hvort sem það eru margliður, föll eða fylki.
Tilgangurinn er að geta metið hversu langt nálgunin okkar er frá réttu
gildi og hversu stór skekkjan er í samanburði við stærð hlutarins sem
við erum að vinna með.</p>
</section>
<section id="vigurstaall">
<span id="vigurstadall"></span><span id="index-6"></span><h3><span class="section-number">8.3.2. </span>Vigurstaðall<a class="headerlink" href="#vigurstaall" title="Permalink to this heading"></a></h3>
<p>Fall <span class="math notranslate nohighlight">\(\| \cdot\|:{\mathbb  R}^n \to {\mathbb  R}\)</span> kallast
<em>vigurstaðall</em> (e. vector norm) ef fyrir öll
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$},\mbox{${\bf y}$}\in {\mathbb  R}^n\)</span> og
<span class="math notranslate nohighlight">\(\alpha \in {\mathbb  R}\)</span> gildir eftirfarandi:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\|\mbox{${\bf x}$}\| \geq 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\|\mbox{${\bf x}$}\| = 0\)</span> ef og aðeins ef
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}= 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\|\alpha\mbox{${\bf x}$}\| = |\alpha|\|\mbox{${\bf x}$}\|\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\|\mbox{${\bf x}$}+\mbox{${\bf y}$}\| \leq \|\mbox{${\bf x}$}\| + \|\mbox{${\bf y}$}\|\)</span></p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Athugasemd</p>
<p>Tölugildisfallið á <span class="math notranslate nohighlight">\({\mathbb  R}\)</span> er greinilega staðall.</p>
</div>
</section>
<section id="daemi-um-stala">
<h3><span class="section-number">8.3.3. </span>Dæmi um staðla<a class="headerlink" href="#daemi-um-stala" title="Permalink to this heading"></a></h3>
<ul>
<li><p><span class="math notranslate nohighlight">\(\ell_2\)</span> staðallinn: Einnig kallaður evklíðska fjarlægðin, er gefinn með</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\|\mbox{${\bf x}$}\|_2 = \left( \sum_{j=1}^n x_j^2 \right)^{\frac 12} =
\sqrt{\mbox   {${\bf x}$}\cdot \mbox{${\bf x}$}}.\]</div>
</div></blockquote>
</li>
<li><p><span class="math notranslate nohighlight">\(\ell_\infty\)</span> staðallinn:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\|\mbox{${\bf x}$}\|_\infty = \max_{1\leq j \leq n} |x_j|.\]</div>
</div></blockquote>
</li>
<li><p><span class="math notranslate nohighlight">\(\ell_p\)</span> staðlar: Almennt ef <span class="math notranslate nohighlight">\(1\leq p &lt; \infty\)</span> þá skilgreinum við</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\|\mbox{${\bf x}$}\|_p = \left( \sum_{j=1}^n |x_j|^p \right)^{\frac 1p}.\]</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="index-7">
<span id="id3"></span><h3><span class="section-number">8.3.4. </span>Fylkjastaðall<a class="headerlink" href="#index-7" title="Permalink to this heading"></a></h3>
<p><em>Fylkjastaðall</em> (e. matrix norm) er fall
<span class="math notranslate nohighlight">\(\|\cdot\|:{\mathbb  R}^{n\times n} \to {\mathbb  R}\)</span>, þannig að
fyrir öll <span class="math notranslate nohighlight">\(A,B \in {\mathbb  R}^{n\times n}\)</span> og
<span class="math notranslate nohighlight">\(\alpha \in {\mathbb  R}\)</span> gildir</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\|A\| \geq 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\|A\| = 0\)</span> ef og aðeins ef <span class="math notranslate nohighlight">\(A=0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\| \alpha A\| = |\alpha|\|A\|\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\|A+B\| \leq \|A\| + \|B\|\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\|AB\| \leq \|A\|\|B\|\)</span></p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Athugasemd</p>
<p>Ef þessi skilgreining er borin saman við skilgreininguna á <a class="reference internal" href="#vigurstadall"><span class="std std-ref">vigurstaðli</span></a>
fyrir vigurrúm þá sjáum við að eini raunverulegi munurinn er skilyrði 5.</p>
</div>
</section>
<section id="fylkjastaall-skilgreindur-ut-fra-vigurstali">
<span id="index-8"></span><h3><span class="section-number">8.3.5. </span>Fylkjastaðall skilgreindur út frá vigurstaðli<a class="headerlink" href="#fylkjastaall-skilgreindur-ut-fra-vigurstali" title="Permalink to this heading"></a></h3>
<p>Látum <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> vera vigurstaðal. Fallið
<span class="math notranslate nohighlight">\(\|\cdot\|:{\mathbb  R}^{n\times n} \to {\mathbb  R}\)</span> sem
skilgreint er með</p>
<div class="math notranslate nohighlight">
\[\|A\| = \max_{\|\mbox{${\bf x}$}\| \neq 0}
\frac{\|A\mbox{${\bf x}$}\|}{\|\mbox{${\bf x}$}\|},\]</div>
<p>kallast <em>náttúrulegi fylkjastaðallinn</em> sem <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> gefur af
sér.</p>
<div class="admonition note">
<p class="admonition-title">Athugasemd</p>
<p>Það þarf að sýna, og er ekki mjög erfitt, að þessi fylkjastaðall
uppfyllir öll skilyrðin í skilgreiningu hér á undan og er því sannarlega
fylkjastaðall.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Athugasemd</p>
<p>Ef <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> er náttúrulegur fylkjastaðall þá gildir að fyrir
öll fylki <span class="math notranslate nohighlight">\(A\)</span> og alla vigra <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span> að</p>
<div class="math notranslate nohighlight">
\[\underbrace{\|A\mbox{${\bf x}$}\|}_{\text{vigurstaðll}}
\leq \underbrace{\|A\|}_{\text{fylkjastaðall}} \ \cdot \
\underbrace{\|\mbox{${\bf x}$}\|}_{\text{vigurstaðall}}\]</div>
</div>
</section>
<section id="daemi-um-fylkjastaal">
<h3><span class="section-number">8.3.6. </span>Dæmi um fylkjastaðal<a class="headerlink" href="#daemi-um-fylkjastaal" title="Permalink to this heading"></a></h3>
<p>Fyrir sérhvern <span class="math notranslate nohighlight">\(\ell_p\)</span> staðal fáum við fylkjastaðal
<span class="math notranslate nohighlight">\(\|\cdot\|_p\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\|\cdot\|_\infty\)</span>:
Einfaldastur er staðallinn sem tilheyrir <span class="math notranslate nohighlight">\(\ell_\infty\)</span>, en hann uppfyllir</p>
<div class="math notranslate nohighlight">
\[\|A\|_\infty = \max_{1\leq i \leq n} \sum_{j=1}^n |a_{ij}|.\]</div>
</section>
<section id="eigingildi">
<span id="index-9"></span><h3><span class="section-number">8.3.7. </span>Eigingildi<a class="headerlink" href="#eigingildi" title="Permalink to this heading"></a></h3>
<p>Látum <span class="math notranslate nohighlight">\(A\)</span> vera fylki. Ef tala <span class="math notranslate nohighlight">\(\lambda\)</span> (hugsanlega
tvinntala) og vigur <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span> uppfylla</p>
<div class="math notranslate nohighlight">
\[A\mbox{${\bf x}$}= \lambda \mbox{${\bf x}$},\]</div>
<p>þá kallast <span class="math notranslate nohighlight">\(\lambda\)</span> <em>eigingildi</em> <span class="math notranslate nohighlight">\(A\)</span>, og
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span> <em>eiginvigur</em> <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Athugið að eigingildi <span class="math notranslate nohighlight">\(A\)</span> eru nákvæmlega rætur kennimargliðu
<span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(t \mapsto \det(A-It)\)</span>.</p>
</section>
<section id="rof-og-rofgeisli">
<span id="index-10"></span><h3><span class="section-number">8.3.8. </span>Róf og rófgeisli<a class="headerlink" href="#rof-og-rofgeisli" title="Permalink to this heading"></a></h3>
<p>Mengi allra eigingilda <span class="math notranslate nohighlight">\(A\)</span> er kallað <em>róf</em> <span class="math notranslate nohighlight">\(A\)</span> (e. spectrum)
og er táknað með <span class="math notranslate nohighlight">\(\sigma(A)\)</span>.</p>
<p><em>Rófgeisli</em> (e. spectral radius) fylkisins <span class="math notranslate nohighlight">\(A\)</span> er talan</p>
<div class="math notranslate nohighlight">
\[\rho(A) = \max_{\lambda \in \sigma(A)} |\lambda|.\]</div>
</section>
<section id="setning-um-rofgeisla">
<span id="rofgeisli"></span><h3><span class="section-number">8.3.9. </span>Setning um rófgeisla<a class="headerlink" href="#setning-um-rofgeisla" title="Permalink to this heading"></a></h3>
<p>Látum <span class="math notranslate nohighlight">\(A\)</span> vera fylki, þá gildir eftirfarandi</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\|A\|_2 = \sqrt{\rho(A^T A)}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\rho(A) \leq \|A\|\)</span> fyrir sérhvern náttúrulegan fylkjastaðal
<span class="math notranslate nohighlight">\(\|\cdot\|\)</span></p></li>
<li><p>Fyrir sérhvert <span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span> þá er til náttúrulegur
fylkjastaðall <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> þannig að
<span class="math notranslate nohighlight">\(\|A\| \leq \rho(A) + \varepsilon\)</span>.</p></li>
</ul>
</section>
</section>
<section id="skekkjumat-og-astandstala">
<span id="index-11"></span><h2><span class="section-number">8.4. </span>Skekkjumat og ástandstala<a class="headerlink" href="#skekkjumat-og-astandstala" title="Permalink to this heading"></a></h2>
<section id="hvernig-a-a-maela-skekkju">
<h3><span class="section-number">8.4.1. </span>Hvernig á að mæla skekkju<a class="headerlink" href="#hvernig-a-a-maela-skekkju" title="Permalink to this heading"></a></h3>
<p>Gerum ráð fyrir að <span class="math notranslate nohighlight">\(A\)</span> sé andhverfanlegt fylki,
<span class="math notranslate nohighlight">\(\mbox{${\bf b}$}\)</span> vigur og að við séum að leita að lausn
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span> á</p>
<div class="math notranslate nohighlight">
\[A{\bf x}= {\bf b}.\]</div>
<p>Ef við höfum nálgun <span class="math notranslate nohighlight">\(\tilde {\bf x}\)</span> þannig að <em>leifin</em>
(e. residual) <span class="math notranslate nohighlight">\({\bf r} = A\tilde {\bf x}- {\bf b}\)</span> er
lítil, hvað getum við þá sagt um <em>skekkjuna</em> (e. error)
<span class="math notranslate nohighlight">\({\bf e}= {\bf x}-\tilde {\bf x}\)</span>? Er hún endilega lítil?</p>
<p>Sjáum að svo er ekki, skekkjan getur verið hlutfallslega miklu meiri
heldur en leifin.</p>
<div class="daemi dropdown admonition">
<p class="admonition-title">Dæmi</p>
<blockquote>
<div><p>Skoðum jöfnuhneppið</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{matrix}
     1&amp; 2 \\
     0.99 &amp; 1.99
  \end{matrix}\right]
  \mathbf{x} =
\left[\begin{matrix}
     1 \\
     1
  \end{matrix}\right]\end{split}\]</div>
<p>Sjáum að rétt lausn er <span class="math notranslate nohighlight">\([-1 \ 1]^T\)</span>. Ef við skilgreinum
<span class="math notranslate nohighlight">\(\tilde x = [1 \ 0]^T\)</span> þá er</p>
<div class="math notranslate nohighlight">
\[\mathbf{e} = [-2 \ 1]^T \qquad \|\mathbf{e}\|_\infty = 2.\]</div>
<p>Hins vegar þá er leifin</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r} = A\mathbf{\tilde x} -\mathbf{b} = \left[\begin{matrix}
     1&amp; 2 \\
     0.99 &amp; 1.99
  \end{matrix}\right]
\left[\begin{matrix}
     1\\
     0
  \end{matrix}\right] -
\left[\begin{matrix}
     1 \\
     1
  \end{matrix}\right]
\left[\begin{matrix}
     0 \\
     -0.01
  \end{matrix}\right]\end{split}\]</div>
<p>þannig að <span class="math notranslate nohighlight">\(\|\mathbf{e}\|_\infty = 0.01\)</span>. Hér er skekkjan 200 sinnum
stærri en leifin sem sýnir að lítil leif þarf ekki endilega að hafa í för með sér
litla skekkju.</p>
</div></blockquote>
</div>
</section>
<section id="skekkjumat">
<span id="index-12"></span><h3><span class="section-number">8.4.2. </span>Skekkjumat<a class="headerlink" href="#skekkjumat" title="Permalink to this heading"></a></h3>
<p>Við höfum fjórar jöfnur</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf b}$}=A\mbox{${\bf x}$}, \quad \mbox{${\bf x}$}=A^{-1}\mbox{${\bf b}$}, \quad
\mbox{${\bf r}$}=A(\mathbf{\tilde x}-\mbox{${\bf x}$})=A\mbox{${\bf e}$}, \quad \text{ og } \quad
\mbox{${\bf e}$}=A^{-1}\mbox{${\bf r}$}\]</div>
<p>og þær gefa okkur fjórar ójöfnur fyrir tilsvarandi staðal:</p>
<div class="math notranslate nohighlight">
\[\|\mbox{${\bf b}$}\|\leq \|A\|\|\mbox{${\bf x}$}\|, \quad  \|\mbox{${\bf x}$}\|\leq \|A^{-1}\|\|\mbox{${\bf b}$}\|,
\quad
\|\mbox{${\bf r}$}\|\leq \|A\|\|\mbox{${\bf e}$}\|, \quad  \|\mbox{${\bf e}$}\|\leq \|A^{-1}\|\|\mbox{${\bf r}$}\|\]</div>
<p>Við getum tengt tvær síðustu ójöfnurnar saman í mat á skekkjunni</p>
<div class="math notranslate nohighlight">
\[\dfrac 1{\|A\|}\cdot  \|\mbox{${\bf r}$}\|
\leq  \|\mbox{${\bf e}$}\| \leq
\|A^{-1}\| \|\mbox{${\bf r}$}\|\]</div>
<p>og með því að nota fyrstu tvær ójöfnurnar fæst mat á hlutfallslegri
skekkju</p>
<div class="math notranslate nohighlight">
\[\dfrac 1{\|A\|\|A^{-1}\|}\dfrac{ \|\mbox{${\bf r}$}\|}{\|\mbox{${\bf b}$}\|}
\leq \dfrac{\|\mbox{${\bf e}$}\|}{\|\mbox{${\bf x}$}\|} \leq
\|A\|\|A^{-1}\|\dfrac{\|\mbox{${\bf r}$}\|}{\|\mbox{${\bf b}$}\|}\]</div>
<p>Nú skilgreinum við <em>ástandstölu fylkisins</em> <span class="math notranslate nohighlight">\(A\)</span> með</p>
<div class="math notranslate nohighlight">
\[\kappa(A)=\|A\|\|A^{-1}\|.\]</div>
</section>
<section id="astandstala-fylkis-og-mat-a-hlutfallslegri-skekkju">
<h3><span class="section-number">8.4.3. </span>Ástandstala fylkis og mat á hlutfallslegri skekkju<a class="headerlink" href="#astandstala-fylkis-og-mat-a-hlutfallslegri-skekkju" title="Permalink to this heading"></a></h3>
<p>Með ástandstölunni verður mat okkar á hlutfallslegu skekkjunum að</p>
<div class="math notranslate nohighlight">
\[\dfrac 1{\kappa(A)}\cdot \dfrac{ \|\mbox{${\bf r}$}\|}{\|\mbox{${\bf b}$}\|}
\leq \dfrac{\|\mbox{${\bf e}$}\|}{\|\mbox{${\bf x}$}\|} \leq
\kappa(A)\cdot \dfrac{\|\mbox{${\bf r}$}\|}{\|\mbox{${\bf b}$}\|}\]</div>
<p>Þetta segir okkur að ef ástandstala fylkisins er stór er mögulegt að
skekkjan verði miklu stærri en leifin, samanber dæmið hér á undan
þar sem ástandstalan er 1197.</p>
<div class="admonition warning">
<p class="admonition-title">Aðvörun</p>
<p>Athugið að skilgreiningin</p>
<div class="math notranslate nohighlight">
\[\kappa(A)=\|A\|\|A^{-1}\|.\]</div>
<p>er <em>mjög</em> háð því hvaða staðal við veljum. Þó höfum við að fyrir
alla fylkjastaðla gildir</p>
<div class="math notranslate nohighlight">
\[1=\|I\|=\|AA^{-1}\|\leq \|A\|\|A^{-1}\|=\kappa(A)\]</div>
</div>
</section>
<section id="ahrif-gagnaskekkju">
<span id="index-13"></span><h3><span class="section-number">8.4.4. </span>Áhrif gagnaskekkju<a class="headerlink" href="#ahrif-gagnaskekkju" title="Permalink to this heading"></a></h3>
<p>Hugsum okkur nú að við viljum leysa jöfnuhneppi
<span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span>, en vegna skekkju í stuðlum
jöfnuhneppisins leysum við annað hneppi
<span class="math notranslate nohighlight">\(\tilde A\mathbf {\tilde x}=\mathbf{\tilde b}\)</span>.</p>
<p>Við skilgreinum <em>gagnaskekkjur</em> <span class="math notranslate nohighlight">\(\delta A=\tilde A-A\)</span> og
<span class="math notranslate nohighlight">\(\delta\mbox{${\bf b}$}=\mathbf{\tilde b}-\mbox{${\bf b}$}\)</span> og
ætlum að nota þær til þess að meta skekkjuna
<span class="math notranslate nohighlight">\(\mbox{${\bf e}$}=\delta\mbox{${\bf x}$}=\mathbf{\tilde x}-\mbox{${\bf x}$}\)</span>.</p>
<p>Við verðum að gera ráð fyrir að <span class="math notranslate nohighlight">\(\|\delta A\|\leq 1/\|A^{-1}\|\)</span>
sem tryggir að fylkið <span class="math notranslate nohighlight">\(\tilde A\)</span> sé andhverfanlegt.</p>
<p>Nú stillum við upp jöfnuhneppinu
<span class="math notranslate nohighlight">\(\tilde A\mathbf{\tilde x}=\mathbf{\tilde  b}\)</span> á forminu</p>
<div class="math notranslate nohighlight">
\[(A+\delta A)(\mbox{${\bf x}$}+\delta \mbox{${\bf x}$})=(\mbox{${\bf b}$}+\delta\mbox{${\bf b}$})\]</div>
<p>sem jafngildir</p>
<div class="math notranslate nohighlight">
\[\delta\mbox{${\bf x}$}=A^{-1}\big(\delta\mbox{${\bf b}$}-(\delta A)\mbox{${\bf x}$}-(\delta A)(\delta x)\big)\]</div>
<p>Af þessari jöfnu leiðir ójafnan</p>
<div class="math notranslate nohighlight">
\[\|\delta\mbox{${\bf x}$}\|\leq
\|A^{-1}\|\big(\|\delta\mbox{${\bf b}$}\|+\|\delta A\|\|\mbox{${\bf x}$}\|+\|\delta A\|\|\delta \mbox{${\bf x}$}\|\big)\]</div>
<p>Einangrum nú <span class="math notranslate nohighlight">\(\|\delta \mbox{${\bf x}$}\|\)</span>,</p>
<div class="math notranslate nohighlight">
\[\|\delta\mbox{${\bf x}$}\|\leq
\dfrac{\|A^{-1}\|}{1-\|A^{-1}\|\|\delta A\|}\cdot
\big(\|\delta\mbox{${\bf b}$}\|+\|\delta A\|\|\mbox{${\bf x}$}\|\big)\]</div>
<p>deilum með <span class="math notranslate nohighlight">\(\|\mbox{${\bf x}$}\|\)</span> báðum megin, margföldum síðan
með <span class="math notranslate nohighlight">\(\|A\|\)</span> í teljara og nefnara í hægri hliðinni,</p>
<div class="math notranslate nohighlight">
\[\dfrac{\|\delta\mbox{${\bf x}$}\|} {\|\mbox{${\bf x}$}\|}\leq
\dfrac{\|A\|\|A^{-1}\|}{1-\|A^{-1}\|\|\delta A\|}\cdot
\bigg(\dfrac{\|\delta\mbox{${\bf b}$}\|}{\|A\|\|\mbox{${\bf x}$}\|}+
\dfrac{\|\delta A\|}{\|A\|}\bigg)\]</div>
<p>Samkvæmt skilgreiningu er <span class="math notranslate nohighlight">\(\kappa(A)=\|A\|\|A^{-1}\|\)</span> og við höfum
auk þess ójöfnuna
<span class="math notranslate nohighlight">\(\|\mbox{${\bf b}$}\|\leq \|A\|\|\mbox{${\bf x}$}\|\)</span>, en það gefur
matið á hlutfallslegu skekkjunni sem við sækjumst eftir</p>
<div class="math notranslate nohighlight">
\[\dfrac{\|\delta\mbox{${\bf x}$}\|} {\|\mbox{${\bf x}$}\|}\leq
\dfrac{\kappa(A)}{1-\kappa(A)\cdot(\|\delta A\|/\|A\|)}\cdot
\bigg(\dfrac{\|\delta\mbox{${\bf b}$}\|}{\|\mbox{${\bf b}$}\|}+
\dfrac{\|\delta A\|}{\|A\|}\bigg).\]</div>
</section>
</section>
<section id="lu-attun">
<span id="index-14"></span><h2><span class="section-number">8.5. </span>LU-þáttun<a class="headerlink" href="#lu-attun" title="Permalink to this heading"></a></h2>
<section id="nokkrar-skilgreiningar">
<h3><span class="section-number">8.5.1. </span>Nokkrar skilgreiningar<a class="headerlink" href="#nokkrar-skilgreiningar" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Fylkið <span class="math notranslate nohighlight">\(A\)</span> nefnist <em>neðra þríhyrningsfylki</em> ef öll stök fyrir
ofan hornalínuna í <span class="math notranslate nohighlight">\(A\)</span> eru <span class="math notranslate nohighlight">\(0\)</span>, þ.e. <span class="math notranslate nohighlight">\(a_{ij}=0\)</span>
ef <span class="math notranslate nohighlight">\(i&lt;j\)</span>.</p></li>
<li><p>Fylkið <span class="math notranslate nohighlight">\(A\)</span> nefnist <em>efra þríhyrningsfylki</em> ef öll stökin neðan
við hornalínuna eru <span class="math notranslate nohighlight">\(0\)</span>, þ.e. <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> ef
<span class="math notranslate nohighlight">\(i&gt;j\)</span>.</p></li>
<li><p>Fylkið <span class="math notranslate nohighlight">\(A\)</span> nefnist <em>bandfylki</em> (e. striped matrix) ef til er
<span class="math notranslate nohighlight">\(\beta \leq n-2\)</span> þannig að <span class="math notranslate nohighlight">\(a_{ij}=0\)</span> ef
<span class="math notranslate nohighlight">\(|i-j|&gt;\beta\)</span>. Minnsta talan <span class="math notranslate nohighlight">\(\beta\)</span> sem uppfyllir þetta
skilyrði kallst á <em>bandvídd</em> fylkisins <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>Ef <span class="math notranslate nohighlight">\(A\)</span> er bandfylki með bandvíddina <span class="math notranslate nohighlight">\(1\)</span>, þá nefnist
<span class="math notranslate nohighlight">\(A\)</span> <em>þríhornalínufylki</em>.</p></li>
<li><p>Fylkið <span class="math notranslate nohighlight">\(A\)</span> er sagt vera <em>samhverft</em> ef <span class="math notranslate nohighlight">\(a_{ij}=a_{ji}\)</span>
fyrir öll <span class="math notranslate nohighlight">\(i\)</span> og <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
<li><p>Fylkið <span class="math notranslate nohighlight">\(A\)</span> er sagt vera <em>jákvætt ákvarðað</em> ef
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}^TA\mbox{${\bf x}$}&gt;0\)</span> gildir fyrir alla vigra
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\neq 0\)</span> í <span class="math notranslate nohighlight">\({\mathbb  R}^n\)</span>.</p></li>
</ol>
</section>
<section id="urlausn-a-jofnuhneppi-me-nera-rihyrningsfylki">
<h3><span class="section-number">8.5.2. </span>Úrlausn á jöfnuhneppi með neðra þríhyrningsfylki<a class="headerlink" href="#urlausn-a-jofnuhneppi-me-nera-rihyrningsfylki" title="Permalink to this heading"></a></h3>
<p>Ef <span class="math notranslate nohighlight">\(A\)</span> er neðra þríhyrningsfylki, þá er úrlausn jöfnuhneppisins
<span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}= \mbox{${\bf b}$}\)</span> auðveld, því hneppið er þá
af gerðinni</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    &amp;a_{11}x_1&amp;&amp;=b_1,\\
    &amp;a_{21}x_1+a_{22}x_2&amp;&amp;=b_2,\\
    &amp;a_{31}x_1+a_{32}x_2+a_{33}x_3&amp;&amp;=b_3,\\
    &amp;\vdots \qquad \qquad   \vdots \qquad
    \qquad \vdots&amp; \qquad&amp; \vdots\\
    &amp;a_{n1}x_1+a_{n2}x_2+a_{n3}x_3\cdots+a_{nn}x_n&amp;&amp;=b_n,\end{aligned}\end{split}\]</div>
<p>Við getum rakið okkur niður línurnar og leyst út stærðirnar
<span class="math notranslate nohighlight">\(x_1,\dots,x_n\)</span> hverja á eftir annarri</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    x_1&amp; = b_1/a_{11},\\
    x_2&amp; = (b_2-a_{21}x_1)/a_{22},\\
    x_3&amp; = (b_3-a_{31}x_1-a_{32}x_2)/a_{33}\\
    &amp;\vdots \qquad \qquad \vdots \qquad \qquad \vdots\\
    x_n&amp; = (b_n-a_{n1}x_1-a_{n2}x_2-\cdots
        -a_{n,n-1}x_{n-1})/a_{nn}.\end{aligned}\end{split}\]</div>
</section>
<section id="id4">
<h3><span class="section-number">8.5.3. </span>Fjöldi aðgerða<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<p>Nú skulum við telja saman fjölda reikningsaðgerða sem þarf til þess að
framkvæma þessa útreikninga.</p>
<p>Við lítum á samlagningu og frádrátt sem sömu aðgerðina. Við þurfum enga
samlagningu til að reikna út <span class="math notranslate nohighlight">\(x_1\)</span>, eina til þess að reikna út
<span class="math notranslate nohighlight">\(x_2\)</span>, tvær til þess að reikna <span class="math notranslate nohighlight">\(x_3\)</span> og þannig áfram upp í
<span class="math notranslate nohighlight">\(n-1\)</span> samlagningu til þess að reikna út <span class="math notranslate nohighlight">\(x_n\)</span>.</p>
<p>Heildarfjöldinn er því</p>
<div class="math notranslate nohighlight">
\[1 + 2 + \cdots + n-1 = \tfrac 12 n(n-1) =
    \tfrac 12n^2-\tfrac 12 n.\]</div>
<p>Fjöldi margfaldana er sá sami.</p>
<p>Við þurfum hins vegar aðeins eina deilingu til þess að reikna út hverja
af stærðunum <span class="math notranslate nohighlight">\(x_1,\dots,x_n\)</span>.</p>
<p>Heildarfjöldi reikniaðgerða við úrlausn á línulegu jöfnuhneppi
<span class="math notranslate nohighlight">\(Ax=b\)</span>, þar sem <span class="math notranslate nohighlight">\(A\)</span> er neðra þríhyrningsfylki er því</p>
<div class="math notranslate nohighlight">
\[\tfrac 12 n^2 - \tfrac 12 n
+ \tfrac 12 n^2 - \tfrac 12 n +n = n^2.\]</div>
</section>
<section id="urlausn-a-jofnuhneppi-me-efra-rihyrningsfylki">
<h3><span class="section-number">8.5.4. </span>Úrlausn á jöfnuhneppi með efra þríhyrningsfylki<a class="headerlink" href="#urlausn-a-jofnuhneppi-me-efra-rihyrningsfylki" title="Permalink to this heading"></a></h3>
<p>Hugsum okkur nú að <span class="math notranslate nohighlight">\(A\)</span> sé efra þríhyrningsfylki. Þá verður
jöfnuhneppið</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    a_{11}x_1+a_{12}x_2+a_{13}x_3+\cdots+a_{1n}x_n&amp; = b_1,\\
    a_{22}x_2+a_{23}x_3+\cdots+a_{2n}x_n&amp; = b_2,\\
    a_{33}x_3+\cdots+a_{3n}x_n&amp; = b_3,\\
    \vdots\quad&amp; \quad \vdots\\
    a_{nn}x_n&amp; = b_n,\end{aligned}\end{split}\]</div>
<p>Við getum rakið okkur upp línurnar og fundið
<span class="math notranslate nohighlight">\(x_n,x_{n-1},\dots,x_1\)</span> hverja af annarri</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    x_n&amp; = b_n/a_{nn},\\
    x_{n-1}&amp; = (b_{n-1}-a_{n-1,n}x_n)/a_{n-1,n-1},\\
    \vdots&amp;\qquad \vdots\qquad \qquad \vdots\\
    x_1&amp; = (b_1-a_{12}x_2-a_{13}x_3-\cdots
    -a_{1,n}x_{n})/a_{11}.\end{aligned}\end{split}\]</div>
<p>Aðgerðafjöldinn er sá sami og í úrlausn neðra þríhyrningshneppisins.</p>
</section>
<section id="linuagerir">
<h3><span class="section-number">8.5.5. </span>Línuaðgerðir<a class="headerlink" href="#linuagerir" title="Permalink to this heading"></a></h3>
<p>Gerum ráð fyrir að við séum að ryðja <span class="math notranslate nohighlight">\(4\times 4\)</span> fylki með
Gauss-eyðingu og að við séum búin með fyrsta dálkinn. Næsta skref er að
nota línu 2 til þess að losna við stökin í sætum (3,2) og (4,2).</p>
<div class="math notranslate nohighlight">
\[\begin{split}A=
\left[\begin{array}{llll}
1 &amp; \cdot &amp; \cdot &amp; \cdot\\
0 &amp; a &amp; \cdot &amp; \cdot\\
0 &amp; b &amp; \cdot &amp; \cdot\\
0 &amp; c &amp; \cdot &amp; \cdot
\end{array}\right]\end{split}\]</div>
<p>Lína 3, <span class="math notranslate nohighlight">\(l_3\)</span>, verður þá að <span class="math notranslate nohighlight">\(l_3 - \frac ba l_2\)</span>, og
lína 4, <span class="math notranslate nohighlight">\(l_4\)</span>, verður að <span class="math notranslate nohighlight">\(l_4 - \frac ca l_2\)</span>.</p>
<p>Þessar tvær aðgerðir má einnig framkvæma með því að margfalda fylkið að
ofan frá vinstri með fylkinu</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_2 = \left[
\begin{array}{llll}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; -\frac ba &amp; 1 &amp; 0\\
0 &amp; -\frac ca &amp; 0 &amp; 1
\end{array}
\right]\end{split}\]</div>
</section>
<section id="ny-syn-a-gauss-eyingu">
<h3><span class="section-number">8.5.6. </span>Ný sýn á Gauss-eyðingu<a class="headerlink" href="#ny-syn-a-gauss-eyingu" title="Permalink to this heading"></a></h3>
<p>Það að ryðja fylkið eins og hér á undan, felst því í því að margfalda
<span class="math notranslate nohighlight">\(A\)</span> frá vinstri með þremur fylkjum <span class="math notranslate nohighlight">\(M_1, M_2\)</span> og <span class="math notranslate nohighlight">\(M_3\)</span>
sem eru þannig að <span class="math notranslate nohighlight">\(M_i\)</span> er einingafylkið nema í sætum
<span class="math notranslate nohighlight">\((i+1,i),\ldots,(n,i)\)</span> eru tölur sem eru hugsanlega frábrugðnar 0.
Fylkið <span class="math notranslate nohighlight">\(M_i\)</span> sér þá um að eyða í dálk <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Athugum að Gauss-eyðing skilar fylki <span class="math notranslate nohighlight">\(U\)</span> á efra þríhyrningsformi.</p>
<p>Við getum því skrifað</p>
<div class="math notranslate nohighlight">
\[M_3 M_2 M_1 A = U\]</div>
<p>Almennt, fyrir <span class="math notranslate nohighlight">\(n \times n\)</span> fylki þá getum við skrifað</p>
<div class="math notranslate nohighlight">
\[M_{n-1}\cdots M_2 M_1 A = U,\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(M_i\)</span> eru fylki eins og lýst er hér að ofan.</p>
</section>
<section id="nanar-um-m-i">
<h3><span class="section-number">8.5.7. </span>Nánar um <span class="math notranslate nohighlight">\(M_i\)</span><a class="headerlink" href="#nanar-um-m-i" title="Permalink to this heading"></a></h3>
<p>Við sjáum að ef</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_i = \left[
\begin{array}{ccccccc}
1 &amp;   &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp; . &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp;   &amp; 1 &amp;   &amp;   &amp;   &amp;  \\
  &amp;   &amp; m_{i+1,i} &amp; 1 &amp;   &amp;   &amp;  \\
  &amp;   &amp; . &amp;   &amp; . &amp;   &amp;  \\
  &amp;   &amp; . &amp;   &amp;   &amp; . &amp;  \\
  &amp;   &amp; m_{n,i} &amp;   &amp;   &amp;   &amp; 1
\end{array}\right],\end{split}\]</div>
<p>þá er</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_i^{-1} = \left[
\begin{array}{ccccccc}
1 &amp;   &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp; . &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp;   &amp; 1 &amp;   &amp;   &amp;   &amp;  \\
  &amp;   &amp; -m_{i+1,i} &amp; 1 &amp;   &amp;   &amp;  \\
  &amp;   &amp; . &amp;   &amp; . &amp;   &amp;  \\
  &amp;   &amp; . &amp;   &amp;   &amp; . &amp;  \\
  &amp;   &amp; -m_{n,i} &amp;   &amp;   &amp;   &amp; 1
\end{array}\right].\end{split}\]</div>
<p>Eins þá er auðvelt að sjá að</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_i^{-1} M_j^{-1} = \left[
\begin{array}{cccccccc}
1 &amp;   &amp;   &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp; . &amp;   &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp;   &amp; 1 &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp;   &amp; -m_{i+1,i} &amp; . &amp;   &amp;   &amp;   &amp;  \\
  &amp;   &amp; . &amp;   &amp; 1 &amp;   &amp;   &amp;  \\
  &amp;   &amp; . &amp;   &amp; -m_{j+1,j} &amp; . &amp;   &amp;  \\
  &amp;   &amp; . &amp;   &amp; . &amp;   &amp; . &amp;  \\
  &amp;   &amp; -m_{n,i} &amp;   &amp; -m_{n,j} &amp;   &amp;   &amp; 1
\end{array}
\right]\end{split}\]</div>
<p>Það er</p>
<div class="math notranslate nohighlight">
\[\begin{split}M_1^{-1} M_2^{-1} \cdots M_{n-1}^{-1} = \left[
\begin{array}{cccccc}
1 &amp;   &amp;   &amp;   &amp;   &amp;     \\
-m_{2,1} &amp; 1 &amp;   &amp;   &amp;     &amp;  \\
-m_{3,1} &amp; -m_{3,2} &amp; 1 &amp;    &amp;   &amp;  \\
  &amp; -m_{4,2} &amp; -m_{4,3} &amp; 1   &amp;   &amp;  \\
  &amp; . &amp;   &amp;   &amp; . &amp;    \\
-m_{n,1} &amp; -m_{n,2} &amp; -m_{n,3} &amp; . &amp; -m_{n,n-1}  &amp; 1
   \end{array}
\right]\end{split}\]</div>
</section>
<section id="index-15">
<span id="id5"></span><h3><span class="section-number">8.5.8. </span>LU-þáttun<a class="headerlink" href="#index-15" title="Permalink to this heading"></a></h3>
<p>Þetta hefur í för með sér að ef við skilgreinum
<span class="math notranslate nohighlight">\(L = M_1^{-1} M_2^{-1} \cdots M_{n-1}^{-1}\)</span> þá er</p>
<div class="math notranslate nohighlight">
\[A = LU\]</div>
<p>eða</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \left[\begin{array}{cccccccc}
1 &amp;   &amp;   &amp;   &amp;   &amp;   &amp;   &amp;  \\
-m_{2,1} &amp; 1 &amp;   &amp;   &amp;   &amp;   &amp;   &amp;  \\
-m_{3,1} &amp; -m_{3,2} &amp; 1 &amp;   &amp;   &amp;   &amp;   &amp;  \\
  &amp; -m_{4,2} &amp; -m_{4,3} &amp; 1 &amp;   &amp;   &amp;   &amp;  \\
  &amp; . &amp;   &amp;   &amp; . &amp;   &amp;   &amp;  \\
  &amp; . &amp;   &amp;   &amp;   &amp; . &amp;   &amp;  \\
  &amp; . &amp;   &amp;   &amp;   &amp;   &amp; . &amp;  \\
-m_{n,1} &amp; -m_{n,2} &amp; -m_{n,3} &amp; . &amp; . &amp; . &amp; -m_{n,n-1} &amp; 1
   \end{array}\right] U\end{split}\]</div>
<p>Þannig að með því að framkvæma Gauss-eyðingu á <span class="math notranslate nohighlight">\(A\)</span> og halda
utanum aðgerðirnar (<span class="math notranslate nohighlight">\(M_i\)</span>’in) og niðurstöðuna <span class="math notranslate nohighlight">\(U\)</span> þá fæst
<span class="math notranslate nohighlight">\(LU\)</span>-þáttun á <span class="math notranslate nohighlight">\(A\)</span>.</p>
</section>
<section id="lu-attun-og-skolu-hlutvending">
<h3><span class="section-number">8.5.9. </span><span class="math notranslate nohighlight">\(LU\)</span>-þáttun og sköluð hlutvending<a class="headerlink" href="#lu-attun-og-skolu-hlutvending" title="Permalink to this heading"></a></h3>
<p>Aðferðin hér að framan gerði ráð fyrir að stak <span class="math notranslate nohighlight">\(a_{i,i}\)</span> yrði
aldrei 0 (þá getum við ekki notað þá línu til þess að eyða). Eins
hugsuðum við ekkert út í styttingarskekkjur sem við búum til.</p>
<p>Ef við framkvæmum Gauss-eyðinguna með skalaðri hlutvendingu þá ráðum við
bót á báðum þessum atriðum, því þá veljum við aldrei línu með
forystustuðul 0 og við minnkum skekkjuna eins og hefur komið fram áður.</p>
<div class="admonition warning">
<p class="admonition-title">Aðvörun</p>
<p>Þegar við notum skalaða hlutvendingu þá uppfylla fylkin <span class="math notranslate nohighlight">\(L\)</span> og
<span class="math notranslate nohighlight">\(U\)</span> ekki endilega <span class="math notranslate nohighlight">\(LU=A\)</span>. Þess í stað
fæst</p>
<div class="math notranslate nohighlight">
\[LU =PA\]</div>
<p>þar sem fylkið <span class="math notranslate nohighlight">\(P\)</span> umraðar línunum í <span class="math notranslate nohighlight">\(A\)</span> í samræmi við
umröðunarvigrinn <span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span>. Það er, stökin í <span class="math notranslate nohighlight">\(P\)</span>
eru 0, nema <span class="math notranslate nohighlight">\(p_{i,r_i} = 1\)</span>.</p>
</div>
</section>
<section id="jofnuhneppi-leyst-me-lu-attun">
<span id="index-16"></span><h3><span class="section-number">8.5.10. </span>Jöfnuhneppi leyst með LU-þáttun<a class="headerlink" href="#jofnuhneppi-leyst-me-lu-attun" title="Permalink to this heading"></a></h3>
<p>Við skiptum nú úrlausnarferlinu á
<span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span> í þrjú skref</p>
<p>(i) <span class="math notranslate nohighlight">\(LU\)</span> <strong>-þáttun:</strong> Reiknum út neðra þríhyrningsfylki <span class="math notranslate nohighlight">\(L\)</span>
og efra þríhyrningsfylki <span class="math notranslate nohighlight">\(U\)</span> með skalaðri hlutvendingu. Höldum
utanum <span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span> (og þar með <span class="math notranslate nohighlight">\(P\)</span>). Þá er</p>
<div class="math notranslate nohighlight">
\[LU=PA.\]</div>
<p>(ii) <strong>Forinnsetning:</strong> Leysum
<span class="math notranslate nohighlight">\(L\mbox{${\bf y}$}=P\mbox{${\bf b}$}\)</span>.</p>
<p>(iii) <strong>Endurinnsetning:</strong> Leysum
<span class="math notranslate nohighlight">\(U\mbox{${\bf x}$}=\mbox{${\bf y}$}\)</span>.</p>
<p>Lausnin sem við leitum að er þá <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span>, því</p>
<div class="math notranslate nohighlight">
\[P\mbox{${\bf b}$}= L\mbox{${\bf y}$}= UL\mbox{${\bf x}$}= PA\mbox{${\bf x}$},\]</div>
<p>sem er jafngilt því að <span class="math notranslate nohighlight">\(\mbox{${\bf b}$}=A\mbox{${\bf x}$}\)</span></p>
</section>
<section id="fjoldi-reikniagera-fyrir-lu-attun">
<h3><span class="section-number">8.5.11. </span>Fjöldi reikniaðgerða fyrir <span class="math notranslate nohighlight">\(LU\)</span>-þáttun<a class="headerlink" href="#fjoldi-reikniagera-fyrir-lu-attun" title="Permalink to this heading"></a></h3>
<p>Heildarfjöldi reikningsaðgerða til þess að framkvæma
<span class="math notranslate nohighlight">\(LU\)</span>-þáttunina er</p>
<div class="math notranslate nohighlight">
\[\frac 23n^3-\frac 12n^2-\frac 76 n.\]</div>
<p>Liðir (ii) og (iii) krefjast svo <span class="math notranslate nohighlight">\(n^2 + n^2 = 2n^2\)</span> aðgerða til
viðbótar. Samanlagður fjöldi aðgerða er því</p>
<div class="math notranslate nohighlight">
\[\frac 23n^3+\frac 32n^2-\frac 76 n.\]</div>
<p>Ef <span class="math notranslate nohighlight">\(n\)</span> er stór tala, segjum <span class="math notranslate nohighlight">\(n=1000\)</span>, þá er fyrsti liðurinn
lang stærstur og við getum slegið á aðgerðafjöldann með
<span class="math notranslate nohighlight">\(\tfrac 23n^3\)</span>.</p>
<p>Þetta er töluvert betra heldur en að reikna <span class="math notranslate nohighlight">\(A^{-1}\)</span> og svo
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}=A^{-1}\mbox{${\bf b}$}\)</span>, en þá er heildafjöldi
aðgerða <span class="math notranslate nohighlight">\(2n^3\)</span>.</p>
</section>
<section id="morg-jofnuhneppi">
<h3><span class="section-number">8.5.12. </span>Mörg jöfnuhneppi<a class="headerlink" href="#morg-jofnuhneppi" title="Permalink to this heading"></a></h3>
<p>Ef við þurfum að leysa mörg jöfnuhneppi með sama stuðlafylkið þá koma
kostir <span class="math notranslate nohighlight">\(LU\)</span>-þáttunar vel í ljós.</p>
<p>Gefið <span class="math notranslate nohighlight">\(A\)</span> og <span class="math notranslate nohighlight">\(\mbox{${\bf b}$}_1,\ldots,\mbox{${\bf b}$}_m\)</span>
þá leitum við að vigrum
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}_1,\ldots,\mbox{${\bf x}$}_m\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[A\mbox{${\bf x}$}_i = \mbox{${\bf b}$}_i, \qquad \text{fyrir } i = 1,\ldots,m.\]</div>
<p>Við þurfum bara að framkvæma <span class="math notranslate nohighlight">\(LU\)</span>-þáttunina einu sinni, en
innsetningarnar í lið (ii) og (iii) framkvæmum við <span class="math notranslate nohighlight">\(m\)</span>-sinnum.
Heildar fjöldi aðgerða er þá</p>
<div class="math notranslate nohighlight">
\[\frac 23n^3+(2m-\frac 12)n^2- (m-\frac 16) n.\]</div>
</section>
</section>
<section id="fastapunktsaferir-fyrir-linuleg-jofnuhneppi">
<span id="index-17"></span><h2><span class="section-number">8.6. </span>Fastapunktsaðferðir fyrir línuleg jöfnuhneppi<a class="headerlink" href="#fastapunktsaferir-fyrir-linuleg-jofnuhneppi" title="Permalink to this heading"></a></h2>
<section id="itrekunaraferir-til-ess-a-leysa-linuleg-jofnuhneppi">
<h3><span class="section-number">8.6.1. </span>Ítrekunaraðferðir til þess að leysa línuleg jöfnuhneppi<a class="headerlink" href="#itrekunaraferir-til-ess-a-leysa-linuleg-jofnuhneppi" title="Permalink to this heading"></a></h3>
<p>Munum að samanlagður fjöldi reikniaðgerða sem þarf til þess að leysa
<span class="math notranslate nohighlight">\(n\times n\)</span> línulegt jöfnuhneppi
<span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span> með Gauss-eyðingu, for- og
endurinnsetningu er <span class="math notranslate nohighlight">\(\sim \tfrac 23 n^3\)</span>.</p>
<p>Ef jöfnuhneppið er jafngilt hneppinu</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}=T\mbox{${\bf x}$}+\mbox{${\bf c}$}\]</div>
<p>þá getum við sett upp fastapunktsferð til þess að leysa þetta hneppi með
því að giska á eitthvert nálgunargildi <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}^{(0)}\)</span>
fyrir lausnina og ítra síðan með formúlunni</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}^{(k+1)}=T\mbox{${\bf x}$}^{(k)}+\mbox{${\bf c}$}, \qquad k=0,1,2,\dots,\]</div>
<p>í þeirri von að runan <span class="math notranslate nohighlight">\((\mbox{${\bf x}$}^{(k)})\)</span> stefni á réttu
lausnina <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span> á upprunalega jöfnuhneppinu.</p>
<p>Það þarf <span class="math notranslate nohighlight">\(n^2-n\)</span> aðgerðir til þess að reikna út margfeldið
<span class="math notranslate nohighlight">\(T\mbox{${\bf v}$}\)</span> fyrir vigur
<span class="math notranslate nohighlight">\(\mbox{${\bf v}$}\in {\mathbb  R}^n\)</span> og því getum við komist upp
með að taka <span class="math notranslate nohighlight">\(\approx \tfrac 23 n\)</span> ítrekanir áður en
heildaraðgerðafjöldinn er kominn upp fyrir aðgerðafjöldann í
Gauss-eyðingu, ásamt for- og endurinnsetningu.</p>
</section>
<section id="fastapunktsitrekun-til-ess-a-leysa-linuleg-jofnuhneppi">
<h3><span class="section-number">8.6.2. </span>Fastapunktsítrekun til þess að leysa línuleg jöfnuhneppi<a class="headerlink" href="#fastapunktsitrekun-til-ess-a-leysa-linuleg-jofnuhneppi" title="Permalink to this heading"></a></h3>
<p>Við ætlum nú að gera ráð fyrir að jafnan
<span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span> sé jafngild</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}=T\mbox{${\bf x}$}+\mbox{${\bf c}$}\]</div>
<p>giskum á eitthvert nálgunargildi <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}^{(0)}\)</span> fyrir
lausnina <span class="math notranslate nohighlight">\(\mbox{${\bf x}$}\)</span> og skilgreinum síðan rununa</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}^{(k+1)}=T\mbox{${\bf x}$}^{(k)}+\mbox{${\bf c}$}, \qquad k=0,1,2,\dots,\]</div>
<p>Allt er nú undir því komið að <span class="math notranslate nohighlight">\(n\times n\)</span> fylkið <span class="math notranslate nohighlight">\(T\)</span> sé vel
valið.</p>
</section>
<section id="fastapunktsitrekun-skekkjumat">
<h3><span class="section-number">8.6.3. </span>Fastapunktsítrekun - skekkjumat<a class="headerlink" href="#fastapunktsitrekun-skekkjumat" title="Permalink to this heading"></a></h3>
<p>Við skilgreinum nú skekkjuna í <span class="math notranslate nohighlight">\(k\)</span>-ta ítrekunarskrefinu
<span class="math notranslate nohighlight">\(\mbox{${\bf e}$}^{(k)}=\mbox{${\bf x}$}-\mbox{${\bf x}$}^{(k)}\)</span>.
Þá gildir formúlan</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf e}$}^{(k)}=T\mbox{${\bf e}$}^{(k-1)}=T^2\mbox{${\bf e}$}^{(k-2)}=\cdots=T^{k}\mbox{${\bf e}$}^{(0)}\]</div>
<p>sem við höfum áður séð í athugun okkar á fastapunktsaðferðinni.</p>
<p>Nú beitum við</p>
<div class="math notranslate nohighlight">
\[\|\mbox{${\bf e}$}^{(k)}\| \leq \|T^{k}\|\|\mbox{${\bf e}$}^{(0)}\|\leq \|T\|^{k}\|\mbox{${\bf e}$}^{(0)}\|\]</div>
<p>Við höfum
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}^{(1)}-\mbox{${\bf x}$}^{(0)}=T\mbox{${\bf x}$}^{(0)}+\mbox{${\bf c}$}-\mbox{${\bf x}$}^{(0)}\)</span>
og <span class="math notranslate nohighlight">\(\mbox{${\bf c}$}=\mbox{${\bf x}$}-T\mbox{${\bf x}$}\)</span> og þar
með</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}^{(1)}-\mbox{${\bf x}$}^{(0)}=T(\mbox{${\bf x}$}^{(0)}-\mbox{${\bf x}$})-(\mbox{${\bf x}$}^{(0)}-\mbox{${\bf x}$})=
-(\mbox{${\bf e}$}^{(0)}-T\mbox{${\bf e}$}^{(0)})=-(I-T)\mbox{${\bf e}$}^{(0)}.\]</div>
<p>Þetta gefur jöfnuna</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf e}$}^{(0)}=-(I-T)^{-1} \big(\mbox{${\bf x}$}^{(1)}-\mbox{${\bf x}$}^{(0)}\big).\]</div>
<p>Með smá útreikningi má sýna fram á að ef <span class="math notranslate nohighlight">\(\|T\|&lt;1\)</span>, þá er</p>
<div class="math notranslate nohighlight">
\[\|(I-T)^{-1}\|\leq \dfrac 1{1-\|T\|}.\]</div>
<p>Við vorum komin með ójöfnurnar</p>
<div class="math notranslate nohighlight">
\[\|\mbox{${\bf e}$}^{(k)}\| \leq \|T\|^{k}\|\mbox{${\bf e}$}^{(0)}\|\]</div>
<p>og niðurstaðan verður því</p>
<div class="math notranslate nohighlight">
\[\|\mbox{${\bf e}$}^{(k)}\| \leq \dfrac{\|T\|^{k}}{1-\|T\|}
\|\mbox{${\bf x}$}^{(1)}-\mbox{${\bf x}$}^{(0)}\|\]</div>
<p>Sem þýðir að fastapunktsaðferðin er samleitin þegar <span class="math notranslate nohighlight">\(\|T\|&lt;1\)</span>.</p>
</section>
<section id="skilyri-fyrir-samleitni">
<h3><span class="section-number">8.6.4. </span>Skilyrði fyrir samleitni<a class="headerlink" href="#skilyri-fyrir-samleitni" title="Permalink to this heading"></a></h3>
<p>Munum nú að <span class="math notranslate nohighlight">\(\rho(T)\)</span> er rófgeisli fylkisins <span class="math notranslate nohighlight">\(T\)</span> sem er
samkvæmt skilgreiningu tölugildi á stærsta eigingildi fylkisins
<span class="math notranslate nohighlight">\(T\)</span>.</p>
<p>Rifjum líka upp að samkvæmt <a class="reference internal" href="#rofgeisli"><span class="std std-ref">setningu um rófgeisla</span></a> gildir
fyrir sérhvern náttúrlegan fylkjastaðal
<span class="math notranslate nohighlight">\(\|\cdot\|\)</span> að <span class="math notranslate nohighlight">\(\rho(T) \leq \|T\|\)</span> og að fyrir sérhvert
<span class="math notranslate nohighlight">\(\varepsilon&gt;0\)</span> gildir að hægt er að finna náttúrlegan
fylkjastaðal þannig að</p>
<div class="math notranslate nohighlight">
\[\|T\|\leq \rho(T)+\varepsilon.\]</div>
<p>Sérstaklega gildir í tilfellinu <span class="math notranslate nohighlight">\(\rho(T)&lt;1\)</span> að til er náttúrlegur
fylkjastaðall <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> þannig að <span class="math notranslate nohighlight">\(\|T\|&lt;1\)</span>.</p>
<p>Þetta þýðir að fastapunktsaðferðin er samleitin ef <span class="math notranslate nohighlight">\(\rho(T) &lt; 1\)</span>.</p>
</section>
<section id="skiptingarafer-e-splitting-method">
<span id="index-18"></span><h3><span class="section-number">8.6.5. </span>Skiptingaraðferð (e. splitting method)<a class="headerlink" href="#skiptingarafer-e-splitting-method" title="Permalink to this heading"></a></h3>
<p>Við viljum setja upp fastapunktsaðferð til þess að leysa línulega
jöfnuhneppið <span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span> með því að
umrita jöfnuna yfir í jafngilda línulega jöfnu</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}=T\mbox{${\bf x}$}+\mbox{${\bf c}$}.\]</div>
<p>Gerum ráð fyrir að <span class="math notranslate nohighlight">\(A=M-N\)</span> þar sem <span class="math notranslate nohighlight">\(M\)</span> er andhverfanlegt
fylki. Þá jafngildir <span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span> jöfnunni
<span class="math notranslate nohighlight">\(M\mbox{${\bf x}$}=N\mbox{${\bf x}$}+\mbox{${\bf b}$}\)</span> og
fastapunktsjafnan er</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}=M^{-1}N\mbox{${\bf x}$}+M^{-1}\mbox{${\bf b}$},\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(T = M^{-1}N\)</span> og
<span class="math notranslate nohighlight">\(\mbox{${\bf c}$}= M^{-1}\mbox{${\bf b}$}\)</span>.</p>
<p>Þessi leið til þess að umrita línulega jöfnuhneppið
<span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span> yfir í jafngilda hneppið
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}=T\mbox{${\bf x}$}+\mbox{${\bf c}$}\)</span> nefnist
<em>skiptingaraðferð</em> fyrir línulega jöfnuhneppið
<span class="math notranslate nohighlight">\(A\mbox{${\bf x}$}=\mbox{${\bf b}$}\)</span>.</p>
</section>
<section id="jacobi-afer">
<span id="index-19"></span><h3><span class="section-number">8.6.6. </span>Jacobi-aðferð<a class="headerlink" href="#jacobi-afer" title="Permalink to this heading"></a></h3>
<p>Við skrifum <span class="math notranslate nohighlight">\(A=D-L-U\)</span>, þar sem <span class="math notranslate nohighlight">\(D\)</span> er hornalínufylkið með
hornalínu <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(L\)</span> er neðra þríhyrningsfylki og <span class="math notranslate nohighlight">\(U\)</span> er
efra þríhyrningsfylki</p>
<p>Við tökum <span class="math notranslate nohighlight">\(M=D\)</span> og <span class="math notranslate nohighlight">\(N=L+U\)</span> og fáum þá <span class="math notranslate nohighlight">\(T=D^{-1}(L+U)\)</span>
og <span class="math notranslate nohighlight">\(\mbox{${\bf c}$}=D^{-1}\mbox{${\bf b}$}\)</span>.</p>
<p>Þessi skiptingaraðferð er nefnd <em>Jacobi-aðferð</em>.</p>
<p>Rakningarformúlan er</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}^{(k+1)}=D^{-1}(L+U)\mbox{${\bf x}$}^{(k)}+D^{-1}\mbox{${\bf b}$}.\]</div>
<p>Ef við skrifum hana hnit fyrir hnit, þá fáum við fyrir
<span class="math notranslate nohighlight">\(i=1,2,\dots,n\)</span>,</p>
<div class="math notranslate nohighlight">
\[x_i^{(k+1)}=\dfrac 1{a_{i,i}}\bigg(
b_i-\sum_{j=1}^{i-1}a_{i,j}x_j^{(k)}-\sum_{j=i+1}^n a_{i,j}x_j^{(k)}\bigg)\]</div>
</section>
<section id="gauss-seidel-afer">
<span id="index-20"></span><h3><span class="section-number">8.6.7. </span>Gauss-Seidel-aðferð<a class="headerlink" href="#gauss-seidel-afer" title="Permalink to this heading"></a></h3>
<p>Augljós endurbót á Jacobi-aðferðinni er að nota gildið
<span class="math notranslate nohighlight">\(x_i^{(k+1)}\)</span> fyrir <span class="math notranslate nohighlight">\(i&lt;j\)</span> um leið og það hefur verið
reiknað.</p>
<p>Við það breytist rakningarformúlan í Jacobi-aðferð í</p>
<div class="math notranslate nohighlight">
\[x_i^{(k+1)}=\dfrac 1{a_{i,i}}\bigg(
b_i-\sum_{j=1}^{i-1}a_{i,j}x_j^{(k+1)}-\sum_{j=i+1}^n a_{i,j}x_j^{(k)}\bigg)\]</div>
<p>Þetta svarar til þess að við veljum skiptingu á <span class="math notranslate nohighlight">\(A\)</span> með
<span class="math notranslate nohighlight">\(M=D-L\)</span> og <span class="math notranslate nohighlight">\(N=U\)</span> og þar með að</p>
<div class="math notranslate nohighlight">
\[T=(D-L)^{-1}U \qquad \text{ og } \qquad \mbox{${\bf c}$}=(D-L)^{-1} \mbox{${\bf b}$}\]</div>
</section>
<section id="sor-afer-e-successive-over-relaxation">
<span id="index-21"></span><h3><span class="section-number">8.6.8. </span>SOR-aðferð (e. successive over-relaxation)<a class="headerlink" href="#sor-afer-e-successive-over-relaxation" title="Permalink to this heading"></a></h3>
<p>Það er hægt að hraða samleitni í Gauss-Seidel-aðferð með því að taka
vegið meðaltal af gildinu <span class="math notranslate nohighlight">\(x_i^{(k+1)}\)</span> sem kemur út úr
Gauss-Seidel reikniritinu og næsta gildi á undan með vægisstuðli sem við
táknum með <span class="math notranslate nohighlight">\(\omega\)</span>.</p>
<p>Formúlan verður</p>
<div class="math notranslate nohighlight">
\[x_i^{(k+1)}=(1-\omega)x_i^{(k)}+\dfrac \omega{a_{i,i}}\bigg(
b_i-\sum_{j=1}^{i-1}a_{i,j}x_j^{(k+1)}-\sum_{j=i+1}^n a_{i,j}x_j^{(k)}\bigg)\]</div>
<p>Þetta svarar til þess að við veljum</p>
<div class="math notranslate nohighlight">
\[M=\dfrac 1\omega D-L \quad { og } \quad
N=\bigg(\dfrac 1\omega -1\bigg) D+U\]</div>
<p>og þar með að</p>
<div class="math notranslate nohighlight">
\[T=\bigg(\dfrac 1\omega D-L\bigg)^{-1}
\bigg(\bigg(\dfrac 1\omega-1\bigg)D+ U\bigg)
\quad \text{ og } \quad \mbox{${\bf c}$}=\bigg(\dfrac 1\omega D-L\bigg)^{-1} \mbox{${\bf b}$}\]</div>
</section>
<section id="setning-um-samleitni-gauss-seidel-aferarinnar">
<h3><span class="section-number">8.6.9. </span>Setning um samleitni Gauss-Seidel-aðferðarinnar<a class="headerlink" href="#setning-um-samleitni-gauss-seidel-aferarinnar" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Gerum ráð fyrir að <span class="math notranslate nohighlight">\(A\)</span> sé samhverft rauntölufylki með öll
hornalínustökin jákvæð. Þá er Gauss-Seidel aðferðin samleitin ef og
aðeins ef <span class="math notranslate nohighlight">\(A\)</span> er jákvætt ákvarðað.</p></li>
<li><p>Ef fylkið <span class="math notranslate nohighlight">\(A\)</span> er jákvætt ákvarðað, þá er Gauss-Seidel-aðferð
samleitin fyrir sérhvert val á upphafságiskun
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}^{(0)}\)</span>.</p></li>
</ul>
</section>
</section>
<section id="newton-afer-fyrir-jofnuhneppi">
<span id="index-22"></span><h2><span class="section-number">8.7. </span>Newton-aðferð fyrir jöfnuhneppi<a class="headerlink" href="#newton-afer-fyrir-jofnuhneppi" title="Permalink to this heading"></a></h2>
<p>Að lokum þá skulum við skoða aðeins ólínuleg jöfnuhneppi.</p>
<p>Látum <span class="math notranslate nohighlight">\(f_k : I \to {\mathbb  R}\)</span>, <span class="math notranslate nohighlight">\(k = 1, \ldots, n\)</span>, þar
sem <span class="math notranslate nohighlight">\(I\)</span> er svæði í <span class="math notranslate nohighlight">\({\mathbb  R}^n\)</span> vera samfelld föll. Það
getur komið sér vel að geta leyst ólínuleg jöfnuhneppi af gerðinni</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{c}
        f_1(x_1, \ldots, x_n) = 0 \\
        f_2(x_1, \ldots, x_n) = 0 \\
        \vdots \\
        f_n(x_1, \ldots, x_n) = 0 \\
    \end{array} \right.\end{split}\]</div>
<p>Svo heppilega vill til að aðferð Newtons virkar næstum óbreytt fyrir
slík hneppi.</p>
<section id="jacobi-fylki">
<span id="index-23"></span><h3><span class="section-number">8.7.1. </span>Jacobi-fylki<a class="headerlink" href="#jacobi-fylki" title="Permalink to this heading"></a></h3>
<p>Skilgreinum <span class="math notranslate nohighlight">\(\mbox{${\bf f}$}: I \to R^n\)</span> með</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf f}$}(\mbox{${\bf x}$}) = \left(f_1(\mbox{${\bf x}$}),\ldots,f_n(\mbox{${\bf x}$})\right)\]</div>
<p>og gerum ráð fyrir að allar hlutafleiðurnar <span class="math notranslate nohighlight">\(\dfrac{\partial f_k}{\partial x_j}\)</span> séu til og séu samfelldar.</p>
<p>Táknum Jacobi-fylki <span class="math notranslate nohighlight">\(\mbox{${\bf f}$}\)</span> með
<span class="math notranslate nohighlight">\(\mbox{${\bf f}$}'\)</span>, það er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mbox{${\bf f}$}'(\mbox{${\bf x}$}) = \begin{pmatrix}
        \frac{\partial f_1}{\partial x_1}(\mbox{${\bf x}$})
        &amp; \frac{\partial f_1}{\partial x_2}(\mbox{${\bf x}$})
        &amp; \cdots
        &amp; \frac{\partial f_1}{\partial x_n}(\mbox{${\bf x}$}) \\
        \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
        \frac{\partial f_n}{\partial x_1}(\mbox{${\bf x}$})
        &amp; \frac{\partial f_n}{\partial x_2}(x)
        &amp; \cdots
        &amp; \frac{\partial f_n}{\partial x_n}(\mbox{${\bf x}$})
    \end{pmatrix}\end{split}\]</div>
</section>
<section id="afer-newtons-fyrir-hneppi">
<h3><span class="section-number">8.7.2. </span>Aðferð Newtons fyrir hneppi<a class="headerlink" href="#afer-newtons-fyrir-hneppi" title="Permalink to this heading"></a></h3>
<p>Lausn á hneppinu hér að ofan er vigur <span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span> þannig að
<span class="math notranslate nohighlight">\(\mbox{${\bf f}$}(\mbox{${\bf r}$}) =0\)</span>.</p>
<p>Ef <span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span> er lausn hneppisins og
<span class="math notranslate nohighlight">\(\mbox{${\bf x}$}_0 \in {\mathbb  R}^n\)</span> er upphafságiskun á
<span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span> má sjá að runan <span class="math notranslate nohighlight">\((\mbox{${\bf x}$}_n)\)</span>,
þar sem</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf x}$}_{n+1} = \mbox{${\bf x}$}_n + \mbox{${\bf h}$}_n^T\]</div>
<p>og <span class="math notranslate nohighlight">\(\mbox{${\bf h}$}_n^T\)</span> er lausn á jöfnuhneppinu</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf f}$}'(\mbox{${\bf x}$}_n) \mbox{${\bf h}$}_n^T = -\mbox{${\bf f}$}(\mbox{${\bf x}$}_n)\]</div>
<p>stefnir á lausnina <span class="math notranslate nohighlight">\(\mbox{${\bf r}$}\)</span>.</p>
<p>Við getum metið skekkjuna með</p>
<div class="math notranslate nohighlight">
\[\mbox{${\bf e}$}_{n+1} \approx \| \mbox{${\bf x}$}_{n+1} - \mbox{${\bf x}$}_n \|\]</div>
<p>og forritið okkar helst næstum óbreytt, við þurfum aðeins að skipta abs
út fyrir skipunina norm.</p>
</section>
<section id="matlab-forrit-fyrir-hneppi">
<h3><span class="section-number">8.7.3. </span>Matlab-forrit fyrir hneppi<a class="headerlink" href="#matlab-forrit-fyrir-hneppi" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">x</span> <span class="o">=</span> <span class="n">newtonNullHneppi</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">epsilon</span><span class="p">)</span>
<span class="o">%</span>
<span class="o">%</span>   <span class="n">x</span> <span class="o">=</span> <span class="n">newtonNullHneppi</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">epsilon</span><span class="p">)</span>
<span class="o">%</span>
<span class="o">%</span> <span class="n">Nálgar</span> <span class="n">núllstöð</span> <span class="n">fallsins</span> <span class="n">f</span><span class="p">:</span><span class="n">Rn</span> <span class="o">--&gt;</span> <span class="n">Rn</span> <span class="n">með</span> <span class="n">aðferð</span> <span class="n">Newtons</span><span class="o">.</span>
<span class="o">%</span> <span class="n">Fallið</span> <span class="n">df</span> <span class="n">er</span> <span class="n">Jacobi</span><span class="o">-</span><span class="n">fylki</span> <span class="n">f</span><span class="p">,</span> <span class="n">x0</span> <span class="n">er</span> <span class="n">upphafságiskun</span>
<span class="o">%</span> <span class="n">á</span> <span class="n">núllstöð</span> <span class="n">og</span> <span class="n">epsilon</span> <span class="n">er</span> <span class="n">tilætluð</span> <span class="n">nákvæmni</span><span class="o">.</span>
<span class="o">%</span> <span class="n">x0</span> <span class="n">verður</span> <span class="n">að</span> <span class="n">vera</span> <span class="n">dálkvigur</span> <span class="n">og</span> <span class="n">f</span> <span class="n">verður</span> <span class="n">að</span>
<span class="o">%</span> <span class="n">skila</span> <span class="n">dálkvigrum</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">x0</span><span class="p">;</span> <span class="n">mis</span> <span class="o">=</span> <span class="o">-</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>\<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="o">%</span> <span class="n">Ítrum</span> <span class="n">meðan</span> <span class="n">ástæða</span> <span class="n">er</span> <span class="n">til</span>
<span class="k">while</span> <span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">mis</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">epsilon</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">mis</span><span class="p">;</span>
    <span class="n">mis</span> <span class="o">=</span> <span class="o">-</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>\<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="n">end</span>
</pre></div>
</div>
<div class="daemi dropdown admonition">
<p class="admonition-title">Dæmi</p>
<p>Grafið <span class="math notranslate nohighlight">\(y=e^x\)</span> sker lokaða ferilinn sem gefinn er með jöfnunni
<span class="math notranslate nohighlight">\(x^4+y^2=1\)</span> í tveimur punktum. Notið aðferð Newtons til þess að
nálga hnit þeirra með 5 aukastafa nákvæmni.</p>
<p>Það er alveg augljóst að punkturinn <span class="math notranslate nohighlight">\({\mathbf r}=(0,1)\)</span> gefur
lausn á jöfnuhneppinu. Við látum eins og ekkert sé og giskum á
<span class="math notranslate nohighlight">\({\mathbf x}^{(0)}=(0.5,0.75)\)</span></p>
<p>Hér er</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\bf f}({\bf x}) = \begin{bmatrix}
y - e^x\\
x^4+y^2-1 \end{bmatrix}\end{split}\]</div>
<p>og</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\bf f'}({\bf x}) = \begin{bmatrix}
-e^x &amp; 1 \\
4x^3 &amp; 2y \end{bmatrix}\end{split}\]</div>
<p>Forritið hér að ofan gefur svo eftirfarandi töflu.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(n\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x^{(n)}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y^{(n)}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\|{\mathbf x}^{(n+1)}-{\mathbf x}^{(n)}\|\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0.50000000000000</p></td>
<td><p>0.75000000000000</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0.17270262414568</p></td>
<td><p>1.10909912528477</p></td>
<td><p>0.18447541668198</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0.01946538693088</p></td>
<td><p>1.00638822766059</p></td>
<td><p>0.02028257413953</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>0.00020831857772</p></td>
<td><p>1.00002048613263</p></td>
<td><p>0.00020930163934</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>0.00000002190660</p></td>
<td><p>1.00000000020984</p></td>
<td><p>0.00000002190761</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>0.00000000000000</p></td>
<td><p>1.00000000000000</p></td>
<td><p>0.00000000000000</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>-0.00000000000000</p></td>
<td><p>1.00000000000000</p></td>
<td><p>0.00000000000000</p></td>
</tr>
</tbody>
</table>
<p>Tökum nú fyrir hinn skurðpunktinn og notum upphafságiskun <span class="math notranslate nohighlight">\((-0.8,0.25)\)</span>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(n\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x^{(n)}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y^{(n)}\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\|{\mathbf x}^{(n+1)}-{\mathbf x}^{(n)}\|\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>-0.80000000000000</p></td>
<td><p>0.25000000000000</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>-1.03486380522268</p></td>
<td><p>0.34379785380788</p></td>
<td><p>0.07380487278262</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>-0.96968875917544</p></td>
<td><p>0.37842981331349</p></td>
<td><p>0.00919771982977</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>-0.96137076039507</p></td>
<td><p>0.38235523639344</p></td>
<td><p>0.00014098927991</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>-0.96124395918305</p></td>
<td><p>0.38241687590740</p></td>
<td><p>0.00000003252214</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>-0.96124392995056</p></td>
<td><p>0.38241689016050</p></td>
<td><p>0.00000000000000</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>-0.96124392995055</p></td>
<td><p>0.38241689016050</p></td>
<td><p>0.00000000000000</p></td>
</tr>
</tbody>
</table>
<p>Nálgun okkar á skurðpunkti ferlanna í vinstra hálfplaninu er
<span class="math notranslate nohighlight">\((-0.96124392995055, 0.38241689016050)\)</span></p>
<p>Í töfluna var ekki hægt að koma fyrir athugun á samleitnistiginu en
hlutfallið</p>
<div class="math notranslate nohighlight">
\[\dfrac{\|e_{n+1}\|}{\|e_n\|^2}
\approx\dfrac{\|{\mathbf x}^{(n+1)}-{\mathbf x}^{(n)}\|}{\|{\mathbf
  x}^{(n)}-{\mathbf x}^{(n-1)}\|^2}
=1.6\]</div>
<p>fyrir fjögur síðustu gildin.</p>
<img alt="../_images/newton_hneppi.png" src="../_images/newton_hneppi.png" />
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../kafli07/" class="btn btn-neutral float-left" title="7. Jaðargildisverkefni" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../kafli09/" class="btn btn-neutral float-right" title="9. Eigingildisverkefni" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    /* Sidebar header (and topbar for mobile) */
    
    .wy-side-nav-search,
    .wy-nav-top {
        background: #10099F;
    }
    /* Sidebar */
    
    .wy-nav-side {
        background: #262626;
    }
</style>


</body>
</html>