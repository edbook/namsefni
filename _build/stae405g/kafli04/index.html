<!DOCTYPE html>
<html class="writer-html5" lang="is" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. Töluleg diffrun &mdash; Töluleg greining (STÆ405G) </title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/eqt.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/datacamp-custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/edbook.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_2.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/js/eqt.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
        <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

<script>
    // the buttonText string says what will be written on the 
    // sage cell evaluation button.
    // It can be changed here.
    var buttonText = "Keyra"
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sage",
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsage",
        languages: ["r"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osage",
        languages: ["octave"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAuto",
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAuto",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAuto",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAutoHidden",
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAutoHidden",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAutoHidden",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>


<style type="text/css">
    .sagecell .CodeMirror-scroll {
        overflow-y: hidden;
        overflow-x: auto;
    }
    
    .sagecell .CodeMirror {
        height: auto;
    }
</style>


    <link rel="index" title="Atriðaskrá" href="../genindex/" />
    <link rel="search" title="Leit" href="../search/" />
    <link rel="next" title="5. Töluleg heildun" href="../kafli05/" />
    <link rel="prev" title="3. Brúun" href="../kafli03/" />  
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Töluleg greining (STÆ405G)
              <img src="../_static/haskoli_islands-edbook.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../kafli01/">1. Inngangur</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli02/">2. Núllstöðvar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli03/">3. Brúun</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Töluleg diffrun</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#inngangur">4.1. Inngangur</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#toluleg-diffrun-og-heildun">4.1.1. Töluleg diffrun og heildun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#meginhugmynd-i-ollum-nalgunaraferunum">4.1.2. Meginhugmynd í öllum nálgunaraðferðunum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aferirnar">4.2. Aðferðirnar</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#frammismunur">4.2.1. Frammismunur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bakmismunur">4.2.2. Bakmismunur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#misettur-mismunakvoti">4.2.3. Miðsettur mismunakvóti</a></li>
<li class="toctree-l3"><a class="reference internal" href="#misettur-mismunakvoti-fyrir-ara-afleiu">4.2.4. Miðsettur mismunakvóti fyrir aðra afleiðu</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#skekkjumat">4.3. Skekkjumat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#almennt-um-nalganir-a-afleium">4.3.1. Almennt um nálganir á afleiðum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#index-5">4.3.2. Skekkjumat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">4.3.3. Frammismunur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">4.3.4. Miðsettur mismunakvóti</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">4.3.5. Miðsettur mismunakvóti fyrir aðra afleiðu</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#richardson-utgiskun">4.4. Richardson útgiskun</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#utleisla-a-misettum-mismunakvota">4.4.1. Útleiðsla á miðsettum mismunakvóta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#helmingun-a-skrefinu">4.4.2. Helmingun á skrefinu</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fjora-stigs-nalgun">4.4.3. Fjórða stigs nálgun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#haegt-er-a-halda-afram-utgiskun">4.4.4. Hægt er að halda áfram útgiskun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sjotta-stigs-skekkja">4.4.5. Sjötta stigs skekkja</a></li>
<li class="toctree-l3"><a class="reference internal" href="#almenn-rakningarformula">4.4.6. Almenn rakningarformúla</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reiknirit">4.4.7. Reiknirit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">4.4.8. Skekkjumat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utleisla-a-fyrirframmati">4.4.9. Útleiðsla á fyrirframmati</a></li>
<li class="toctree-l3"><a class="reference internal" href="#synidaemi">4.4.10. Sýnidæmi</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kafli05/">5. Töluleg heildun</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli06/">6. Upphafsgildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli07/">7. Jaðargildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli08/">8. Jöfnuhneppi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli09/">9. Eigingildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli10/">10. Monte Carlo hermanir</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vidauki/">Viðauki</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Töluleg greining (STÆ405G)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">4. </span>Töluleg diffrun</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/edbook/haskoli-islands/blob/master/projects/stae405g/kafli04.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="toluleg-diffrun">
<h1><span class="section-number">4. </span>Töluleg diffrun<a class="headerlink" href="#toluleg-diffrun" title="Permalink to this heading"></a></h1>
<p><em>Nanny’s philosophy of life was to do what seemed like a good idea at the time, and do it as hard as possible. It had never let her down.</em>
– Terry Pratchett, Maskerade</p>
<section id="inngangur">
<h2><span class="section-number">4.1. </span>Inngangur<a class="headerlink" href="#inngangur" title="Permalink to this heading"></a></h2>
<section id="toluleg-diffrun-og-heildun">
<span id="index-0"></span><h3><span class="section-number">4.1.1. </span>Töluleg diffrun og heildun<a class="headerlink" href="#toluleg-diffrun-og-heildun" title="Permalink to this heading"></a></h3>
<p>Deildun og heildun eru meginaðgerðir stærðfræðigreiningarinnar.</p>
<p>Þess vegna er nauðsynlegt að geta nálgað</p>
<div class="math notranslate nohighlight">
\[f'(a),f''(a),f'''(a),\dots \quad
  \text{ og } \quad
  \int_a^b f(x)\, dx,\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(f\)</span> er fall sem skilgreint er á bili <span class="math notranslate nohighlight">\(I\)</span> sem
inniheldur <span class="math notranslate nohighlight">\(a\)</span> og <span class="math notranslate nohighlight">\(b\)</span>.</p>
</section>
<section id="meginhugmynd-i-ollum-nalgunaraferunum">
<h3><span class="section-number">4.1.2. </span>Meginhugmynd í öllum nálgunaraðferðunum<a class="headerlink" href="#meginhugmynd-i-ollum-nalgunaraferunum" title="Permalink to this heading"></a></h3>
<p>Látum <span class="math notranslate nohighlight">\(p\)</span> vera margliðu sem nálgar <span class="math notranslate nohighlight">\(f\)</span>, og látum
<span class="math notranslate nohighlight">\(r(x)=f(x)-p(x)\)</span> tákna skekkjuna í nálgun á <span class="math notranslate nohighlight">\(f(x)\)</span> með
<span class="math notranslate nohighlight">\(p(x)\)</span>. Þá er</p>
<div class="math notranslate nohighlight">
\[f'(x)=p'(x)+r'(x), \quad f''(x)=p''(x)+r''(x), \dots\]</div>
<p>og</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\, dx=\int_a^b p(x)\, dx+\int_a^b r(x)\, dx.\]</div>
<p>Nú þurfum við að gera tvennt:</p>
<ol class="arabic">
<li><p>Finna heppilegar nálgunarmargliður og reikna út</p>
<div class="math notranslate nohighlight">
\[p'(a), \ p''(a),\dots, \qquad \int_a^b p(x)\, dx\]</div>
</li>
<li><p>Meta skekkjurnar</p>
<div class="math notranslate nohighlight">
\[r'(a), \ r''(a), \dots \int_a^b r(x)\, dx\]</div>
</li>
</ol>
<p>Byrjum á að leiða út nokkrar nálgunarformúlur með skekkjumati.</p>
</section>
</section>
<section id="aferirnar">
<span id="index-1"></span><h2><span class="section-number">4.2. </span>Aðferðirnar<a class="headerlink" href="#aferirnar" title="Permalink to this heading"></a></h2>
<p>Látum <span class="math notranslate nohighlight">\(f : I \to \mathbb R\)</span> vera fall á bili
<span class="math notranslate nohighlight">\(I \subset \mathbb R\)</span> og <span class="math notranslate nohighlight">\(a\)</span> vera punkt í <span class="math notranslate nohighlight">\(I\)</span>. Afleiða
<span class="math notranslate nohighlight">\(f\)</span> í punktinum <span class="math notranslate nohighlight">\(a\)</span> er skilgreind með</p>
<div class="math notranslate nohighlight">
\[f'(a) = \lim\limits_{h \to 0}
  \frac{f(a+h)-f(a)}{h}\]</div>
<p>ef markgildið er til. Við skrifum því oft</p>
<div class="math notranslate nohighlight">
\[f'(a) \approx \frac{f(a+h)-f(a)}{h}\]</div>
<p>Þessi nálgun er kölluð <em>frammismunur</em> því oftast hugsar maður sér að
<span class="math notranslate nohighlight">\(h &gt; 0\)</span> og þá er <span class="math notranslate nohighlight">\(a+h\)</span> lítið skref áfram frá <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>Við þurfum skekkjumat fyrir þessa formúlu ef við eigum að geta notað
hana.</p>
<section id="frammismunur">
<h3><span class="section-number">4.2.1. </span>Frammismunur<a class="headerlink" href="#frammismunur" title="Permalink to this heading"></a></h3>
<p>Við fáum mat á skekkjuna í nálguninni með að skoða Taylor-margliðu
<span class="math notranslate nohighlight">\(f\)</span> í <span class="math notranslate nohighlight">\(a\)</span>. Samkvæmt setningu Taylors er til <span class="math notranslate nohighlight">\(\xi\)</span> á
milli <span class="math notranslate nohighlight">\(a\)</span> og <span class="math notranslate nohighlight">\(a+h\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[f(a+h) = f(a) + f'(a)h + \frac{1}{2} f''(\xi)h^2.\]</div>
<p>Þá fæst að skekkjan í nálgun á <span class="math notranslate nohighlight">\(f'(a)\)</span> með</p>
<div class="math notranslate nohighlight">
\[\frac{f(a+h)-f(a)}{h} = f[a,a+h]\]</div>
<p>er</p>
<div class="math notranslate nohighlight">
\[e = f'(a) - \frac{f(a+h)-f(a)}{h} = -\frac{1}{2} f''(\xi) h\]</div>
<p>Með öðrum orðum</p>
<div class="math notranslate nohighlight">
\[\min_{t\in [0,h]} -\frac 12 f''(t)h \leq e \leq
\max_{t\in [0,h]} -\frac 12 f''(t)h.\]</div>
<p>Við sjáum því að <span class="math notranslate nohighlight">\(e=O(h)\)</span> þegar <span class="math notranslate nohighlight">\(h \to 0\)</span>.</p>
</section>
<section id="bakmismunur">
<span id="index-2"></span><h3><span class="section-number">4.2.2. </span>Bakmismunur<a class="headerlink" href="#bakmismunur" title="Permalink to this heading"></a></h3>
<p>Við getum sett <span class="math notranslate nohighlight">\(a-h\)</span> í stað <span class="math notranslate nohighlight">\(a+h\)</span> í skilgreininguna á
afleiðu. Þá fæst svokallaður <em>bakmismunur</em></p>
<div class="math notranslate nohighlight">
\[f'(a) \approx \frac{f(a)-f(a-h)}{h}\]</div>
<p>og ljóst er að sama skekkjumat gengur fyrir þessa nálgun og fyrir nálgun
með frammismun.</p>
</section>
<section id="misettur-mismunakvoti">
<span id="index-3"></span><h3><span class="section-number">4.2.3. </span>Miðsettur mismunakvóti<a class="headerlink" href="#misettur-mismunakvoti" title="Permalink to this heading"></a></h3>
<p>Lítum nú á þriðja stigs Taylor nálgun</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f(a+h)&amp;=f(a)+f'(a)h+\tfrac 12 f''(a)h^2+\tfrac 16 f'''(\alpha)h^3,\\
  f(a-h)&amp;=f(a)-f'(a)h+\tfrac 12 f''(a)h^2-\tfrac 16 f'''(\beta)h^3,\end{aligned}\end{split}\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(\alpha\)</span> er á milli <span class="math notranslate nohighlight">\(a\)</span> og <span class="math notranslate nohighlight">\(a+h\)</span> og
<span class="math notranslate nohighlight">\(\beta\)</span> er á milli <span class="math notranslate nohighlight">\(a\)</span> og <span class="math notranslate nohighlight">\(a-h\)</span>.</p>
<p>Tökum nú mismuninn og fáum</p>
<div class="math notranslate nohighlight">
\[f(a+h)-f(a-h)=f'(a)\cdot 2h+\tfrac 16\big(f'''(\alpha)+f'''(\beta)\big)h^3\]</div>
<p>Ef <span class="math notranslate nohighlight">\(f'''\)</span> er samfellt fall, þá gefur milligildissetningin okkur að
til er <span class="math notranslate nohighlight">\(\xi\)</span> á milli <span class="math notranslate nohighlight">\(\alpha\)</span> og <span class="math notranslate nohighlight">\(\beta\)</span> þannig að
<span class="math notranslate nohighlight">\(f'''(\xi)=\tfrac 12 (f'''(\alpha)+f'''(\beta))\)</span></p>
<p>Niðurstaðan verður</p>
<div class="math notranslate nohighlight">
\[f'(a)=\dfrac{f(a+h)-f(a-h)}{2h}-\tfrac 16f'''(\xi)h^2.\]</div>
<p>Þannig að skekkjan er</p>
<div class="math notranslate nohighlight">
\[e = -\frac 16 f'''(\xi) h^2,\]</div>
<p>og jafnframt er <span class="math notranslate nohighlight">\(e = O(h^2)\)</span> þegar <span class="math notranslate nohighlight">\(h\to 0\)</span>.</p>
<div id="ITJWrt50Kq9woVAF2mLS6WMr24ft4H"></div>
<script>
var ggbApp_ITJWrt50Kq9woVAF2mLS6WMr24ft4H = new GGBApplet({
"appName": "calculator", 
"width": 700, 
"height": 400, 
"material_id": "2501721", 
"preventFocus": true, 
"enableShiftDragZoom": false 
}, true);
ggbAppletId["ITJWrt50Kq9woVAF2mLS6WMr24ft4H"] = ggbApp_ITJWrt50Kq9woVAF2mLS6WMr24ft4H;
</script>
<p></p>
</section>
<section id="misettur-mismunakvoti-fyrir-ara-afleiu">
<span id="index-4"></span><h3><span class="section-number">4.2.4. </span>Miðsettur mismunakvóti fyrir aðra afleiðu<a class="headerlink" href="#misettur-mismunakvoti-fyrir-ara-afleiu" title="Permalink to this heading"></a></h3>
<p>Við getum útfært þessa sömu hugmynd til þess að reikna út aðra afleiðu,
en þá byrjum við með fjórða stigs Taylor-nálgun</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f(a+h)&amp;=f(a)+f'(a)h+\tfrac 12 f''(a)h^2+\tfrac 16 f'''(a)h^3
+\tfrac 1{24}f^{(4)}(\alpha)h^4,\\
  f(a-h)&amp;=f(a)-f'(a)h+\tfrac 12 f''(a)h^2-\tfrac 16 f'''(a)h^3
+\tfrac 1{24}f^{(4)}(\beta)h^4,\end{aligned}\end{split}\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(\alpha\)</span> er á milli <span class="math notranslate nohighlight">\(a\)</span> og <span class="math notranslate nohighlight">\(a+h\)</span> og
<span class="math notranslate nohighlight">\(\beta\)</span> er á milli <span class="math notranslate nohighlight">\(a\)</span> og <span class="math notranslate nohighlight">\(a-h\)</span>.</p>
<p>Nú leggjum við saman og fáum</p>
<div class="math notranslate nohighlight">
\[f(a+h)+f(a-h)=2f(a) +f''(a)h^2+\tfrac
1{24}\big(f^{(4)}(\alpha)+f^{(4)}(\beta)\big)h^4.\]</div>
<p>Nú þurfum við að gefa okkur að <span class="math notranslate nohighlight">\(f^{(4)}\)</span> sé samfellt fall, þá
gefur milligildissetningin okkur að til er <span class="math notranslate nohighlight">\(\xi\)</span> á milli
<span class="math notranslate nohighlight">\(\alpha\)</span> og <span class="math notranslate nohighlight">\(\beta\)</span> þannig að
<span class="math notranslate nohighlight">\(f^{(4)}(\xi)=\tfrac 12 (f^{(4)}(\alpha)+f^{(4)}(\beta))\)</span>.</p>
<p>Niðurstaðan verður</p>
<div class="math notranslate nohighlight">
\[f''(a)=\dfrac{f(a+h)+f(a-h)-2f(a)}{h^2}-\tfrac 1{12}f^{(4)}(\xi)h^2\]</div>
<p>Með Taylor-margliðum má leiða út fleiri nálgunarformúlur fyrir afleiður.</p>
<p>Við ætlum ekki að halda lengra í þessa átt heldur snúa okkur að almennu
aðferðinni.</p>
</section>
</section>
<section id="skekkjumat">
<h2><span class="section-number">4.3. </span>Skekkjumat<a class="headerlink" href="#skekkjumat" title="Permalink to this heading"></a></h2>
<section id="almennt-um-nalganir-a-afleium">
<h3><span class="section-number">4.3.1. </span>Almennt um nálganir á afleiðum<a class="headerlink" href="#almennt-um-nalganir-a-afleium" title="Permalink to this heading"></a></h3>
<p>Ef <span class="math notranslate nohighlight">\(x_0,\ldots, x_n\)</span> eru punktar í <span class="math notranslate nohighlight">\(I\)</span> (hugsanlega með
endurtekningum) og <span class="math notranslate nohighlight">\(p\)</span> er margliðan sem brúar <span class="math notranslate nohighlight">\(f\)</span> í þeim, þá
er</p>
<div class="math notranslate nohighlight">
\[f(x) = p(x) + r(x),\]</div>
<p>þar sem skekkjuliðurinn <span class="math notranslate nohighlight">\(r(x)\)</span> er gefinn með formúlunni</p>
<div class="math notranslate nohighlight">
\[r(x)=f[x_0,\ldots,x_n,x](x-x_0)\cdots(x-x_n)\]</div>
<p>Ef við tökum <span class="math notranslate nohighlight">\(p'(a)\)</span> sem nálgun á <span class="math notranslate nohighlight">\(f'(a)\)</span> er skekkjan</p>
<div class="math notranslate nohighlight">
\[r'(a) =  f'(a) - p'(a).\]</div>
</section>
<section id="index-5">
<span id="id1"></span><h3><span class="section-number">4.3.2. </span>Skekkjumat<a class="headerlink" href="#index-5" title="Permalink to this heading"></a></h3>
<p>Munið að formúlan fyrir afleiðu af margfeldi margra þátta er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
  (\varphi_1\varphi_2\varphi_3\cdots\varphi_m)'(a)\\
=\varphi_1'(a)\varphi_2(a)\varphi_3(a)\cdots\varphi_m(a)
+\varphi_1(a)\varphi_2'(a)\varphi_3(a)\cdots\varphi_m(a)
+\cdots\\
\cdots+\varphi_1(a)\varphi_2(a)\cdots \varphi_{m-1}(a)\varphi_m'(a)\\\end{gathered}\end{split}\]</div>
<p>Horfum nú á skekkjuliðinn <span class="math notranslate nohighlight">\(r(x)\)</span>. Hann er svona margfeldi með
<span class="math notranslate nohighlight">\(\varphi_1(x)=f[x_0,\dots,x_n,x]\)</span>, <span class="math notranslate nohighlight">\(\varphi_2(x)=x-x_0\)</span>,
<span class="math notranslate nohighlight">\(\varphi_3(x)=x-x_1\)</span> o.s.frv.</p>
<p>Athugum nú að ef <span class="math notranslate nohighlight">\(a\)</span> er einn af gefnu punktunum <span class="math notranslate nohighlight">\(x_k\)</span>, þá er
<span class="math notranslate nohighlight">\(\varphi_{k+2}(x)=(x-x_k)\)</span> sem gefur <span class="math notranslate nohighlight">\(\varphi_{k+2}(x_k)=0\)</span>
og <span class="math notranslate nohighlight">\(\varphi_{k+2}'(x_k)=1\)</span>.</p>
<p>Þetta segir okkur að ef við tökum <span class="math notranslate nohighlight">\(a=x_k\)</span>, þá eru allir liðirnir í
summunni í hægri hliðinni <span class="math notranslate nohighlight">\(0\)</span> nema einn, þ.e. við sitjum eftir með
þann sem inniheldur <span class="math notranslate nohighlight">\({\varphi}_{k+2}'\)</span>.</p>
<p>Niðurstaðan verður því að skekkjan í nálgun á <span class="math notranslate nohighlight">\(f'(a)\)</span> með
<span class="math notranslate nohighlight">\(p'(a)\)</span> er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f'(a) - p'(a) &amp;= r'(a)
=f[x_0,\dots,x_n,x_k]
\prod_{\stackrel{j=0}{j \not= k}} (x_k-x_j)\\
&amp;=\dfrac{f^{(n+1)}(\xi)}{(n+1)!}
  \prod_{\stackrel{j=0}{j \not= k}} (a-x_j)\end{aligned}\end{split}\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(a=x_k\)</span>.</p>
<p>Hér notuðum við skekkjumatið fyrir Newton aðferðina sem
segir að til er <span class="math notranslate nohighlight">\(\xi\)</span> á minnsta bilinu sem inniheldur
<span class="math notranslate nohighlight">\(x_0,\ldots,x_n,x_k\)</span> sem uppfyllir</p>
<div class="math notranslate nohighlight">
\[f[x_0,\ldots,x_n,x_k] = \frac{f^{(n+1)}(\xi)}{(n+1)!}.\]</div>
</section>
<section id="id2">
<h3><span class="section-number">4.3.3. </span>Frammismunur<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>Nálgum <span class="math notranslate nohighlight">\(f\)</span> með fyrsta stigs brúunarmargliðunni gegnum punktana
<span class="math notranslate nohighlight">\((a,f(a))\)</span> og <span class="math notranslate nohighlight">\((a+h,f(a+h))\)</span> (þ.e. <span class="math notranslate nohighlight">\(x_0 = a\)</span> og
<span class="math notranslate nohighlight">\(x_1 = a+h\)</span>),</p>
<div class="math notranslate nohighlight">
\[f(x)=f[a]+f[a,a+h](x-a)+f[a,a+h,x](x-a)(x-a-h)\]</div>
<p>Af þessu leiðir formúlan sem við vorum áður komin með</p>
<div class="math notranslate nohighlight">
\[f'(a)=f[a,a+h]+f[a,a+h,a](a-a-h)
  =\dfrac{f(a+h)-f(a)}h-\tfrac 12 f''(\xi)h\]</div>
<p>Þar sem <span class="math notranslate nohighlight">\(\xi\)</span> er á milli <span class="math notranslate nohighlight">\(a\)</span> og <span class="math notranslate nohighlight">\(a+h\)</span> og uppfyllir að
<span class="math notranslate nohighlight">\(f[a,a+h,a]=f[a,a,a+h]=\tfrac 12f''(\xi)\)</span>. Hér erum við að
notafæra okkur aftur skekkjumatið sem við sönnuðum í kaflanum um
brúunarmargliður.</p>
</section>
<section id="id3">
<h3><span class="section-number">4.3.4. </span>Miðsettur mismunakvóti<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p>Tökum þriggja punkta brúunarformúlu með <span class="math notranslate nohighlight">\(a-h\)</span>, <span class="math notranslate nohighlight">\(a+h\)</span> og
<span class="math notranslate nohighlight">\(a\)</span>. Þá er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f(x)&amp;=f[a-h]+f[a-h,a+h](x-a+h)\\
  &amp;+f[a-h,a+h,a](x-a+h)(x-a-h)\\
  &amp;+f[a-h,a+h,a,x](x-a+h)(x-a-h)(x-a)\end{aligned}\end{split}\]</div>
<p>Athugum að afleiðan af annars stigs þættinum</p>
<div class="math notranslate nohighlight">
\[x\mapsto (x-a+h)(x-a-h)=(x-a)^2-h^2\]</div>
<p>er <span class="math notranslate nohighlight">\(0\)</span> í punktinum <span class="math notranslate nohighlight">\(a\)</span> og því er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f'(a)&amp;=f[a-h,a+h]+f[a-h,a+h,a,a](-h^2)\\
  &amp;=\dfrac{f(a+h)-f(a-h)}{2h}-\tfrac 16 f'''(\xi)h^2 \end{aligned}\end{split}\]</div>
<p>Hér nýttum við okkur að til er <span class="math notranslate nohighlight">\(\xi\)</span> á milli <span class="math notranslate nohighlight">\(a-h\)</span> og
<span class="math notranslate nohighlight">\(a+h\)</span> þannig að <span class="math notranslate nohighlight">\(f[a-h,a+h,a,a]=\tfrac 16 f'''(\xi)\)</span>.</p>
</section>
<section id="id4">
<h3><span class="section-number">4.3.5. </span>Miðsettur mismunakvóti fyrir aðra afleiðu<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<p>Áfram heldur leikurinn. Nú skulum við leiða aftur út formúluna fyrir
nálgun á <span class="math notranslate nohighlight">\(f''(a)\)</span> með miðsettum mismunakvóta</p>
<p>Þá tökum við þriggja punkta brúunarformúlu með <span class="math notranslate nohighlight">\(a-h\)</span>, <span class="math notranslate nohighlight">\(a+h\)</span>
og <span class="math notranslate nohighlight">\(a\)</span> með <span class="math notranslate nohighlight">\(a\)</span> tvöfaldan. Þá er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f(x)&amp;=f[a-h]+f[a-h,a+h](x-a+h)\\
  &amp;+f[a-h,a+h,a](x-a+h)(x-a-h)\\
  &amp;+f[a-h,a+h,a,a](x-a+h)(x-a-h)(x-a)\\
  &amp;+f[a-h,a+h,a,a,x](x-a+h)(x-a-h)(x-a)^2\end{aligned}\end{split}\]</div>
<p>Gætum þess að halda liðnum <span class="math notranslate nohighlight">\((x-a)\)</span>. Þá fáum við</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f(x)&amp;=f[a-h]+f[a-h,a+h](x-a+h)\\
  &amp;+f[a-h,a+h,a]\big((x-a)^2-h^2)\big)\\
  &amp;+f[a-h,a+h,a,a]\big((x-a)^3-h^2(x-a))\big)\\
  &amp;+f[a-h,a+h,a,a,x]\big((x-a)^4-h^2(x-a)^2)\big)\end{aligned}\end{split}\]</div>
<p>Nú þurfum við að reikna aðra afleiðu í punktinum <span class="math notranslate nohighlight">\(a\)</span>. Athugum að
önnur afleiða af annars stigs þættinum</p>
<div class="math notranslate nohighlight">
\[x\mapsto (x-a+h)(x-a-h)=(x-a)^2-h^2\]</div>
<p>er fastafallið <span class="math notranslate nohighlight">\(2\)</span>, önnur afleiða af þriðja stigs liðnum</p>
<div class="math notranslate nohighlight">
\[x\mapsto (x-a)^3-h^2(x-a)\]</div>
<p>er <span class="math notranslate nohighlight">\(0\)</span> í punktinum <span class="math notranslate nohighlight">\(a\)</span> og önnur afleiða af fjórða stigs
liðnum</p>
<div class="math notranslate nohighlight">
\[x\mapsto (x-a)^4-h^2(x-a)^2\]</div>
<p>er fastafallið <span class="math notranslate nohighlight">\(-2h^2\)</span>.</p>
<p>Við höfum því</p>
<div class="math notranslate nohighlight">
\[f''(a)=2f[a-h,a+h,a]+f[a-h,a+h,a,a,a](-2h^2)\]</div>
<p>Nú er til punktur <span class="math notranslate nohighlight">\(\xi\)</span> á minnsta bili sem inniheldur <span class="math notranslate nohighlight">\(a-h\)</span>,
<span class="math notranslate nohighlight">\(a+h\)</span> og <span class="math notranslate nohighlight">\(a\)</span> þannig að <span class="math notranslate nohighlight">\(f[a-h,a+h,a,a,a]=\tfrac
1{24}f^{(4)}(\xi)\)</span>.</p>
<p>Við þurfum að reikna út fyrri mismunakvótann</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f[a-h,a+h,a]&amp;=f[a-h,a,a+h]=\dfrac{f[a,a+h]-f[a-h,a]}{2h}\\
  &amp;=\dfrac 1{2h}\bigg(\dfrac{f(a+h)-f(a)}h-\dfrac{f(a)-f(a-h)}h\bigg)\\
  &amp;=\dfrac{f(a+h)+f(a-h)-2f(a)}{2h^2}  \end{aligned}\end{split}\]</div>
<p>Við höfum því leitt aftur út formúluna</p>
<div class="math notranslate nohighlight">
\[f''(a)=\dfrac{f(a+h)+f(a-h)-2f(a)}{h^2}-\tfrac
  1{12}f^{(4)}(\xi)h^2\]</div>
</section>
</section>
<section id="richardson-utgiskun">
<span id="index-6"></span><h2><span class="section-number">4.4. </span>Richardson útgiskun<a class="headerlink" href="#richardson-utgiskun" title="Permalink to this heading"></a></h2>
<p>Það ætti að vera ljóst að töluleg deildun er nokkuð óstöðug aðferð því
ef skrefastærðin <span class="math notranslate nohighlight">\(h\)</span> er lítil eru tölurnar
<span class="math notranslate nohighlight">\(f(a+h), f(a), f(a-h)\)</span> nálægt hver annarri og við getum lent í
styttingarskekkjum.</p>
<p>Því er ekki hægt að búast við að fá alltaf betri nálgun á <span class="math notranslate nohighlight">\(f'(a)\)</span>
við að minnka skrefalengdina <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>Leiðin er Richardson útgiskun (e. extrapolation), sem er aðferð til að
bæta nálganir.</p>
<p>Til eru mjög almennar útgáfur þessarar aðferðar en við munum aðeins
skoða þau sértilfelli sem nýtast okkur mest.</p>
<section id="utleisla-a-misettum-mismunakvota">
<h3><span class="section-number">4.4.1. </span>Útleiðsla á miðsettum mismunakvóta<a class="headerlink" href="#utleisla-a-misettum-mismunakvota" title="Permalink to this heading"></a></h3>
<p>Við skulum byrja á að að leiða aftur út formúluna fyrir miðsettann
mismunakvóta til að fá betri upplýsingar um skekkjuliðinn. Fyrir fall
<span class="math notranslate nohighlight">\(f\)</span> sem er nógu oft deildanlegt má beita Taylor til að skrifa</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f(a+h) &amp;= f(a) + f'(a)h   + \ldots
  + \frac{f^{(2n)}(a)}{(2n!)}h^{2n}
  + \frac{f^{(2n+1)}(a)}{(2n+1)!)}h^{2n+1} + O(h^{2n+2}) \\
  f(a-h) &amp;= f(a) - f'(a)h
    + \ldots
  + \frac{f^{(2n)}(a)}{(2n!)}h^{2n}
  - \frac{f^{(2n+1)}(a)}{(2n+1)!)}h^{2n+1} + O(h^{2n+2})\end{aligned}\end{split}\]</div>
<p>Ef við drögum seinni jöfnuna frá þeirri fyrri fæst</p>
<div class="math notranslate nohighlight">
\[f(a+h)-f(a-h) = 2f'(a)h + 2\frac{f'''(a)}{3!}h^3
  + \ldots + 2\frac{f^{(2n+1)}(a)}{(2n+1)!}h^{2n+1} + O(h^{2n+2})\]</div>
<p>svo ef við einangrum <span class="math notranslate nohighlight">\(f'(a)\)</span> sjáum við að</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_1(h)
  + a_2 h^2 + a_4 h^4 + \ldots + a_{2n} h^{2n} + O(h^{2n+1})\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[R_1(h) = \frac{f(a+h)-f(a-h)}{2h}
  \quad \text{og} \quad
  a_k = -\frac{f^{(k+1)}(a)}{(k+1)!},
  \quad k = 2,4,\ldots,2n.\]</div>
</section>
<section id="helmingun-a-skrefinu">
<h3><span class="section-number">4.4.2. </span>Helmingun á skrefinu<a class="headerlink" href="#helmingun-a-skrefinu" title="Permalink to this heading"></a></h3>
<p>Hér er minnsta veldi í skekkjuliðnum <span class="math notranslate nohighlight">\(h^2\)</span>, svo nálgunin
<span class="math notranslate nohighlight">\(f'(a)
\approx R_1(h)\)</span> er <span class="math notranslate nohighlight">\(O(h^2)\)</span>, eins og við höfum reyndar séð áður.
Helmingum nú skrefalengdina <span class="math notranslate nohighlight">\(h\)</span>, þá fæst</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_1(h/2) + a_2 \left(\frac{h}{2}\right)^2
  + a_4 \left(\frac{h}{2}\right)^4 + \ldots
  + a_{2n} \left(\frac{h}{2}\right)^{2n} + O(h^{2n+1}).\]</div>
<p>Nú berum við saman þessi tvö skref:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f'(a) &amp;= R_1(h/2) + \tfrac 14 a_2 h^2
  + a_4 \left(\frac{h}{2}\right)^4 + \ldots
  + a_{2n} \left(\frac{h}{2}\right)^{2n} + O(h^{2n+1}),\\
  f'(a) &amp;= R_1(h)
  + a_2 h^2 + a_4 h^4 + \ldots + a_{2n} h^{2n} + O(h^{2n+1})\\\end{aligned}\end{split}\]</div>
<p>Margföldum efri jöfnuna með <span class="math notranslate nohighlight">\(4\)</span> og drögum þá síðari frá. Þá
stendur eftir</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  3f'(a) &amp;= 4 R_1(h/2) - R_1(h)
  + a_4 \left( \frac{4}{2^4} - 1 \right)h^4 \\
  &amp;+ a_6 \left( \frac{4}{2^6} - 1 \right)h^6
  + \ldots
  + a_{2n} \left( \frac{4}{2^{2n}} - 1 \right)h^{2n}
  + O(h^{2n+1})\end{aligned}\end{split}\]</div>
</section>
<section id="fjora-stigs-nalgun">
<h3><span class="section-number">4.4.3. </span>Fjórða stigs nálgun<a class="headerlink" href="#fjora-stigs-nalgun" title="Permalink to this heading"></a></h3>
<p>Nú erum við komin með nýja formúlu:</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_2(h) + b_4 h^4 + b_6 h^6 + \ldots + b_{2n} h^{2n}
  + O(h^{2n+1})\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[R_2(h) = \frac{4 R_1(h/2) - R_1(h)}{3}
  \quad \text{og} \quad
  b_k = \frac{a_k}{3} \cdot \left(\frac{4}{2^k}-1\right),
  \  k = 4,6,\ldots,2n.\]</div>
<p>Ef við berum þetta saman við jöfnuna sem við byrjuðum með</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_1(h)
  + a_2 h^2 + a_4 h^4 + \ldots + a_{2n} h^{2n} + O(h^{2n+1})\]</div>
<p>þá sjáum við að minnsta veldi í skekkjuliðnum er <span class="math notranslate nohighlight">\(h^4\)</span>, svo
nálgunin <span class="math notranslate nohighlight">\(f'(a)
\approx R_2(h)\)</span> uppfyllir</p>
<div class="math notranslate nohighlight">
\[f'(a) - R_2(h) = O(h^4)\]</div>
<p>og er því betri nálgun en áður.</p>
<p>Þetta ferli heitir <em>Richardson útgiskun</em>.</p>
</section>
<section id="haegt-er-a-halda-afram-utgiskun">
<h3><span class="section-number">4.4.4. </span>Hægt er að halda áfram útgiskun<a class="headerlink" href="#haegt-er-a-halda-afram-utgiskun" title="Permalink to this heading"></a></h3>
<p>Næsta takmark er að eyða liðnum <span class="math notranslate nohighlight">\(b_4h^4\)</span> úr þessari formúlu með
því að líta á</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_2(h/2) + b_4 \left(\frac{h}{2}\right)^4
  + b_6 \left(\frac{h}{2}\right)^6 + \ldots
  + b_{2n} \left(\frac{h}{2}\right)^{2n} + O(h^{2n+1})\]</div>
<p>Síðan stillum við þessari jöfnu upp með þeirri síðari</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  f'(a) &amp;= R_2(h/2) + \tfrac 1{16}b_4 h^4
  + \tfrac 1{64}b_6 h^6 + \ldots
  + \tfrac 1{2^{2n}}b_{2n} h^{2n} + O(h^{2n+1})\\
  f'(a) &amp;= R_2(h) + b_4 h^4 + b_6 h^6 + \ldots + b_{2n} h^{2n}
  + O(h^{2n+1})\end{aligned}\end{split}\]</div>
<p>Margföldum fyrri jöfnuna með <span class="math notranslate nohighlight">\(16\)</span> og drögum þá síðari frá</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  15f'(a) &amp;= 16 R_2(h/2) - R_2(h)
  + b_6 \left( \frac{16}{2^6} - 1 \right) h^6 \\
  &amp;+ b_8 \left( \frac{16}{2^8} - 1 \right) h^8
  + \ldots
  + b_{2n} \left( \frac{16}{2^{2n}} - 1 \right) h^{2n}
  + O(h^{2n+1}).\end{aligned}\end{split}\]</div>
</section>
<section id="sjotta-stigs-skekkja">
<h3><span class="section-number">4.4.5. </span>Sjötta stigs skekkja<a class="headerlink" href="#sjotta-stigs-skekkja" title="Permalink to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  15f'(a) &amp;= 16 R_2(h/2) - R_2(h)
  + b_6 \left( \frac{16}{2^6} - 1 \right) h^6 \\
  &amp;+ b_8 \left( \frac{16}{2^8} - 1 \right) h^8
  + \ldots
  + b_{2n} \left( \frac{16}{2^{2n}} - 1 \right) h^{2n}
  + O(h^{2n+1}).\end{aligned}\end{split}\]</div>
<p>Því er</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_3(h) + c_6 h^6 + c_8 h^8 \ldots + c_{2n} h^{2n}
  + O(h^{2n+1})\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[R_3(h) = \frac{16 R_2(h/2) - R_2(h)}{15},
  \quad \text{og} \quad
  c_k = \frac{b_k}{15} \cdot \left( \frac{16}{2^k} - 1 \right),
  \quad k = 6,8,\ldots,2n.\]</div>
<p>Nýja nálgunin uppfyllir</p>
<div class="math notranslate nohighlight">
\[f'(a) - R_3(h) = O(h^6)\]</div>
<p>og er því enn betri en áður, en við þurfum líka að reikna út
<span class="math notranslate nohighlight">\(R_1(h/4)\)</span> til að reikna <span class="math notranslate nohighlight">\(R_2(h/2)\)</span>.</p>
</section>
<section id="almenn-rakningarformula">
<h3><span class="section-number">4.4.6. </span>Almenn rakningarformúla<a class="headerlink" href="#almenn-rakningarformula" title="Permalink to this heading"></a></h3>
<p>Richardson-útgiskunin heldur áfram og út kemur</p>
<div class="math notranslate nohighlight">
\[R_{i+1}(h) = \frac{4^i R_i(h/2) - R_i(h)}{4^i-1}
  = R_i(h/2) + \frac{R_i(h/2)-R_i(h)}{4^i-1}\]</div>
<p>fyrir <span class="math notranslate nohighlight">\((i+1)\)</span>-tu Richardson útgiskun og <span class="math notranslate nohighlight">\(R_{i+1}(h)\)</span>
uppfyllir að</p>
<div class="math notranslate nohighlight">
\[f'(a) - R_{i+1}(h) = O(h^{2i+2}),\]</div>
<p>en á móti kemur að til að reikna út <span class="math notranslate nohighlight">\(R_{i+1}(h)\)</span> þurfum við að
hafa reiknað út tölurnar</p>
<div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(R_1(h)\)</span>, <span class="math notranslate nohighlight">\(R_1(h/2)\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span>, <span class="math notranslate nohighlight">\(R_1(h/2^i)\)</span>
auk</div>
<div class="line"><span class="math notranslate nohighlight">\(R_2(h)\)</span>, <span class="math notranslate nohighlight">\(R_2(h/2)\)</span>, …, <span class="math notranslate nohighlight">\(R_2(h/2^{i-1})\)</span> og svo
framvegis að</div>
<div class="line"><span class="math notranslate nohighlight">\(\qquad \vdots\)</span></div>
<div class="line"><span class="math notranslate nohighlight">\(R_i(h)\)</span> og <span class="math notranslate nohighlight">\(R_i(h/2)\)</span>.</div>
</div>
<p>Eins og áður sagði fara styttingarskekkjur á endanum að segja til sín í
útreikningum á <span class="math notranslate nohighlight">\(R_1(h)\)</span>, svo einhver takmörk eru fyrir hversu
margar Richardson útgiskanir er hægt að framkvæma.</p>
</section>
<section id="reiknirit">
<h3><span class="section-number">4.4.7. </span>Reiknirit<a class="headerlink" href="#reiknirit" title="Permalink to this heading"></a></h3>
<p>Útreikningarnir að ofan eru yfirleitt settir fram í töflu</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{ccccc}
    D(1,1) &amp;   &amp;   &amp;   &amp;   \\
    D(2,1) &amp; D(2,2) &amp;  &amp;  &amp;  \\
    D(3,1) &amp; D(3,2) &amp; D(3,3) &amp; &amp; \\
    \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \\
    D(n,1) &amp; D(n,2) &amp; D(n,3) &amp; \ldots &amp; D(n,n)
  \end{array}\end{split}\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(D(i,j) = R_j(h/2^{i-j})\)</span> og þar með</p>
<div class="math notranslate nohighlight">
\[\begin{split}D(i,j) = \begin{cases}
    \dfrac{f(a+h/2^{i-1})-f(a-h/2^{i-1})}{2\cdot h/2^{i-1}}, &amp; j = 1 \\
    D(i,j-1) + \dfrac{D(i,j-1)-D(i-1,j-1)}{4^{j-1}-1}, &amp; j &gt; 1
  \end{cases}\end{split}\]</div>
<p>sem gerir okkur auðvelt að forrita Richardson útgiskun.</p>
</section>
<section id="id5">
<h3><span class="section-number">4.4.8. </span>Skekkjumat<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<p>Finnum nú eftirámat fyrir <span class="math notranslate nohighlight">\(D(i,j)\)</span> með stærðunum
<span class="math notranslate nohighlight">\(D(i,j-1)\)</span> og <span class="math notranslate nohighlight">\(D(i-1,j-1)\)</span>. Hér á eftir er
<span class="math notranslate nohighlight">\(R_j(h/2)\)</span> í hlutverki <span class="math notranslate nohighlight">\(D(i,j-1)\)</span> og <span class="math notranslate nohighlight">\(R_i(h)\)</span> í
hlutverki <span class="math notranslate nohighlight">\(D(i-1,j-1)\)</span>
(<span class="math notranslate nohighlight">\(h\)</span> er helmingað þegar við förum niður um eina línu).</p>
<p>Munum að <span class="math notranslate nohighlight">\(R_i(h)\)</span> uppfyllir að</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_j(h) + Kh^{2j} + O(h^{2j+1})\]</div>
<p>fyrir eitthvert <span class="math notranslate nohighlight">\(K\)</span> í <span class="math notranslate nohighlight">\(\mathbb R\)</span> og að</p>
<div class="math notranslate nohighlight">
\[f'(a) = R_j(h/2) + K \left( \frac{h}{2} \right)^{2j}
  + O(h^{2j+1})\]</div>
<p>Ef við tökum mismun á hægri og vinstri hliðum þessara jafna, þá fáum við</p>
<div class="math notranslate nohighlight">
\[0 = R_j(h) - R_j(h/2) + K \left(1 - \frac{1}{2^{2j}}\right)h^{2j}
  + O(h^{2j+1})\]</div>
<p>og ef við einangrum <span class="math notranslate nohighlight">\(K\)</span> fæst</p>
<div class="math notranslate nohighlight">
\[K = -\frac{4^{j}}{h^{2j}} \cdot \frac{R_j(h)-R_j(h/2)}{4^{j}-1} +
O(h^{2j+1}).\]</div>
</section>
<section id="utleisla-a-fyrirframmati">
<h3><span class="section-number">4.4.9. </span>Útleiðsla á fyrirframmati<a class="headerlink" href="#utleisla-a-fyrirframmati" title="Permalink to this heading"></a></h3>
<p>Þá er skekkjan í nálgun á <span class="math notranslate nohighlight">\(f'(a)\)</span> með <span class="math notranslate nohighlight">\(R_j(h/2)\)</span> jöfn</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  e_j(h/2) &amp;= f'(a) - R_j(h/2) \\
  &amp;= K\left(\frac{h}{2}\right)^{2j} + O(h^{2j+1}) \\
  &amp;= -\frac{R_j(h)-R_j(h/2)}{4^{j}-1} + O(h^{2j+1}) \\
  &amp;\approx -\frac{R_j(h)-R_j(h/2)}{4^{j}-1}.\end{aligned}\end{split}\]</div>
<p>Þar sem <span class="math notranslate nohighlight">\(R_j(h/2)\)</span> er nálgun á <span class="math notranslate nohighlight">\(f'(a)\)</span> af stigi
<span class="math notranslate nohighlight">\(O(h^{2j+1})\)</span>, en <span class="math notranslate nohighlight">\(R_{j+1}(h)\)</span> er nálgun á <span class="math notranslate nohighlight">\(f'(a)\)</span> af
stigi <span class="math notranslate nohighlight">\(O(h^{2i+3})\)</span> getum við slegið á <span class="math notranslate nohighlight">\(e_{j+1}(h)\)</span> með
<span class="math notranslate nohighlight">\(e_j(h/2)\)</span>. Ef við lækkum vísinn <span class="math notranslate nohighlight">\(j+1\)</span> um einn gefur það
okkur matið</p>
<div class="math notranslate nohighlight">
\[e_j(h) \approx \frac{R_{j-1}(h)-R_{j-1}(h/2)}{4^{j-1}-1} =
  \frac{D(i,j-1)-D(i-1,j-1)}{4^{j-1}-1}\]</div>
<p>sem er einmitt liðurinn í rakningarformúlunni fyrir <span class="math notranslate nohighlight">\(D(i,j)\)</span>.</p>
</section>
<section id="synidaemi">
<h3><span class="section-number">4.4.10. </span>Sýnidæmi<a class="headerlink" href="#synidaemi" title="Permalink to this heading"></a></h3>
<p>Látum <span class="math notranslate nohighlight">\(f(x)=x/(x^2+4)^{2/3}\)</span> og <span class="math notranslate nohighlight">\(a=-1\)</span>. Byrjum með
<span class="math notranslate nohighlight">\(h=1\)</span> og notum svo rakningarformúluna til þess að fylla út
útgiskunartöfluna.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(h\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(D(i,1)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(D(i,2)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(D(i,3)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(D(i,4)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 .</p></td>
<td><p>0.25000000</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0.5</p></td>
<td><p>0.25151838</p></td>
<td><p>0.25202451</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>0.25</p></td>
<td><p>0.25104655</p></td>
<td><p>0.25088928</p></td>
<td><p>0.25081360</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>0.125</p></td>
<td><p>0.25086355</p></td>
<td><p>0.25080254</p></td>
<td><p>0.25079676</p></td>
<td><p>0.25079649</p></td>
</tr>
</tbody>
</table>
<p>Niðustaðan er: <span class="math notranslate nohighlight">\(f'(-1)\approx   0.2507964\)</span>, með eftirámat á
skekkju <span class="math notranslate nohighlight">\(-3\cdot 10^{-7}\)</span>.</p>
<p>Rétt gildi er <span class="math notranslate nohighlight">\(0.25079647217924889177\)</span>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../kafli03/" class="btn btn-neutral float-left" title="3. Brúun" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../kafli05/" class="btn btn-neutral float-right" title="5. Töluleg heildun" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    /* Sidebar header (and topbar for mobile) */
    
    .wy-side-nav-search,
    .wy-nav-top {
        background: #10099F;
    }
    /* Sidebar */
    
    .wy-nav-side {
        background: #262626;
    }
</style>


</body>
</html>