<!DOCTYPE html>
<html class="writer-html5" lang="is" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>5. Töluleg heildun &mdash; Töluleg greining (STÆ405G) </title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/eqt.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/datacamp-custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/edbook.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_2.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/js/eqt.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
        <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

<script>
    // the buttonText string says what will be written on the 
    // sage cell evaluation button.
    // It can be changed here.
    var buttonText = "Keyra"
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sage",
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsage",
        languages: ["r"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osage",
        languages: ["octave"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAuto",
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAuto",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAuto",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAutoHidden",
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAutoHidden",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAutoHidden",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>


<style type="text/css">
    .sagecell .CodeMirror-scroll {
        overflow-y: hidden;
        overflow-x: auto;
    }
    
    .sagecell .CodeMirror {
        height: auto;
    }
</style>


    <link rel="index" title="Atriðaskrá" href="../genindex/" />
    <link rel="search" title="Leit" href="../search/" />
    <link rel="next" title="6. Upphafsgildisverkefni" href="../kafli06/" />
    <link rel="prev" title="4. Töluleg diffrun" href="../kafli04/" />  
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Töluleg greining (STÆ405G)
              <img src="../_static/haskoli_islands-edbook.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../kafli01/">1. Inngangur</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli02/">2. Núllstöðvar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli03/">3. Brúun</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli04/">4. Töluleg diffrun</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Töluleg heildun</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aferirnar">5.1. Aðferðirnar</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#newton-cotes-heildun">5.1.1. Newton-Cotes heildun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#synidaemi">5.1.2. Sýnidæmi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trapisureglan">5.1.3. Trapisureglan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mipunktsreglan">5.1.4. Miðpunktsreglan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#regla-simpsons">5.1.5. Regla Simpsons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#samsettar-utgafur">5.2. Samsettar útgáfur</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inngangur">5.2.1. Inngangur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samsetta-trapisureglan">5.2.2. Samsetta trapisureglan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samsetta-mipunktsreglan">5.2.3. Samsetta miðpunktsreglan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samsett-regla-simpsons">5.2.4. Samsett regla Simpsons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#skekkjumat">5.3. Skekkjumat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">5.3.1. Inngangur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mealgildissetningin-fyrir-heildi">5.3.2. Meðalgildissetningin fyrir heildi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">5.3.3. Trapisureglan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">5.3.4. Samsetta trapisureglan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mipunktsregla">5.3.5. Miðpunktsregla</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">5.3.6. Samsetta miðpunktsreglan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">5.3.7. Regla Simpsons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">5.3.8. Samsett regla Simpsons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#romberg-utgiskun">5.4. Romberg-útgiskun</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#euler-maclauren-formulan">5.4.1. Euler-Maclauren-formúlan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#afleiing-af-euler-maclaurin-formulunni">5.4.2. Afleiðing af Euler-Maclaurin-formúlunni</a></li>
<li class="toctree-l3"><a class="reference internal" href="#itrekun-a-samsettu-trapisureglunni-me-helmingun">5.4.3. Ítrekun á samsettu trapisureglunni með helmingun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reikniriti-fyrir-romberg-heildun">5.4.4. Reikniritið fyrir Romberg-heildun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#skekkjumat-i-romberg-heildun">5.4.5. Skekkjumat í Romberg heildun</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kafli06/">6. Upphafsgildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli07/">7. Jaðargildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli08/">8. Jöfnuhneppi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli09/">9. Eigingildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli10/">10. Monte Carlo hermanir</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vidauki/">Viðauki</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Töluleg greining (STÆ405G)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">5. </span>Töluleg heildun</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/edbook/haskoli-islands/blob/master/projects/stae405g/kafli05.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="heildun"></span><section id="toluleg-heildun">
<span id="index-0"></span><h1><span class="section-number">5. </span>Töluleg heildun<a class="headerlink" href="#toluleg-heildun" title="Permalink to this heading"></a></h1>
<p><em>So much universe, and so little time.</em>
– Terry Pratchett</p>
<p>Gerum ráð fyrir að <span class="math notranslate nohighlight">\(x_0,x_1, \ldots, x_n\)</span> séu punktar á bilinu
<span class="math notranslate nohighlight">\([a,b]\)</span> og að við þekkjum gildi <span class="math notranslate nohighlight">\(f\)</span> í þessum punktum. Þá
getum við fundið brúunarmargliðuna <span class="math notranslate nohighlight">\(p_n\)</span> gegnum punktana
<span class="math notranslate nohighlight">\((x_k,f(x_k))\)</span> og skrifað</p>
<div class="math notranslate nohighlight">
\[f(x) = p_n(x) + r_n(x),\]</div>
<p>þar sem skekkjan <span class="math notranslate nohighlight">\(r_n\)</span> er gefin með</p>
<div class="math notranslate nohighlight">
\[r_n(x) = f[x_0,\ldots,x_n,x](x-x_0)\cdots(x-x_n).\]</div>
<p>Nú er auðvelt að reikna heildi margliða, svo við nálgum heildi
<span class="math notranslate nohighlight">\(f\)</span> með</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b f(x) dx \approx
  I_n(f) := \int\limits_a^b p_n(x) dx\]</div>
<p>og skekkjan í þessari nálgun er gefin með</p>
<div class="math notranslate nohighlight">
\[e_n = \int\limits_a^b r_n(x) dx.\]</div>
<p>Þessi aðferð er kölluð <em>Newton-Cotes-heildun</em>.</p>
<section id="aferirnar">
<span id="index-1"></span><h2><span class="section-number">5.1. </span>Aðferðirnar<a class="headerlink" href="#aferirnar" title="Permalink to this heading"></a></h2>
<section id="newton-cotes-heildun">
<h3><span class="section-number">5.1.1. </span>Newton-Cotes heildun<a class="headerlink" href="#newton-cotes-heildun" title="Permalink to this heading"></a></h3>
<p>Hugsum okkur að brúunarpunktarnir <span class="math notranslate nohighlight">\(x_0, \ldots, x_n\)</span> séu ólíkir.
Þá getum við skrifað <span class="math notranslate nohighlight">\(p_n\)</span> með Lagrange-margliðum</p>
<div class="math notranslate nohighlight">
\[p_n(x) = \sum\limits_{k=0}^n f(x_k) \ell_k(x),
  \quad
  \ell_k(x) = \prod\limits_{\stackrel{j=0}{j \not= k}}^n
  \frac{(x-x_j)}{(x_k-x_j)},\]</div>
<p>og þá er heildi <span class="math notranslate nohighlight">\(p_n\)</span> jafnt</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b p_n(x) dx =
  \sum\limits_{k=0}^n f(x_k) A_k,
  \quad \text{þar sem} \quad
  A_k = \int\limits_a^b \ell_k(x) dx.\]</div>
<p>Athugið að gildi <span class="math notranslate nohighlight">\(A_k\)</span> veltur aðeins á brúunarpunktunum
<span class="math notranslate nohighlight">\(x_0, \ldots,
x_n\)</span> en ekki gildum <span class="math notranslate nohighlight">\(f(x_k)\)</span>. Ef það á að heilda mörg föll yfir
sama bil er því hægt að reikna gildi <span class="math notranslate nohighlight">\(A_k\)</span> í eitt skipti fyrir öll
og endurnýta þau svo.</p>
</section>
<section id="synidaemi">
<h3><span class="section-number">5.1.2. </span>Sýnidæmi<a class="headerlink" href="#synidaemi" title="Permalink to this heading"></a></h3>
<p>Metum heildi <span class="math notranslate nohighlight">\(f(x) = e^{-x}\cos(x)\)</span> og
<span class="math notranslate nohighlight">\(g(x) = \sin (\frac{x^2}{2})\)</span> yfir bilið <span class="math notranslate nohighlight">\([0,2]\)</span> með að nota
skiptipunktana <span class="math notranslate nohighlight">\(x_0 = 0\)</span>, <span class="math notranslate nohighlight">\(x_1 = 1\)</span> og <span class="math notranslate nohighlight">\(x_2 = 2\)</span>.
Lagrange-margliðurnar sem við eiga eru</p>
<div class="math notranslate nohighlight">
\[\ell_0(x) = \frac{(x-1)(x-2)}{2}, \quad
  \ell_1(x) = -x(x-2), \quad
  \ell_2(x) = \frac{x(x-1)}{2}\]</div>
<p>svo við fáum að</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
  A_0 = \frac{1}{2} \int\limits_0^2 (x-1)(x-2) dx = \frac{1}{3},
  \qquad
  A_1 = -\int\limits_0^2 x(x-2) dx = \frac{4}{3}, \\
  A_2 = \frac{1}{2} \int\limits_0^2 x(x-1) dx = \frac{1}{3}.\end{gathered}\end{split}\]</div>
<p>Nú eru stuðlarnir fundnir og því fáum við</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int\limits_0^2 f(x) dx &amp;\approx
  f(0)\frac{1}{3} + f(1)\frac{4}{3} + f(2)\frac{1}{3}\\
  &amp;= \frac{1 + 4e^{-1}\cos(1) + e^{-2}\cos(2)}{3}
  \approx 0.59581\end{aligned}\end{split}\]</div>
<p>og</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int\limits_0^2 g(x) dx &amp;\approx
  g(0)\frac{1}{3} + g(1)\frac{4}{3} + g(2)\frac{1}{3}\\
 &amp; = \frac{4\sin(1/2) + \sin(2)}{3}
  \approx 0.91972.\end{aligned}\end{split}\]</div>
<p>Gildi heildanna eru <span class="math notranslate nohighlight">\(\int\limits_0^2 f(x) dx \approx 0.58969\)</span> og
<span class="math notranslate nohighlight">\(\int\limits_0^2 g(x) dx \approx 0.99762\)</span> með 5 réttum aukastöfum
svo nálgunargildin verða að teljast nokkuð góð miðað við hversu lítið
fór í þau.</p>
</section>
<section id="trapisureglan">
<span id="index-2"></span><h3><span class="section-number">5.1.3. </span>Trapisureglan<a class="headerlink" href="#trapisureglan" title="Permalink to this heading"></a></h3>
<p>Nú ætlum við að leiða út formúlur fyrir helstu reglum fyrir nálgun á
heildum. Sú fyrsta er <em>trapisuregla</em>.</p>
<p>Veljum <span class="math notranslate nohighlight">\(x_0 = a\)</span> og <span class="math notranslate nohighlight">\(x_1 = b\)</span> sem skiptipunktana okkar. Þá
er graf <span class="math notranslate nohighlight">\(p_1\)</span> línustrikið gegnum <span class="math notranslate nohighlight">\((a,f(a))\)</span> og
<span class="math notranslate nohighlight">\((b,f(b))\)</span>,</p>
<div class="math notranslate nohighlight">
\[p_1(x) = f(a) \ell_0(x) + f(b) \ell_1(x)
  = f(a)\frac{b-x}{b-a} + f(b) \frac{x-a}{b-a}\]</div>
<p>og vigtirnar eru</p>
<div class="math notranslate nohighlight">
\[A_0 = \int\limits_a^b \ell_0(x) = \frac{b-a}{2} = A_1,\]</div>
<p>svo</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b f(x) dx \approx
  \frac{b-a}{2}\left(f(a)+f(b)\right).\]</div>
<p>Trapisureglan er kölluð þessu nafni því með henni nálgum við heildi
<span class="math notranslate nohighlight">\(f\)</span> með flatarmáli trapisunnar sem hefur hornpunktana
<span class="math notranslate nohighlight">\((a,0)\)</span>, <span class="math notranslate nohighlight">\((b,0)\)</span>, <span class="math notranslate nohighlight">\((b,f(b))\)</span> og <span class="math notranslate nohighlight">\((a,f(a))\)</span>.</p>
</section>
<section id="mipunktsreglan">
<span id="index-3"></span><h3><span class="section-number">5.1.4. </span>Miðpunktsreglan<a class="headerlink" href="#mipunktsreglan" title="Permalink to this heading"></a></h3>
<p>Enn einfaldari er <em>miðpunktsreglan</em>, þá veljum við aðeins einn
skiptipunkt, <span class="math notranslate nohighlight">\(x_0 = \frac{1}{2}(a+b)\)</span>, og brúunarmargliðan verður
fastamargliðan <span class="math notranslate nohighlight">\(p_0(x) = f(x_0)\)</span>. Þá er</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b f(x) dx \approx (b-a)\, f\left(\frac{a+b}{2}\right)\]</div>
</section>
<section id="regla-simpsons">
<span id="index-4"></span><h3><span class="section-number">5.1.5. </span>Regla Simpsons<a class="headerlink" href="#regla-simpsons" title="Permalink to this heading"></a></h3>
<p>Nú veljum við þrjá skiptipunkta, <span class="math notranslate nohighlight">\(x_0 = a\)</span>, <span class="math notranslate nohighlight">\(x_1 = b\)</span> og
<span class="math notranslate nohighlight">\(x_2 =
\frac{1}{2}(a+b)\)</span>. Til einföldunar skulum við hliðra fallinu <span class="math notranslate nohighlight">\(f\)</span>
um miðpunkt bilsins <span class="math notranslate nohighlight">\(m=\tfrac{1}{2}(a+b)\)</span>.</p>
<p>Við skilgreinum <span class="math notranslate nohighlight">\(\alpha=\tfrac 12(b-a)\)</span> og
<span class="math notranslate nohighlight">\(g(x) = f\big(x+m\big)\)</span></p>
<p>Þá hliðrast <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(m\)</span> og <span class="math notranslate nohighlight">\(b\)</span> yfir í <span class="math notranslate nohighlight">\(-\alpha\)</span>,
<span class="math notranslate nohighlight">\(0\)</span> og <span class="math notranslate nohighlight">\(\alpha\)</span> og</p>
<div class="math notranslate nohighlight">
\[\int\limits_{-\alpha}^{\alpha} g(x) dx =
  \int\limits_a^b f(x) dx.\]</div>
<p>Lagrange margliðurnar og vigtirnar eru</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  l_0(x) &amp;= \frac{(x-\alpha)x}{(-\alpha-\alpha)(-\alpha - 0)}
  = \frac{(x-\alpha)x}{2\alpha^2} \\
  A_0 &amp;= \int_{-\alpha}^{\alpha} l_0(x)\,dx = \frac{\alpha}{3} \\
  l_1(x) &amp;= \frac{(x-(-\alpha))(x-0)}{(\alpha - ( -\alpha))(\alpha - 0)}
  = \frac{(x+\alpha)x}{2\alpha^2}\\
  A_1 &amp;= \int_{-\alpha}^{\alpha} l_1(x)\,dx = \frac{\alpha}{3}\\
  l_2(x) &amp;= \frac{(x-(\alpha))(x-\alpha)}{0-(-\alpha)(0-\alpha)}
  = \frac{(x+\alpha)(x-\alpha)}{-\alpha^2}\\
  A_2 &amp;= \int_{\alpha}^{\alpha} l_2(x)\,dx = \frac{4\alpha}{3}\end{aligned}\end{split}\]</div>
<p>Nálgunarformúlan verður þá</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int_a^b f(x) \, dx = \int\limits_{-\alpha}^{\alpha} g(x) \, dx
  &amp;\approx \frac{\alpha}{3}g(-\alpha) + \frac{\alpha}{3}g(\alpha)
  + \frac{4\alpha}{3}g(0)\\
  &amp;=(b-a)\left( \frac{1}{6}f(a) + \frac{4}{6}f
    \left( \frac{a+b}{2}\right) + \frac{1}{6} f(b)  \right)\end{aligned}\end{split}\]</div>
<p>Ef við tökum brúunarmargliðu gegnum <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span> og
<span class="math notranslate nohighlight">\(\frac{1}{2}(a+b)\)</span> með <span class="math notranslate nohighlight">\(\frac{1}{2}(a+b)\)</span> tvöfaldan þá fáum
við 3. stigs brúunarmargliðu</p>
<div class="math notranslate nohighlight">
\[p_3(x) = p_2(x) + g[-\alpha, \alpha, 0, 0](x+\alpha)(x-\alpha)x\]</div>
<p>Heildið yfir seinni liðinn hægra megin er 0 því margliðan
<span class="math notranslate nohighlight">\((x+a)(x-a)x\)</span> er oddstæð, en heildið yfir fyrri liðinn er</p>
<div class="math notranslate nohighlight">
\[\frac \alpha3(g(-\alpha) + 4g(0) + g(\alpha)).\]</div>
<p>Út kemur því Simpson-regla.</p>
<div id="B6UuWv9fRIQptkyQSdOarc3hL8HgV1"></div>
<script>
var ggbApp_B6UuWv9fRIQptkyQSdOarc3hL8HgV1 = new GGBApplet({
"appName": "calculator", 
"width": 700, 
"height": 400, 
"material_id": "2677051", 
"preventFocus": true, 
"enableShiftDragZoom": false 
}, true);
ggbAppletId["B6UuWv9fRIQptkyQSdOarc3hL8HgV1"] = ggbApp_B6UuWv9fRIQptkyQSdOarc3hL8HgV1;
</script>
<p></p>
</section>
</section>
<section id="samsettar-utgafur">
<span id="index-5"></span><h2><span class="section-number">5.2. </span>Samsettar útgáfur<a class="headerlink" href="#samsettar-utgafur" title="Permalink to this heading"></a></h2>
<p><em>Sometimes the truth is arrived at by adding all the little lies together and
deducting them from the totality of what is known.</em>
– Terry Pratchett, Going Postal</p>
<section id="inngangur">
<h3><span class="section-number">5.2.1. </span>Inngangur<a class="headerlink" href="#inngangur" title="Permalink to this heading"></a></h3>
<p>Þar sem Newton-Cotes heildun notar brúunarmargliður fylgja henni nokkur
vandamál.</p>
<p>Ef okkur finnst nákvæmnin í nálguninni vera of lítil getum við ekki
búist við að hún batni við að fjölga skiptipunktum; þá hækkar stig
margliðunnar líklega sem orsakar sveiflukenndari hegðun.</p>
<p>Eins er ekki gott að halda sig við margliður af lægra stigi; ef bilið
sem á að heilda yfir er stórt væri mikil tilviljun að 1., 2. eða 3.
stigs brúunarmargliða nálgaði fallið vel á öllu bilinu.</p>
<p>Lausnin á þessu vandamáli er í sama anda og fyrir splæsibrúun. Við
veljum skiptingu</p>
<div class="math notranslate nohighlight">
\[a  =x_0 &lt; x_1 &lt; \ldots &lt; x_n = b\]</div>
<p>á bilinu <span class="math notranslate nohighlight">\([a,b]\)</span>.</p>
<p>Um heildi gildir að</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^bf(x)\, dx = \sum\limits_{k=1}^n \ \ \int\limits_{x_{k-1}}^{x_k} f(x) \, dx\]</div>
<p>svo við getum nálgað heildi <span class="math notranslate nohighlight">\(f\)</span> á sérhverju litlu hlutbili
<span class="math notranslate nohighlight">\([x_{k-1},x_k]\)</span> með að heilda brúunarmargliðu af lágu stigi og
lagt öll gildin saman til að fá nálgun á heildi <span class="math notranslate nohighlight">\(f\)</span> yfir allt
bilið.</p>
<p>Þegar ákveðin regla er notuð til að nálga heildi <span class="math notranslate nohighlight">\(f\)</span> á sérhverju
hlutbili er þetta kölluð <em>samsetta</em> útgáfa reglunnar. Einfalt er að
leiða út samsettar útgáfur reglanna að ofan.</p>
</section>
<section id="samsetta-trapisureglan">
<span id="index-6"></span><h3><span class="section-number">5.2.2. </span>Samsetta trapisureglan<a class="headerlink" href="#samsetta-trapisureglan" title="Permalink to this heading"></a></h3>
<p>Á sérhverju hlutbili er</p>
<div class="math notranslate nohighlight">
\[\int\limits_{x_{k-1}}^{x_k} f(x) \, dx
  \approx
  \frac{x_k-x_{k-1}}{2}(f(x_{k-1}) + f(x_k))\]</div>
<p>svo</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b f(x) \, dx
  \approx
  \sum\limits_{k=1}^n \frac{x_k-x_{k-1}}{2}(f(x_{k-1}) + f(x_k)).\]</div>
<p>Ef öll hlutbilin eru jafn löng og <span class="math notranslate nohighlight">\(h = x_k-x_{k-1}\)</span>, þá fæst</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
  \int\limits_a^b f(x) \, dx \\
  \approx
  h\left( \frac{1}{2}f(a) + f(a+h) + f(a+2h)
    + \cdots + f(a+(n-1)h) + \frac{1}{2}f(b) \right).\end{gathered}\end{split}\]</div>
<div id="fQYVy9GDat6nJJEAcQ5dE4k9SnRAne"></div>
<script>
var ggbApp_fQYVy9GDat6nJJEAcQ5dE4k9SnRAne = new GGBApplet({
"appName": "calculator", 
"width": 700, 
"height": 400, 
"material_id": "2687771", 
"preventFocus": true, 
"enableShiftDragZoom": false 
}, true);
ggbAppletId["fQYVy9GDat6nJJEAcQ5dE4k9SnRAne"] = ggbApp_fQYVy9GDat6nJJEAcQ5dE4k9SnRAne;
</script>
<p></p>
</section>
<section id="samsetta-mipunktsreglan">
<span id="index-7"></span><h3><span class="section-number">5.2.3. </span>Samsetta miðpunktsreglan<a class="headerlink" href="#samsetta-mipunktsreglan" title="Permalink to this heading"></a></h3>
<p>Fljótséð er að</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b f(x) \, dx
  \approx
  \sum\limits_{k=1}^n (x_k-x_{k-1})f
  \left(
    \frac{x_{k-1}+x_k}{2}
  \right)\]</div>
<p>Ef öll hlutbilin eru jafn löng verður formúlan</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b f(x) \, dx
  \approx
  h \sum\limits_{k=1}^n f \left(\frac{x_{k-1}+x_k}{2}\right)\]</div>
</section>
<section id="samsett-regla-simpsons">
<span id="index-8"></span><h3><span class="section-number">5.2.4. </span>Samsett regla Simpsons<a class="headerlink" href="#samsett-regla-simpsons" title="Permalink to this heading"></a></h3>
<p>Hér er venjan að velja <span class="math notranslate nohighlight">\(2n+1\)</span> jafndreifða skiptipunkta og fá
<span class="math notranslate nohighlight">\(n\)</span> jafn stór hlutbil. Þá er <span class="math notranslate nohighlight">\(h = \frac{b-a}{2n}\)</span>,
<span class="math notranslate nohighlight">\(x_k = a + kh\)</span> fyrir <span class="math notranslate nohighlight">\(k =
0,\ldots,2n\)</span> og hlutbilin eru <span class="math notranslate nohighlight">\([x_{2k-2},x_{2k}]\)</span> fyrir
<span class="math notranslate nohighlight">\(k = 1,
\ldots, n\)</span>.</p>
<p>Á hverju hlutbili er</p>
<div class="math notranslate nohighlight">
\[\int\limits_{x_{2k-2}}^{x_{2k}} f(x) \, dx
  \approx
  2h \left(
    \frac{1}{6} f(x_{2k-2}) + \frac{4}{6} f(x_{2k-1})
    + \frac{1}{6} f(x_{2k})
  \right)\]</div>
<p>svo að</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int\limits_a^b f(x) \, dx
  \approx &amp;
  \sum\limits_{k=1}^n
  \bigg(
    \frac{h}{3}
    \Big(
      f(x_{2k-2}) + 4f(x_{2k-1}) + f(x_{2k})
    \Big)
  \bigg) \\
  = &amp;
  \frac{h}{3}
  \Big(
    f(a) + 4f(a+h) + 2f(a+2h)+ 4f(a+3h) + 2f(a+4h) \\
    &amp;+ \cdots + 2f(a+(2n-2)h) + 4f(a+(2n-1)h) + f(b).
  \Big)\end{aligned}\end{split}\]</div>
</section>
</section>
<section id="skekkjumat">
<span id="index-9"></span><h2><span class="section-number">5.3. </span>Skekkjumat<a class="headerlink" href="#skekkjumat" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3><span class="section-number">5.3.1. </span>Inngangur<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>Rifjum upp grunnhugmyndina að baki nálgunarformúlunum. Við veljum
brúunarpunkta <span class="math notranslate nohighlight">\(x_0, \ldots, x_n\)</span> í <span class="math notranslate nohighlight">\([a,b]\)</span>, látum
<span class="math notranslate nohighlight">\(p_n\)</span> vera tilsvarandi brúunarmargliðu og skrifum</p>
<div class="math notranslate nohighlight">
\[f(x) = p_n(x) + r_n(x)\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(r_n(x) = f[x_0, \ldots , x_n, x](x-x_0) \cdots (x-x_n)\)</span>.
Þá er nálgunin</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,dx \approx \int_a^b p_n(x)\,dx\]</div>
<p>með skekkjuna</p>
<div class="math notranslate nohighlight">
\[\int_a^b r_n(x)\,dx\]</div>
<p>Nú viljum við meta skekkjuheildið.</p>
</section>
<section id="mealgildissetningin-fyrir-heildi">
<span id="index-10"></span><h3><span class="section-number">5.3.2. </span>Meðalgildissetningin fyrir heildi<a class="headerlink" href="#mealgildissetningin-fyrir-heildi" title="Permalink to this heading"></a></h3>
<p>Við skekkjumatið í þessum kafla munum við þurfa að nota eftirafarandi
setningu nokkrum sinnum.</p>
<p>Ef <span class="math notranslate nohighlight">\(G:[a,b] \to {{\mathbb  R}}\)</span> er samfellt fall og
<span class="math notranslate nohighlight">\({\varphi}\)</span> er heildanlegt fall sem skiptir ekki um formerki á
bilinu <span class="math notranslate nohighlight">\([a,b]\)</span> þá er til tala <span class="math notranslate nohighlight">\(\eta \in [a,b]\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[\int_a^b G(x){\varphi}(x)\, dx = G(\eta) \int_a^b {\varphi}(x)\, dx.\]</div>
</section>
<section id="id2">
<h3><span class="section-number">5.3.3. </span>Trapisureglan<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>Við getum hliðrar sérhverju bili <span class="math notranslate nohighlight">\([a,b]\)</span> yfir í <span class="math notranslate nohighlight">\([-\alpha,\alpha]\)</span>
þar sem <span class="math notranslate nohighlight">\(\alpha = (b-a)/2\)</span>, því er nóg fyrir okkur að skoða samhverf
bil af gerðinni <span class="math notranslate nohighlight">\([-\alpha,\alpha]\)</span>. Þetta er það sama og við gerðum
þegar <a class="reference external" href="https://notendur.hi.is/~bsm/stae405/kafli05.html#regla-simpsons">regla Simpsons</a>
var leidd út.</p>
<p>Samkvæmt <a class="reference external" href="https://notendur.hi.is/~bsm/stae405/kafli03.html#id9">3.7.7</a> þá er</p>
<div class="math notranslate nohighlight">
\[r_1(x) = f[-\alpha, \alpha, x](x+\alpha)(x-\alpha)\]</div>
<p>Athugum að</p>
<div class="math notranslate nohighlight">
\[(x+\alpha)(x-\alpha) = (x^2 - \alpha^2)\]</div>
<p>skiptir ekki um formerki á bilinu <span class="math notranslate nohighlight">\(]-\alpha, \alpha[\)</span>. Þá gefur
meðalgildissetningin fyrir heildi að til er <span class="math notranslate nohighlight">\(\eta \in [a,b]\)</span>
þannig að</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int_a^b r_1(x)\,dx
  &amp;= f[-\alpha, \alpha, \eta]
  \int_{-\alpha}^{\alpha}(x^2 - \alpha^2)\,dx\\
  &amp;= \frac{f''(\xi)}{2!} \left( - \frac{4}{3}\alpha^3 \right)\\
  &amp;= \frac{-f''(\xi)}{2!}\frac{(b-a)^3}{6}, \qquad \xi \in [a,b]\end{aligned}\end{split}\]</div>
<p>Niðurstaða:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,dx = (b-a)
  \left( \frac{1}{2} f(a) + \frac{1}{2}f(b) \right)
  - \frac{1}{12} f''(\xi)(b-a)^3\]</div>
</section>
<section id="id5">
<h3><span class="section-number">5.3.4. </span>Samsetta trapisureglan<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<p>Ef við lítum á samsettu trapisuregluna með jafna skiptingu þar sem
hlutbilin eru <span class="math notranslate nohighlight">\([x_i,
x_{i+1}]\)</span>, þá fáum við fyrir hvert hlutbil skekkjuna</p>
<div class="math notranslate nohighlight">
\[- \frac{h^3}{12}f''(\xi_i), \qquad \xi_i \in [x_i, x_{i+1}]\]</div>
<p>Ef við leggjum skekkjurnar saman og beitum milligildissetningunni á
<span class="math notranslate nohighlight">\(f''\)</span> þá fæst að til er <span class="math notranslate nohighlight">\(\xi \in [a,b]\)</span> þannig að
<span class="math notranslate nohighlight">\(f''(\xi) = \sum_{i=1}^n f''(\xi_i)/n\)</span>.
Þá fáum við a‘</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,dx = T(h) - \frac{h^2}{12}(b-a)f''(\xi), \qquad
  \xi \in [a,b]\]</div>
<p>að því gefnu að <span class="math notranslate nohighlight">\(f\in C^2 [a,b]\)</span>.</p>
<p>Athugið að hér er <span class="math notranslate nohighlight">\(T(h)\)</span> útkoman úr samsettu Trapisureglunni með jafna
skiptingu <span class="math notranslate nohighlight">\(h = \frac{b-a}n\)</span>.</p>
</section>
<section id="mipunktsregla">
<h3><span class="section-number">5.3.5. </span>Miðpunktsregla<a class="headerlink" href="#mipunktsregla" title="Permalink to this heading"></a></h3>
<p>Til einföldunar skoðum við áfram bilið <span class="math notranslate nohighlight">\([-\alpha,\alpha]\)</span>. Veljum
miðpunktinn sem tvöfaldan brúunarpunkt</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  &amp;p_1(x) = f(0) + f'(0)x\\
  &amp;r_1(x) = f[0,0,x]x^2\end{aligned}\end{split}\]</div>
<p>Athugum að heildið af <span class="math notranslate nohighlight">\(f'(0)x\)</span> yfir <span class="math notranslate nohighlight">\([-\alpha,\alpha]\)</span> er 0.
Nú skiptir <span class="math notranslate nohighlight">\(x^2\)</span> ekki um formerki og því gefur meðalgildisreglan
fyrir heildi að til er <span class="math notranslate nohighlight">\(\eta \in [-\alpha,\alpha]\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int_a^b r_1(x)\,dx
  &amp;= \int_{-\alpha}^{\alpha} f[0,0,x]x^2 \,dx\\
  &amp;= f[0,0,\eta]\int_{-\alpha}^\alpha x^2\,dx\\
  &amp;= \frac{f''(\xi)}{2!}2\frac{\alpha^3}{3}\\
  &amp;= \frac{(b-a)^3}{24}\cdot f''(\xi)\end{aligned}\end{split}\]</div>
<p>Þar sem <span class="math notranslate nohighlight">\(\xi\)</span> fæst úr <a class="reference external" href="https://notendur.hi.is/~bsm/stae405/kafli03.html#id9">skekkjumatinu fyrir brúunarmargliður</a>.</p>
</section>
<section id="id6">
<h3><span class="section-number">5.3.6. </span>Samsetta miðpunktsreglan<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<p>Fyrir hvert bil fáum við skekkjulið:</p>
<div class="math notranslate nohighlight">
\[\frac{h^3}{24}\cdot f''(\xi_i)\]</div>
<p>Leggjum saman skekkjuliðina og beitum milligildissetningunni, þá fæst að
til er <span class="math notranslate nohighlight">\(\xi\)</span> þannig að:</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,dx = h \sum_{i=1}^n
  f\left(a+ (i - \frac{1}{2})h\right) + \frac{b-a}{24}f''(\xi)h^2\]</div>
</section>
<section id="id7">
<h3><span class="section-number">5.3.7. </span>Regla Simpsons<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,dx \approx (b-a)
  \left(
    \frac{1}{6}f(a) + \frac{4}{6}f
    \left( \frac{1}{2}(a+b) \right) + \frac{1}{6}f(b)
  \right)\]</div>
<p>Leiddum út þessa formúlu með því að taka brúunarmargliðu <span class="math notranslate nohighlight">\(p_3(x)\)</span>
með punktana <span class="math notranslate nohighlight">\(-\alpha, \alpha, 0, 0\)</span>. Skekkjan er</p>
<div class="math notranslate nohighlight">
\[f(x) - p_3(x) = f[-\alpha, \alpha, 0, 0, x]
  (x+\alpha)(x-\alpha)x^2\]</div>
<p>þar með er skekkjan í formúlu Simpsons:</p>
<div class="math notranslate nohighlight">
\[\int_{-\alpha}^{\alpha}f[-\alpha, \alpha, 0, 0, x]
  (x+\alpha)(x-\alpha)x^2 \,dx\]</div>
<p>Fallið <span class="math notranslate nohighlight">\(x\mapsto (x+\alpha)(x-\alpha)x^2 = (x^2 - \alpha^2)x^2\)</span> er
<span class="math notranslate nohighlight">\(\leq 0\)</span> á <span class="math notranslate nohighlight">\([-\alpha, \alpha]\)</span>. Þar með gefur
meðalgildissetningin fyrir heildi að til er
<span class="math notranslate nohighlight">\(\eta \in [-\alpha, \alpha]\)</span> þannig að skekkjan er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
  f[-\alpha, \alpha, 0, 0, \eta]
  \int_{-\alpha}^{\alpha}(x^2 - \alpha^2)x^2 \,dx \\
  = \frac{f^{(4)}(\xi)}{4!}\cdot \frac{(-4)}{15}\cdot \alpha^5
  = \frac{-f^{(4)}(\xi)}{90}\left(\frac{b-a}{2}\right)^5, \qquad
  \xi \in [a,b]\end{gathered}\end{split}\]</div>
<p>Þar sem <span class="math notranslate nohighlight">\(\xi\)</span> fæst úr
<a class="reference external" href="https://notendur.hi.is/~bsm/stae405/kafli03.html#id9">skekkjumatinu fyrir brúunarmargliður</a>.</p>
</section>
<section id="id9">
<h3><span class="section-number">5.3.8. </span>Samsett regla Simpsons<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h3>
<p>Skiptum <span class="math notranslate nohighlight">\([a,b]\)</span> í <span class="math notranslate nohighlight">\(n\)</span> jafnlöng bil og látum <span class="math notranslate nohighlight">\(h\)</span> vera
helming hlutbillengdarinnar,</p>
<div class="math notranslate nohighlight">
\[h = \frac{(b-a)}{2n}.\]</div>
<p>Þá er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int\limits_a^b f(x) \, dx
  \approx &amp;
  \sum\limits_{k=1}^n
  \bigg(
    \frac{h}{3}
    \Big(
      f(x_{2k-2}) + 4f(x_{2k-1}) + f(x_{2k})
    \Big)
  \bigg) \\
  = &amp;
  \frac{h}{3}
  \Big(
    f(a) + 4f(a+h) + 2f(a+2h)+ 4f(a+3h) + 2f(a+4h) \\
    &amp;+ \cdots + 2f(a+(2n-2)h) + 4f(a+(2n-1)h) + f(b)
  \Big)\end{aligned}\end{split}\]</div>
<p>Ef við beitum skekkjumatinu á sérhvert bilanna þá fáum við</p>
<div class="math notranslate nohighlight">
\[\frac{-f^{(4)}(\xi_i)}{90}h^5\]</div>
<p>sem skekkju með <span class="math notranslate nohighlight">\(\xi_i \in [x_i, x_i+1]\)</span>. Heildarskekkjan verður</p>
<div class="math notranslate nohighlight">
\[-\sum_{i=1}^n \frac{f^{(4)}(\xi_i)}{90}h^5
  = \frac{-h^5}{90}\cdot \sum_{i=1}^n f^{(4)}(\xi_i)\]</div>
<p>Nú gefur meðalgildisreglan að til er <span class="math notranslate nohighlight">\(\xi \in [a,b]\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[f^{(4)}(\xi) = \frac{1}{n} \sum_{i=1}^n f^{(4)}(\xi_i)\]</div>
<p>Nú er <span class="math notranslate nohighlight">\(nh = \frac{(b-a)}{2}\)</span> þar með er skekkjan:</p>
<div class="math notranslate nohighlight">
\[\frac{-h^5}{90}\cdot nf^{(4)}(\xi)
  = \frac{-(b-a)}{180}f^{(4)}(\xi)\cdot h^4\]</div>
<p>Ef við táknum útkomuna úr samsettu Simpsonsreglunni fyrir
<span class="math notranslate nohighlight">\(h=\frac{b-a}{2n}\)</span> með <span class="math notranslate nohighlight">\(S(h)\)</span> þá fæst að til er
<span class="math notranslate nohighlight">\(\xi \in [a,b]\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x)\,dx = S(h) - \frac{(b-a)}{180}f^{(4)}(\xi)h^4\]</div>
</section>
</section>
<section id="romberg-utgiskun">
<h2><span class="section-number">5.4. </span>Romberg-útgiskun<a class="headerlink" href="#romberg-utgiskun" title="Permalink to this heading"></a></h2>
<p>Á sama hátt og við gátum bætt nálgun okkar á afleiðu falls með að nota
<a class="reference external" href="https://notendur.hi.is/~bsm/stae405/kafli04.html#richardson-utgiskun">Richardson útgiskun</a>
getum við bætt nálgun á heildi.</p>
<p>Aðferðin virkar í aðalatriðum eins fyrir heildi og afleiður, en til að
fá sem bestar upplýsingar um samleitni hennar skulum við leiða út
formúluna fyrir trapisureglunni aftur.</p>
<section id="euler-maclauren-formulan">
<h3><span class="section-number">5.4.1. </span>Euler-Maclauren-formúlan<a class="headerlink" href="#euler-maclauren-formulan" title="Permalink to this heading"></a></h3>
<p>Fyrir samfellt fall <span class="math notranslate nohighlight">\(f : [0,1] \to \mathbb R\)</span> sem er
<span class="math notranslate nohighlight">\(2n\)</span>-sinnum samfellt deildanlegt gildir Euler-Maclauren formúlan</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int\limits_0^1 f(t) \, dt
  =&amp;  \frac{1}{2}\left( f(0) + f(1) \right)
  + \sum\limits_{k=1}^{n-1} A_{2k}
  \left( f^{(2k-1)}(0) - f^{(2k-1)}(1)\right) \\
  &amp; - A_{2n}f^{(2n)}(\xi), \qquad \xi \in [0,1]\end{aligned}\end{split}\]</div>
<p>Hér eru stuðlarnir <span class="math notranslate nohighlight">\(A_k\)</span> þannig að <span class="math notranslate nohighlight">\(k!A_k\)</span> verði
Bernoulli-talan númer <span class="math notranslate nohighlight">\(k\)</span>. Þessar tölur eru stuðlar í veldaröðinni</p>
<div class="math notranslate nohighlight">
\[\frac{x}{e^x -1} = \sum\limits_{k=0}^{\infty}A_kx^k\]</div>
<div class="admonition note">
<p class="admonition-title">Athugasemd</p>
<p>Það þarf að hafa töluvert fyrir því að sanna þessa formúlu og því sleppum
við því hér.</p>
</div>
</section>
<section id="afleiing-af-euler-maclaurin-formulunni">
<h3><span class="section-number">5.4.2. </span>Afleiðing af Euler-Maclaurin-formúlunni<a class="headerlink" href="#afleiing-af-euler-maclaurin-formulunni" title="Permalink to this heading"></a></h3>
<p>Látum nú <span class="math notranslate nohighlight">\(f : [a,b] \to \mathbb R\)</span> vera <span class="math notranslate nohighlight">\(2n\)</span>-sinnum samfellt
deildanlegt fall. Ef við búum til skiptingu
<span class="math notranslate nohighlight">\(a= x_0 &lt; x_1 &lt; \cdots &lt;
x_n = b\)</span> með jöfn hlutbil <span class="math notranslate nohighlight">\(h = x_{i+1} - x_i\)</span> og beitum síðan
Euler-Maclauren formúlunni á <span class="math notranslate nohighlight">\(g(t) = f(x_i + ht)\)</span> fæst</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\int_{x_i}^{x_{i+1}} f(x)\,dx
= &amp; h\int_0^1 \underbrace{f(x_i + ht)}_{g(t)}\,dt \\
= &amp; h \left( \frac{1}{2}f(x_i) + \frac{1}{2}f(x_{i+1})\right) \\
&amp; +    \sum_{k=1}^{n-1}A_{2k}h^{2k}\left( f^{(2k-1)}(x_i) -
f^{(2k-1)}(x_{i+1}) \right) - A_{2n}h^{2n+1}f^{(2n)}(\xi_i), \end{aligned}\end{split}\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(\xi_i \in [x_i, x_{i+1}]\)</span>.</p>
<p>Nú innleiðum við</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
T(h)
&amp;:= \sum_{i=0}^{n-1}
h \left( \frac{1}{2} f(x_i) +
\frac{1}{2}f(x_{i+1}) \right)\\
&amp;= h\left( \frac{1}{2}f(a) + f(a+h)
+ \cdots + f(a+(n-1)h) + \frac{1}{2}f(a+nh)\right)\end{aligned}\end{split}\]</div>
<p>og fáum síðan:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int\limits_a^b f(x)\, dx
  = &amp; T(h) + \sum_{k=1}^{n-1}A_{2k}h^{2k}
  \left( f^{(2k-1)}(a) - f^{(2k-1)}(b) \right) \\
  &amp; - A_{2n}h^{2n+1} \sum_{i=0}^{n-1} f^{(2n)}(\xi_i)\end{aligned}\end{split}\]</div>
<p>Nú gefur milligildissetningin að til er <span class="math notranslate nohighlight">\(\xi \in [a,b]\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[\frac{1}{n} \sum\limits_{k=0}^{n-1} f^{(2n)}(\xi_i)
  = f^{(2n)}(\xi)\]</div>
<p>Notum okkur nú að <span class="math notranslate nohighlight">\(nh = b-a\)</span> og fáum að</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \int\limits_a^b f(x) \, dx
  = &amp; T(h) + \sum_{k=1}^{n-1}A_{2k}h^{2k}
  \left( f^{(2k-1)}(a) - f^{(2k-1)}(b) \right) \\
  &amp; - A_{2n} h^{2n}(b-a)f^{(2n)}(\xi).\end{aligned}\end{split}\]</div>
<p>Niðurstaðan er að samsetta trapisureglan er</p>
<div class="math notranslate nohighlight">
\[\int\limits_a^b f(x) \, dx
  = T(h) + c_2h^2 + c_4h^4 + \cdots + c_{2m-2}h^{2m-2}
  + c_{2n}h^{2m}f^{(2m)}(\xi)\]</div>
</section>
<section id="itrekun-a-samsettu-trapisureglunni-me-helmingun">
<h3><span class="section-number">5.4.3. </span>Ítrekun á samsettu trapisureglunni með helmingun<a class="headerlink" href="#itrekun-a-samsettu-trapisureglunni-me-helmingun" title="Permalink to this heading"></a></h3>
<p>Hugsum okkur nú að við viljum reikna út <span class="math notranslate nohighlight">\(T(h_j)\)</span> fyrir
<span class="math notranslate nohighlight">\(h_j =(b-a)/
2^j\)</span>, <span class="math notranslate nohighlight">\(j = 1,2,\ldots\)</span> og að við viljum nýta öll fallgildi í
<span class="math notranslate nohighlight">\(T(h_{j-1})\)</span> til að reikna út <span class="math notranslate nohighlight">\(T(h_j)\)</span>. Rakningarformúlan er</p>
<div class="math notranslate nohighlight">
\[T(h_j) = \frac{1}{2} T(h_{j-1}) + h_j \sum_{k=1}^{2^{j-1}} f(a+(2k-1)h_j)\]</div>
<p>Athugið að hér er bilinu <span class="math notranslate nohighlight">\([a,b]\)</span> skipt í <span class="math notranslate nohighlight">\(2^j\)</span> hlutbil.</p>
<div class="admonition warning">
<p class="admonition-title">Aðvörun</p>
<p>Þetta er gott að nota ef forrita á Romberg-heildun til þess að
spara útreikninga þegar fyrsti dálkurinn er reiknaður.
Það er hins vegar ekki nauðsynlegt að nota þetta og þetta tengist ekki
beint Romberg aðferðinni.</p>
</div>
</section>
<section id="reikniriti-fyrir-romberg-heildun">
<h3><span class="section-number">5.4.4. </span>Reikniritið fyrir Romberg-heildun<a class="headerlink" href="#reikniriti-fyrir-romberg-heildun" title="Permalink to this heading"></a></h3>
<p>Romberg-heildun er hugsuð nákvæmlega eins og Richardson-útgiskunin: Við
reiknum út línu fyrir línu í töflunni:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{cccccc}
    i\\
    1 &amp; R(1,1)\\
    2 &amp; R(2,1) &amp; R(2,2)\\
    3 &amp; R(3,1) &amp; R(3,2) &amp; R(3,3)\\
    4 &amp; R(4,1) &amp; R(4,2) &amp; R(4,3) &amp; R(4,4)\\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots
  \end{array}\end{split}\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  &amp;R(i,1) = T(h_i) \qquad i = 1,2,\ldots\\
  &amp;R(i,j) = \frac{4^{j-1} R(i,j-1) - R(i-1,j-1)}{4^{j-1} - 1}.\end{aligned}\end{split}\]</div>
<p>Með þessu fæst
<span class="math notranslate nohighlight">\(\int\limits_a^b f(x)\, dx = R(k,k) + O(h_k^{2k})\)</span>, þar sem
<span class="math notranslate nohighlight">\(k\)</span> er síðasta línan sem við reiknum í töflunni að ofan.</p>
</section>
<section id="skekkjumat-i-romberg-heildun">
<h3><span class="section-number">5.4.5. </span>Skekkjumat í Romberg heildun<a class="headerlink" href="#skekkjumat-i-romberg-heildun" title="Permalink to this heading"></a></h3>
<p>Skekkjumatið er hægt að finna með nákvæmlega sama hætti í fyrir
Richardson útgiskuna. Þ.e. við getum notað síðustu viðbót sem eftirámat
fyrir skekkjuna, þetta mat er</p>
<div class="math notranslate nohighlight">
\[e \approx \frac{1}{4^{j-1}-1}\left( R(i,j-1) - R(i-1,j-1)\right)\]</div>
<p>þegar þessi stærð er komin niður fyrir fyrirfram gefin skekkjumörk er
hætt.</p>
<p>Einnig er hægt að nota</p>
<div class="math notranslate nohighlight">
\[e \approx \frac{1}{2^{j-1}}\left( R(i,j-1) - R(i-1,j-1)\right),\]</div>
<p>sem gefur heldur varfærnislegra mat.</p>
<div class="admonition note">
<p class="admonition-title">Athugasemd</p>
<p>Athugið að það er ekki nauðsynlegt að hafa <span class="math notranslate nohighlight">\(h_1\)</span> sem allt bilið
<span class="math notranslate nohighlight">\([a,b]\)</span>, það er ekkert sem kemur í veg fyrir það að við byrjum
með <span class="math notranslate nohighlight">\(h_1 = \frac{b-a}{m}\)</span>, og helmingum svo;
<span class="math notranslate nohighlight">\(h_2 = \frac{b-a}{2m}\)</span>, <span class="math notranslate nohighlight">\(h_3 = \frac{b-a}{4m}\)</span>,
<span class="math notranslate nohighlight">\(\ldots\)</span>.
Þannig að almennt þá er <span class="math notranslate nohighlight">\(h_j=\frac{b-a}{2^{j-1}m}\)</span>.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../kafli04/" class="btn btn-neutral float-left" title="4. Töluleg diffrun" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../kafli06/" class="btn btn-neutral float-right" title="6. Upphafsgildisverkefni" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    /* Sidebar header (and topbar for mobile) */
    
    .wy-side-nav-search,
    .wy-nav-top {
        background: #10099F;
    }
    /* Sidebar */
    
    .wy-nav-side {
        background: #262626;
    }
</style>


</body>
</html>