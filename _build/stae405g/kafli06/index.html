<!DOCTYPE html>
<html class="writer-html5" lang="is" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6. Upphafsgildisverkefni &mdash; Töluleg greining (STÆ405G) </title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/eqt.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/datacamp-custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/edbook.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_2.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/js/eqt.js"></script>
        <script src="../_static/translations.js"></script>
        <script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
        <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script src="https://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

<script>
    // the buttonText string says what will be written on the 
    // sage cell evaluation button.
    // It can be changed here.
    var buttonText = "Keyra"
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sage",
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsage",
        languages: ["r"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osage",
        languages: ["octave"],
        evalButtonText: buttonText
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAuto",
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAuto",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAuto",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".sageAutoHidden",
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".rsageAutoHidden",
        languages: ["r"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>

<script>
    sagecell.makeSagecell({
        inputLocation: ".osageAutoHidden",
        languages: ["octave"],
        evalButtonText: buttonText,
        autoeval: true,
        hide: ["evalButton"],
        template: sagecell.templates.minimal
    });
</script>


<style type="text/css">
    .sagecell .CodeMirror-scroll {
        overflow-y: hidden;
        overflow-x: auto;
    }
    
    .sagecell .CodeMirror {
        height: auto;
    }
</style>


    <link rel="index" title="Atriðaskrá" href="../genindex/" />
    <link rel="search" title="Leit" href="../search/" />
    <link rel="next" title="7. Jaðargildisverkefni" href="../kafli07/" />
    <link rel="prev" title="5. Töluleg heildun" href="../kafli05/" />  
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Töluleg greining (STÆ405G)
              <img src="../_static/haskoli_islands-edbook.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../kafli01/">1. Inngangur</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli02/">2. Núllstöðvar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli03/">3. Brúun</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli04/">4. Töluleg diffrun</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli05/">5. Töluleg heildun</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Upphafsgildisverkefni</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#inngangur">6.1. Inngangur</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fyrsta-stigs-afleiujafna-me-upphafsgildi">6.1.1. Fyrsta stigs afleiðujafna með upphafsgildi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utskyring-og-daemi">6.1.2. Útskýring og dæmi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tilvist-og-otviraeni-lausna">6.1.3. Tilvist og ótvíræðni lausna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upphafsgildisverkefni-fyrir-hneppi">6.1.4. Upphafsgildisverkefni fyrir hneppi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jofnur-af-stigi-1-og-jafngild-hneppi">6.1.5. Jöfnur af stigi <span class="math notranslate nohighlight">\(&gt;1\)</span> og jafngild hneppi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tilvist-og-otviraeni-lausna-a-hneppum">6.1.6. Tilvist og ótvíræðni lausna á hneppum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rithattur">6.1.7. Ritháttur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#grunnhugmyndin-i-nalgunaraferum">6.1.8. Grunnhugmyndin í nálgunaraðferðum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beinar-og-obeinar-aferir">6.1.9. Beinar og óbeinar aðferðir</a></li>
<li class="toctree-l3"><a class="reference internal" href="#eins-skrefs-aferir-og-fjolskrefaaferir">6.1.10. Eins skrefs aðferðir og fjölskrefaaðferðir</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aferir-me-fasta-skrefastaer">6.2. Aðferðir með fasta skrefastærð</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#afer-eulers">6.2.1. Aðferð Eulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#afer-eulers-matlab-forrit">6.2.2. Aðferð Eulers: Matlab-forrit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#afer-eulers-daemi">6.2.3. Aðferð Eulers: Dæmi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#endurbaett-afer-eulers">6.2.4. Endurbætt aðferð Eulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#afer-heun">6.2.5. Aðferð Heun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forsagnar-og-leirettingarskref">6.2.6. Forsagnar- og leiðréttingarskref</a></li>
<li class="toctree-l3"><a class="reference internal" href="#annars-stigs-runge-kutta-afer">6.2.7. Annars stigs Runge-Kutta-aðferð</a></li>
<li class="toctree-l3"><a class="reference internal" href="#klassiska-fjora-stigs-runge-kutta-aferin">6.2.8. Klassíska (fjórða stigs) Runge-Kutta aðferðin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#klassiska-runge-kutta-aferin-daemi">6.2.9. Klassíska Runge-Kutta aðferðin: Dæmi</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#skekkjumat-samleitni-og-stougleiki">6.3. Skekkjumat, samleitni og stöðugleiki</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#skekkja">6.3.1. Skekkja</a></li>
<li class="toctree-l3"><a class="reference internal" href="#staarskekkja-i-afer-eulers">6.3.2. Staðarskekkja í aðferð Eulers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#styring-a-staarskekkju-og-breytileg-skrefastaer">6.3.3. Stýring á staðarskekkju og breytileg skrefastærð</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mat-a-skrefastaer">6.3.4. Mat á skrefastærð</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aferir-me-breytilega-skrefastaer">6.4. Aðferðir með breytilega skrefastærð</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reiknirit-fyrir-runge-kutta-fehlberg-rkf45">6.4.1. Reiknirit fyrir Runge-Kutta-Fehlberg (RKF45)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#runge-kutte-fehlberg-rkf45-profu">6.4.2. Runge-Kutte-Fehlberg (RKF45) prófuð</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fjolskrefaaferir">6.5. Fjölskrefaaðferðir</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#k-skrefa-adams-bashforth-afer">6.5.1. <span class="math notranslate nohighlight">\(k\)</span>-skrefa Adams-Bashforth aðferð</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tveggja-skrefa-adams-bashforth-afer">6.5.2. Tveggja skrefa Adams-Bashforth-aðferð</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forrit-fyrir-tveggja-skrefa-adams-bashforth-afer">6.5.3. Forrit fyrir tveggja skrefa Adams-Bashforth-aðferð</a></li>
<li class="toctree-l3"><a class="reference internal" href="#riggja-skrefa-adams-bashforth">6.5.4. Þriggja skrefa Adams-Bashforth</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fjogurra-skrefa-adams-bashforth">6.5.5. Fjögurra skrefa Adams-Bashforth</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#greining-a-samleitni-og-stougleika">6.6. Greining á samleitni og stöðugleika</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">6.6.1. Skekkja</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samleitni">6.6.2. Samleitni</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samraemi">6.6.3. Samræmi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samraemi-endurbaettu-euler-aferarinnar">6.6.4. Samræmi endurbættu Euler-aðferðarinnar</a></li>
<li class="toctree-l3"><a class="reference internal" href="#samraemi-beinna-eins-skrefs-afera">6.6.5. Samræmi beinna eins skrefs aðferða</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stougleiki">6.6.6. Stöðugleiki</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lipschitz-samfelldni">6.6.7. Lipschitz-samfelldni</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setning-um-stougleika-og-samleitni">6.6.8. Setning um stöðugleika og samleitni</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kafli07/">7. Jaðargildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli08/">8. Jöfnuhneppi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli09/">9. Eigingildisverkefni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli10/">10. Monte Carlo hermanir</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vidauki/">Viðauki</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Töluleg greining (STÆ405G)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">6. </span>Upphafsgildisverkefni</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/edbook/haskoli-islands/blob/master/projects/stae405g/kafli06.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="upphafsgildisverkefni"></span><section id="index-0">
<span id="id1"></span><h1><span class="section-number">6. </span>Upphafsgildisverkefni<a class="headerlink" href="#index-0" title="Permalink to this heading"></a></h1>
<p><em>In the beginning there was nothing, which exploded.</em>
– Terry Pretchett</p>
<section id="inngangur">
<h2><span class="section-number">6.1. </span>Inngangur<a class="headerlink" href="#inngangur" title="Permalink to this heading"></a></h2>
<section id="fyrsta-stigs-afleiujafna-me-upphafsgildi">
<span id="index-1"></span><h3><span class="section-number">6.1.1. </span>Fyrsta stigs afleiðujafna með upphafsgildi<a class="headerlink" href="#fyrsta-stigs-afleiujafna-me-upphafsgildi" title="Permalink to this heading"></a></h3>
<p>Gefið fall <span class="math notranslate nohighlight">\(f\)</span> á einhverju svæði <span class="math notranslate nohighlight">\(U\)</span> í
<span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> sem inniheldur <span class="math notranslate nohighlight">\((t_0,x_0)\)</span> þá er
<em>fyrsta stigs afleiðujafna með upphafsgildi</em> verkefni á forminu</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
x' = f(t,x),\\
x(t_0) = x_0.
\end{cases}\end{split}\]</div>
<p>Við segjum að fall <span class="math notranslate nohighlight">\(x(t)\)</span> sé lausn á þessu verkefni ef <span class="math notranslate nohighlight">\(x\)</span> er
skilgreint á bili <span class="math notranslate nohighlight">\(I\)</span>, sem er þannig að</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t_0 \in I\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\((t,x(t)) \in U\)</span> fyrir öll <span class="math notranslate nohighlight">\(t \in I\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(x'(t) = f(t,x(t))\)</span> fyrir öll <span class="math notranslate nohighlight">\(t \in I\)</span>, og</p></li>
<li><p><span class="math notranslate nohighlight">\(x(t_0) = x_0\)</span>.</p></li>
</ul>
</section>
<section id="utskyring-og-daemi">
<h3><span class="section-number">6.1.2. </span>Útskýring og dæmi<a class="headerlink" href="#utskyring-og-daemi" title="Permalink to this heading"></a></h3>
<p>Ástæðan fyrir því að við notum <span class="math notranslate nohighlight">\(t\)</span> fyrir breytuna og <span class="math notranslate nohighlight">\(x\)</span> fyrir fall
hér, er að breytan <span class="math notranslate nohighlight">\(t\)</span> lýsir oft tíma og lausnin getur þá t.d. verið staðsetning
sem fall af tíma.</p>
<p>Eðlilegt er að hugsa um afleiðujöfnuna þannig að fallið <span class="math notranslate nohighlight">\(f\)</span> geymi upplýsingar
um þau lögmál sem kerfið að hagar sér eftir, upphafsskilyrðið <span class="math notranslate nohighlight">\(x(t_0)=x_0\)</span>
segir í hvaða stöðu kerfið er þegar það er sett af stað og
lausnin <span class="math notranslate nohighlight">\(x(t)\)</span> lýsir hegðun kerfisins með tíma.</p>
<p>Í upphafi námskeiðsins,
<a class="reference external" href="https://notendur.hi.is/~bsm/stae405/kafli01.html#daemi-eldflaug">dæmi 1.2</a>, skoðuðum
við dæmi um eldflaug sem skotið er á loft. Þar er notum við reyndar <span class="math notranslate nohighlight">\(v\)</span> í stað
<span class="math notranslate nohighlight">\(x\)</span> því jafnan lýsir hraða (e. velocity) en ekki staðsetningu.
Jafnan var</p>
<div class="math notranslate nohighlight">
\[v' = \frac{5000-(300-10t)g-0,1v^2+10v}{300-10t},   \qquad v(0)=0.\]</div>
<p>Hér er því <span class="math notranslate nohighlight">\(f(t,v) = \frac{5000-(300-10t)g-0,1v^2+10v}{300-10t}\)</span>, <span class="math notranslate nohighlight">\(t_0=0\)</span>
og <span class="math notranslate nohighlight">\(x_0 = 0\)</span>.</p>
</section>
<section id="tilvist-og-otviraeni-lausna">
<span id="index-2"></span><h3><span class="section-number">6.1.3. </span>Tilvist og ótvíræðni lausna<a class="headerlink" href="#tilvist-og-otviraeni-lausna" title="Permalink to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
x' = f(t,x)\\
x(t_0) = x_0
\end{cases}\end{split}\]</div>
<p>Ef <span class="math notranslate nohighlight">\(f\)</span> er samfellt, þá er alltaf til lausn á einhverju bili
<span class="math notranslate nohighlight">\(I\)</span>. (<a class="reference external" href="https://en.wikipedia.org/wiki/Peano_existence_theorem">Setning Peano</a>)</p>
<p>Ef <span class="math notranslate nohighlight">\(f\)</span> uppfyllir Lipschitz-skilyrði með tilliti til <span class="math notranslate nohighlight">\(x\)</span>,
þ.e.a.s. til er fasti <span class="math notranslate nohighlight">\(C\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[|f(t,x_1) - f(t,x_2)| \leq C|x_1 - x_2|\]</div>
<p>fyrir öll <span class="math notranslate nohighlight">\((t,x_1)\)</span> og <span class="math notranslate nohighlight">\((t,x_2)\)</span> í grennd um
<span class="math notranslate nohighlight">\((t_0, x_0)\)</span> þá er lausnin ótvírætt ákvörðuð. (<a class="reference external" href="https://en.wikipedia.org/wiki/Picard%E2%80%93Lindel%C3%B6f_theorem">Setning Picard</a>)</p>
</section>
<section id="upphafsgildisverkefni-fyrir-hneppi">
<h3><span class="section-number">6.1.4. </span>Upphafsgildisverkefni fyrir hneppi<a class="headerlink" href="#upphafsgildisverkefni-fyrir-hneppi" title="Permalink to this heading"></a></h3>
<p>Með því að nota vigra og vigurgild föll má útfæra upphafsgildisverkefni fyrir hneppi:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
{\mbox{${\bf x}$}}' ={\mbox{${\bf f}$}}(t,{\mbox{${\bf x}$}})\\
{\mbox{${\bf x}$}}(t_0) = {\mbox{${\bf x}$}}_0
\end{cases}\end{split}\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[{\mbox{${\bf f}$}}: U \rightarrow {{\mathbb  R}}^n, \qquad U\subset \mathbb{R}^{n+1}, \quad
(t_0,{\mbox{${\bf x}$}}_0) \in U.\]</div>
<p>Athugið að við skrifum <span class="math notranslate nohighlight">\({\mbox{${\bf x}$}}(t)\)</span> og
<span class="math notranslate nohighlight">\({\mbox{${\bf f}$}}(t,{\mbox{${\bf x}$}})\)</span> sem dálkvigra,</p>
<div class="math notranslate nohighlight">
\[{\mbox{${\bf x}$}}(t) = [x_1(t), x_2(t), \ldots , x_n(t)]^T
\quad \text{  og } \quad
{\mbox{${\bf f}$}}(t,{\mbox{${\bf x}$}}) = [f_1(t,{\mbox{${\bf x}$}}), \ldots , f_n(t, {\mbox{${\bf x}$}})]^T\]</div>
</section>
<section id="jofnur-af-stigi-1-og-jafngild-hneppi">
<span id="index-3"></span><h3><span class="section-number">6.1.5. </span>Jöfnur af stigi <span class="math notranslate nohighlight">\(&gt;1\)</span> og jafngild hneppi<a class="headerlink" href="#jofnur-af-stigi-1-og-jafngild-hneppi" title="Permalink to this heading"></a></h3>
<p>Aðferðirnar sem við munum skoða eru eingöngu fyrir fyrsta stigs afleiðujöfnur,
sem þýðir að jöfnurnar sem við leysum
innihalda bara <span class="math notranslate nohighlight">\(x'\)</span> en ekki <span class="math notranslate nohighlight">\(x'',x''',\ldots\)</span>.
Hins vegar þá getum við leyst afleiðujöfnur af hærra stigi með því að umrita þær yfir í jafngilt
fyrsta stigs hneppi.</p>
<p>Ef við höfum
<span class="math notranslate nohighlight">\(m\)</span>-stigs diffurjöfnu</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
u^{(m)} &amp;= g(t,u, u',u'',\ldots , u^{(m-1)})\\
u(t_0) &amp;= u_0, \quad u'(t_0) = u_1, \quad \ldots, \quad  u^{m-1}(t_0) = u_{(m-1)}\end{aligned}\end{split}\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(g\)</span> er gefið fall og <span class="math notranslate nohighlight">\(t_, u_0, \ldots , u_{m-1}\)</span> eru
gefnar tölur þá er jafngilt hneppi er fengið með því að setja</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
x_1 =&amp; u, \\
x_2 =&amp; u', \\
x_3 =&amp; u'', \\
\vdots&amp; \\
x_m =&amp; u^{(m-1)}\end{aligned}.\end{split}\]</div>
<p>Þá fæst hneppið</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\bf x}' =
\begin{pmatrix}
x_1' &amp;= x_2 \\
x_2' &amp;= x_3 \\
\vdots &amp; \vdots\\
x_{m-1}' &amp;= x_m \\
x_m' &amp;= g(t,x_1, \ldots , x_m)
\end{pmatrix} =
{\bf f}(t,{\bf x})\end{split}\]</div>
<p>með upphafsskilyrðið <span class="math notranslate nohighlight">\({\bf x}(t_0)^T = [u_0,u_1,u_2,\ldots,u_m]^T\)</span>.</p>
<p>Fyrsta hnitið í lausn hneppisins, <span class="math notranslate nohighlight">\(x_1\)</span>, gefur þá lausn, <span class="math notranslate nohighlight">\(u\)</span>
á upprunalegu <span class="math notranslate nohighlight">\(m\)</span>-ta stigs afleiðujöfnunni.</p>
</section>
<section id="tilvist-og-otviraeni-lausna-a-hneppum">
<h3><span class="section-number">6.1.6. </span>Tilvist og ótvíræðni lausna á hneppum<a class="headerlink" href="#tilvist-og-otviraeni-lausna-a-hneppum" title="Permalink to this heading"></a></h3>
<p>Tilvistar- og ótvíræðnisetningar Peanos og Picards eru þær sömu fyrir
hneppi</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
{\mbox{${\bf x}$}}' ={\mbox{${\bf f}$}}(t,{\mbox{${\bf x}$}})\\
{\mbox{${\bf x}$}}(t_0) = {\mbox{${\bf x}$}}_0
\end{cases}\end{split}\]</div>
<p>Við þurfum bara að setja norm <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> í stað tölugildis
<span class="math notranslate nohighlight">\(|\cdot|\)</span> í öllum ójöfnum og þar með talið í Lipschitz-skilyrðinu.</p>
</section>
<section id="rithattur">
<span id="index-4"></span><h3><span class="section-number">6.1.7. </span>Ritháttur<a class="headerlink" href="#rithattur" title="Permalink to this heading"></a></h3>
<p>Til einföldunar á rithætti skulum við skrifa lausnarvigurinn
<span class="math notranslate nohighlight">\({\mbox{${\bf x}$}}\)</span> og vörpunina <span class="math notranslate nohighlight">\({\mbox{${\bf f}$}}\)</span> sem
<span class="math notranslate nohighlight">\(x\)</span> og <span class="math notranslate nohighlight">\(f\)</span> og láta eins og við séum að leysa fyrsta stigs
afleiðujöfnu.</p>
<p>Við veljum gildi <span class="math notranslate nohighlight">\(t_0 &lt; t_1 &lt; \cdots &lt; t_j&lt;\cdots\)</span> og reiknum út
<em>nálgunargildi</em> <span class="math notranslate nohighlight">\(w_j\)</span> á gildi lausnarinnar <span class="math notranslate nohighlight">\(x(t_j)\)</span> í
punktinum <span class="math notranslate nohighlight">\(t_j\)</span>. Gildið <span class="math notranslate nohighlight">\(w_0=x(t_0)\)</span> er rétta upphafsgildi
lausnarinnar</p>
<p>Talan <span class="math notranslate nohighlight">\(t_j\)</span> kallast <span class="math notranslate nohighlight">\(j\)</span>-ti <em>tímapunkturinn</em> og talan
<span class="math notranslate nohighlight">\(h_j=t_j-t_{j-1}\)</span> nefnist <span class="math notranslate nohighlight">\(j\)</span>-ta <em>tímaskrefið</em>.</p>
<p><em>Skekkjan</em> á tíma <span class="math notranslate nohighlight">\(t_j\)</span> er þá <span class="math notranslate nohighlight">\(e_j = x(t_j)-w_j\)</span>.</p>
</section>
<section id="grunnhugmyndin-i-nalgunaraferum">
<h3><span class="section-number">6.1.8. </span>Grunnhugmyndin í nálgunaraðferðum<a class="headerlink" href="#grunnhugmyndin-i-nalgunaraferum" title="Permalink to this heading"></a></h3>
<p>Ef við heildum lausn afleiðujöfnunnar yfir tímabilið <span class="math notranslate nohighlight">\([t,t+h]\)</span>, þá
fáum við að hún uppfyllir jöfnuna</p>
<div class="math notranslate nohighlight">
\[x(t+h)=x(t)+\int_t^{t+h}f(\tau,x(\tau))\, d\tau
=x(t)+h\int_0^1f(t+sh,x(t+sh))\, ds.\]</div>
<p>Ef við setjum <span class="math notranslate nohighlight">\(t=t_{j-1}\)</span> inn í þessa jöfnu, þá fáum við</p>
<div class="math notranslate nohighlight">
\[\dfrac{x(t_j)-x(t_{j-1})}{h_j}=\int_0^1f(t_{j-1}+sh_j,x(t_{j-1}+sh_j))\, ds\]</div>
<p>Nálgunaraðferðirnar snúast allar um að gera einhvers konar nálgun á
heildinu í hægri hliðinni</p>
<div class="math notranslate nohighlight">
\[\int_0^1f(t_{j-1}+sh_j,x(t_{j-1}+sh_j))\, ds
  \approx \varphi(f,t_0,\dots,t_j,w_0,\dots,w_j)\]</div>
<p>og leysa síðan <span class="math notranslate nohighlight">\(w_j\)</span> út úr jöfnunni</p>
<div class="math notranslate nohighlight">
\[\dfrac{w_j-w_{j-1}}{h_j}=\varphi(f,t_0,\dots,t_j,w_0,\dots,w_j)\]</div>
</section>
<section id="beinar-og-obeinar-aferir">
<span id="index-5"></span><h3><span class="section-number">6.1.9. </span>Beinar og óbeinar aðferðir<a class="headerlink" href="#beinar-og-obeinar-aferir" title="Permalink to this heading"></a></h3>
<p>Nálgunaraðferð sem byggir á jöfnunni</p>
<div class="math notranslate nohighlight">
\[\dfrac{w_j-w_{j-1}}{h_j}=\varphi(f,t_{0},\dots,t_j,w_{0},\dots,w_j)\]</div>
<p>er nefnist <em>bein aðferð</em> (e. explicit method) ef <span class="math notranslate nohighlight">\(w_j\)</span> kemur ekki
fyrir í í hægri hliðinni.</p>
<p>Annars nefnist hún <em>óbein aðferð</em> eða <em>fólgin aðferð</em> (e. implicit
method).</p>
<p>Ef aðferðin er bein og við höfum reiknað út <span class="math notranslate nohighlight">\(w_0,\dots,w_{j-1}\)</span>,
þá fáum við rakningarformúlu, þannig að <span class="math notranslate nohighlight">\(w_j\approx x(t_j)\)</span> er
reiknað út</p>
<div class="math notranslate nohighlight">
\[w_j=w_{j-1}+h_j\varphi(f,t_{0},\dots,t_j,w_{0},\dots,w_{j-1})\]</div>
</section>
<section id="eins-skrefs-aferir-og-fjolskrefaaferir">
<span id="index-6"></span><h3><span class="section-number">6.1.10. </span>Eins skrefs aðferðir og fjölskrefaaðferðir<a class="headerlink" href="#eins-skrefs-aferir-og-fjolskrefaaferir" title="Permalink to this heading"></a></h3>
<p>Nálgunaraðferð sem byggir á jöfnunni</p>
<div class="math notranslate nohighlight">
\[\dfrac{w_j-w_{j-1}}{h_j}=\varphi(f,t_{j-1},t_j,w_{j-1},w_j)\]</div>
<p>er nefnist <em>eins skrefs aðferð</em> (e. one step method) og er þá vísað til
þess að fallið í hægri hliðinni er einungis háð gildum á síðasta
tímaskrefinu.</p>
<p>er af gerðinni</p>
<div class="math notranslate nohighlight">
\[\dfrac{w_j-w_{j-1}}{h_j}=\varphi(f,t_{j-2},t_{j-1},t_j,w_{j-2},w_{j-1},w_j)\]</div>
<p>Almennt er <span class="math notranslate nohighlight">\(k\)</span> <em>-skrefa aðferð</em> af gerðinni</p>
<div class="math notranslate nohighlight">
\[\dfrac{w_j-w_{j-1}}{h_j}=\varphi(f,t_{j-k},\dots,t_j,w_{j-k},\dots,w_j)\]</div>
<p><em>Fjölskrefaðferð</em> er <span class="math notranslate nohighlight">\(k\)</span>-skrefa aðferð með <span class="math notranslate nohighlight">\(k\geq 2\)</span>.</p>
</section>
</section>
<section id="aferir-me-fasta-skrefastaer">
<h2><span class="section-number">6.2. </span>Aðferðir með fasta skrefastærð<a class="headerlink" href="#aferir-me-fasta-skrefastaer" title="Permalink to this heading"></a></h2>
<section id="afer-eulers">
<span id="index-7"></span><h3><span class="section-number">6.2.1. </span>Aðferð Eulers<a class="headerlink" href="#afer-eulers" title="Permalink to this heading"></a></h3>
<p>Rifjum upp að lausnin uppfyllir</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  x(t+h) - x(t) &amp;= \int\limits_t^{t+h} x'(\tau) \, d\tau
  = \int\limits_t^{t+h} f(\tau,x(\tau)) \, d\tau\\
&amp;= h\int\limits_0^{1} f(t+sh,x(t+sh)) \, ds\end{aligned}\end{split}\]</div>
<p>Billengdin í síðasta heildinu er <span class="math notranslate nohighlight">\(1\)</span>, svo við tökum einföldustu
nálgum sem hugsast getur en það er gildið í vinstri endapunkti
<span class="math notranslate nohighlight">\(f(t,x(t))\)</span>. Fyrir lítil <span class="math notranslate nohighlight">\(h\)</span> fæst því</p>
<div class="math notranslate nohighlight">
\[x(t+h) \approx x(t) + hf(t,x(t)).\]</div>
<p>Við þekkjum <span class="math notranslate nohighlight">\(w_0=x(t_0)\)</span>, svo með þessu getum við fikrað okkur
áfram og fengið runu nálgunargilda <span class="math notranslate nohighlight">\(w_0, w_1, w_2, \ldots\)</span> þannig
að</p>
<div class="math notranslate nohighlight">
\[w_j = w_{j-1} + h_{j} f(t_{j-1},w_{j-1}).\]</div>
</section>
<section id="afer-eulers-matlab-forrit">
<h3><span class="section-number">6.2.2. </span>Aðferð Eulers: Matlab-forrit<a class="headerlink" href="#afer-eulers-matlab-forrit" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">w</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">alpha</span><span class="p">);</span>
<span class="o">%</span>   <span class="n">function</span> <span class="n">w</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">alpha</span><span class="p">)</span>
<span class="o">%</span> <span class="n">Aðferð</span> <span class="n">Eulers</span> <span class="n">fyrir</span> <span class="n">afleiðujöfnuhneppi</span>
<span class="o">%</span>         <span class="n">x</span><span class="s1">&#39;(t)=f(t,x(t)), x(0)=alpha.</span>
<span class="o">%</span> <span class="n">Inn</span> <span class="n">fara</span><span class="p">:</span> <span class="n">f</span> <span class="o">-</span> <span class="n">fallið</span> <span class="n">f</span>
<span class="o">%</span>           <span class="n">t</span> <span class="o">-</span> <span class="n">vigur</span> <span class="n">með</span> <span class="n">skiptingu</span> <span class="n">á</span> <span class="n">t</span><span class="o">-</span><span class="n">ás</span><span class="o">.</span>
<span class="o">%</span>           <span class="n">alpha</span> <span class="o">-</span> <span class="n">upphafsgildið</span> <span class="n">í</span> <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span>
<span class="o">%</span> <span class="n">Út</span> <span class="n">koma</span><span class="p">:</span>  <span class="n">w</span> <span class="o">-</span> <span class="n">fylki</span> <span class="n">með</span> <span class="n">nálgunargildunum</span><span class="o">.</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">alpha</span><span class="p">);</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="n">w</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">;</span>
<span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span>
   <span class="n">w</span><span class="p">(:,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">w</span><span class="p">(:,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="n">t</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">w</span><span class="p">(:,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
<span class="n">end</span>
</pre></div>
</div>
</section>
<section id="afer-eulers-daemi">
<h3><span class="section-number">6.2.3. </span>Aðferð Eulers: Dæmi<a class="headerlink" href="#afer-eulers-daemi" title="Permalink to this heading"></a></h3>
<p>Prófum aðferð Eulers á afleiðujöfnunni</p>
<div class="math notranslate nohighlight">
\[x' = \frac tx, \qquad x(0) = 1\]</div>
<p>Við sjáum að rétt lausn er <span class="math notranslate nohighlight">\(x(t) = \sqrt{t^2+ 1}\)</span>.</p>
<p>Notum 101 jafndreifð tímagildi á bilinu [0,5]. Þá er skekkjan</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="n">t</span><span class="o">./</span><span class="n">x</span><span class="p">;</span>
<span class="o">&gt;&gt;</span> <span class="n">t</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">101</span><span class="p">);</span>
<span class="o">&gt;&gt;</span> <span class="n">w</span><span class="o">=</span><span class="n">euler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="o">&gt;&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="o">.^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
<span class="o">&gt;&gt;</span> <span class="n">title</span><span class="p">(</span><span class="s1">&#39;Skekkja í aðferð Eulers&#39;</span><span class="p">);</span> <span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x-w&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/7euler.png" src="../_images/7euler.png" />
</section>
<section id="endurbaett-afer-eulers">
<span id="index-8"></span><h3><span class="section-number">6.2.4. </span>Endurbætt aðferð Eulers<a class="headerlink" href="#endurbaett-afer-eulers" title="Permalink to this heading"></a></h3>
<p>Í aðferð Eulers nálguðum við heildið
<span class="math notranslate nohighlight">\(\int_0^1 f(t+sh,x(t+sh))\, ds\)</span> með margfeldi af billengdinni og
fallgildinu í vinstri endapunkti.</p>
<p>Við getum endurbætt þessa nálgun með því að taka einhverja nákvæmari
tölulega nálgun á heildinu til dæmis miðpunktsaðferð</p>
<p>Nálgunarformúlan verður þá</p>
<div class="math notranslate nohighlight">
\[\int_0^1f(t+sh,x(t+sh))\, ds \approx f(t+\tfrac 12h,x(t+\tfrac 12 h)).\]</div>
<p>Nú er vandamálið að við höfum nálgað <span class="math notranslate nohighlight">\(x(t_{j-1})\)</span> með
<span class="math notranslate nohighlight">\(w_{j-1}\)</span> en höfum ekkert nálgunargildi á
<span class="math notranslate nohighlight">\(x(t_{j-1}+\frac 12 h_j)\)</span>.</p>
<p>Við grípum þá til fyrsta stigs Taylor nálgunar</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
x(t_j+\tfrac 12 h_j)&amp;=x(t_{j-1})+x'(t_{j-1})\big(\tfrac 12 h_j \big)
+\tfrac 12x''(\xi)\big(\tfrac 12 h_j \big)^2\\
&amp;\approx w_{j-1}+\tfrac 12 h_jf(t_{j-1},w_{j-1}).\end{aligned}\end{split}\]</div>
<p>Endurbætt aðferð Eulers er þá í tveim skrefum; við reiknum</p>
<div class="math notranslate nohighlight">
\[\tilde w_j = w_{j-1} + \tfrac 12 h_j f(t_{j-1},w_{j-1})\]</div>
<p>og fáum svo nálgunargildið</p>
<div class="math notranslate nohighlight">
\[w_j = w_{j-1} + h_jf\left(
    t_{j-1}+\tfrac 12 h_j,\tilde w_j\right)\]</div>
</section>
<section id="afer-heun">
<span id="index-9"></span><h3><span class="section-number">6.2.5. </span>Aðferð Heun<a class="headerlink" href="#afer-heun" title="Permalink to this heading"></a></h3>
<p>Lítum nú á aðra aðferð þar sem við nálgum heildið með trapisuaðferð.</p>
<div class="math notranslate nohighlight">
\[\int_0^1f(t+sh,x(t+sh))\, ds \approx
\tfrac 12 \big(f(t,x(t))+f(t+h,x(t+h))\big).\]</div>
<p>Af þessu leiðir að nálgunarformúlan á að vera</p>
<div class="math notranslate nohighlight">
\[w_j=w_{j-1}+\tfrac 12h_j\big(f(t_{j-1},w_{j-1})+f(t_j,w_j)\big)\]</div>
<p>Þetta er greinilega óbein aðferð svo við verðum að byrja á nálgun á
<span class="math notranslate nohighlight">\(w_j\)</span>, með</p>
<div class="math notranslate nohighlight">
\[w_j\approx x(t_j)=x(t_{j-1}+h_j)\approx x(t_{j-1})+h_jx'(t_{j-1})
=x(t_{j-1})+h_jf(t_{j-1},w_{j-1})\]</div>
<p>Þetta nýja afbrigði af aðferð Eulers nefnist <em>aðferð Heun</em>. Hún er í
tveim skrefum: Við reiknum fyrst</p>
<div class="math notranslate nohighlight">
\[\tilde w_j = w_{j-1} + h_jf(t_{j-1},w_{j-1})\]</div>
<p>og fáum svo nálgunargildið</p>
<div class="math notranslate nohighlight">
\[w_j = w_{j-1} + \tfrac 12h_j
\big(f(t_{j-1},w_{j-1})+f(t_j,\tilde w_j)\big)\]</div>
</section>
<section id="forsagnar-og-leirettingarskref">
<span id="index-10"></span><h3><span class="section-number">6.2.6. </span>Forsagnar- og leiðréttingarskref<a class="headerlink" href="#forsagnar-og-leirettingarskref" title="Permalink to this heading"></a></h3>
<p>Endurbætt aðferð Eulers og aðferð Heun eru leiðir til þess að vinna úr
óbeinum aðferðum, þar sem rakningarformúlan fyrir nálgunargildin er af
gerðinni</p>
<div class="math notranslate nohighlight">
\[w_j=w_{j-1}+h_j\varphi(f,t_{j-1},t_j,w_{j-1},w_j)\]</div>
<p>og okkur vantar eitthverja nálgun á <span class="math notranslate nohighlight">\(w_j\)</span> til þess að stinga inn í
hægri hlið þessarar jöfnu. Við skiptum þessu tvö skref:</p>
<p>Við beitum einhverri beinni aðferð til þess að reikna út</p>
<div class="math notranslate nohighlight">
\[\tilde w_j=w_{j-1}+h_j\psi(f,t_{j-1},t_j,w_{j-1})\]</div>
<p>Setjum</p>
<div class="math notranslate nohighlight">
\[w_j=w_{j-1}+h_j\varphi(f,t_{j-1},t_j,w_{j-1},\tilde w_j).\]</div>
<p>Svona aðferðir kallast <em>Runge-Kutta aðferðir</em>. Fyrra skrefið, þegar
<span class="math notranslate nohighlight">\(\tilde w_j\)</span> er reiknað út kallast <em>forsagnarskref</em> og
seinna skrefið kallast <em>leiðréttingarskref</em>.</p>
</section>
<section id="annars-stigs-runge-kutta-afer">
<span id="index-11"></span><h3><span class="section-number">6.2.7. </span>Annars stigs Runge-Kutta-aðferð<a class="headerlink" href="#annars-stigs-runge-kutta-afer" title="Permalink to this heading"></a></h3>
<p>Lítum aftur á verkefnið</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
    \begin{array}{l}
      x'(t) = f(t,x(t)) \\
      x(t_0) = x_0
    \end{array}
  \right.\end{split}\]</div>
<p>og skoðum 2. stigs Taylor liðun á lausninni <span class="math notranslate nohighlight">\(x\)</span> í punkti
<span class="math notranslate nohighlight">\(t\)</span>. Innleiðum fyrst smá rithátt til styttingar, setjum</p>
<div class="math notranslate nohighlight">
\[x = x(t), \quad f'_t = \frac{\partial f}{\partial t}(t,x(t)), \quad
  f = f(t,x(t)), \quad f'_x = \frac{\partial f}{\partial x}(t,x(t)).\]</div>
<p>Keðjureglan gefur</p>
<div class="math notranslate nohighlight">
\[x''(t)=\dfrac d{dt}f(t,x(t))=f'_t+f'_xx'(t)=f'_t+f\,f'_x.\]</div>
<p>Taylor-liðun lausnarinnar er</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  x(t+h) &amp;= x + hx'(t) + \frac{1}{2} h^2 x''(t) + O(h^3) \\
  &amp;= x + hf + \frac{1}{2} h^2 ( f'_t + f f'_x ) + O(h^3) \\
  &amp;= x + \frac{1}{2}hf + \frac{1}{2}h( f + hf'_t + (hf)f'_x) + O(h^3)\end{aligned}\end{split}\]</div>
<p>Nú sjáum við að síðasti liðurinn er 1. stigs Taylor liðun <span class="math notranslate nohighlight">\(f\)</span> með
miðju <span class="math notranslate nohighlight">\((t,x)\)</span> skoðuð í punktinum <span class="math notranslate nohighlight">\((t+h,x+hf)\)</span>, því</p>
<div class="math notranslate nohighlight">
\[f(t+h,x + hf) = f + hf'_t + (hf) f'_x + O(h^2)\]</div>
<p>og þar með er</p>
<div class="math notranslate nohighlight">
\[x(t+h) = x(t) + \frac{1}{2} hf(t,x) + \frac{1}{2} hf(t+h,x+hf) + O(h^3).\]</div>
<p>Þessi formúla liggur til grundvallar 2. stigs Runge-Kutta-aðferð: Með
henni fáum við nálgunarrunu <span class="math notranslate nohighlight">\(w_0, w_1, w_2, \ldots\)</span> þannig að
<span class="math notranslate nohighlight">\(w_0=x(0)\)</span> og</p>
<div class="math notranslate nohighlight">
\[w_j = w_{j-1} + \tfrac{1}{2}(F_1 + F_2), \quad j = 1,2,\ldots\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[F_1 = h_jf(t_{j-1},w_{j-1}),
  \quad \text{og} \quad
  F_2 = h_jf(t_j,w_{j-1}+F_1)\]</div>
<p>og eins og alltaf er <span class="math notranslate nohighlight">\(w_j \approx x(t_j)\)</span>.</p>
</section>
<section id="klassiska-fjora-stigs-runge-kutta-aferin">
<span id="index-12"></span><h3><span class="section-number">6.2.8. </span>Klassíska (fjórða stigs) Runge-Kutta aðferðin<a class="headerlink" href="#klassiska-fjora-stigs-runge-kutta-aferin" title="Permalink to this heading"></a></h3>
<p>Algengasta Runge-Kutta aðferðin er klassíska Runge-Kutta aðferðin. Þetta
er fjórða stigs aðferð, sem þýðir að staðarskekkjan er <span class="math notranslate nohighlight">\(O(h^5)\)</span> og
heildarskekkjan er <span class="math notranslate nohighlight">\(O(h^4)\)</span>, .</p>
<div class="math notranslate nohighlight">
\[w_{j} = w_{j-1} + \frac 16(k_1 + 2k_2 + 2k_3 + k_4),\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  k_1 &amp;= hf(t_{j-1},w_{j-1}) \\
  k_2 &amp;= hf\left(t_{j-1} + \frac h2,w_{j-1}+ \frac{k_1}2\right) \\
  k_3 &amp;= hf\left(t_{j-1} + \frac h2,w_{j-1}+ \frac{k_2}2\right) \\
  k_4 &amp;= hf(t_{j-1} + h,w_{j-1}+ k_3).
 \end{aligned}\end{split}\]</div>
<p>Ef <span class="math notranslate nohighlight">\(f(t,x)\)</span> er bara fall af <span class="math notranslate nohighlight">\(t\)</span>, þ.e. óháð <span class="math notranslate nohighlight">\(x\)</span>, þá
svarar þetta til þess að meta heildið <span class="math notranslate nohighlight">\({\varphi}\)</span> með
Simpson-reglunni.</p>
</section>
<section id="klassiska-runge-kutta-aferin-daemi">
<h3><span class="section-number">6.2.9. </span>Klassíska Runge-Kutta aðferðin: Dæmi<a class="headerlink" href="#klassiska-runge-kutta-aferin-daemi" title="Permalink to this heading"></a></h3>
<p>Skoðum nú sama dæmi og þegar við <a class="reference external" href="AðferðEulers:Dæmi">prófuðum aðferð Eulers</a>.</p>
<p>Þá gefa eftirfarandi skipanir mynd af skekkjunni.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="n">t</span><span class="o">./</span><span class="n">x</span><span class="p">;</span>
<span class="o">&gt;&gt;</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">rk4</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
<span class="o">&gt;&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="o">.^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/7rk4.png" src="../_images/7rk4.png" />
<p>Þetta er töluvert betra en aðferð Eulers sem skilaði skekkju af stærðargráðunni
<span class="math notranslate nohighlight">\(10^{-2}\)</span>.</p>
</section>
</section>
<section id="skekkjumat-samleitni-og-stougleiki">
<h2><span class="section-number">6.3. </span>Skekkjumat, samleitni og stöðugleiki<a class="headerlink" href="#skekkjumat-samleitni-og-stougleiki" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+++Mr. Jelly! Mr. Jelly!+++
+++Error At Address: 14, Treacle Mine Road, Ankh-Morpork+++
+++MELON MELON MELON+++
+++Divide By Cucumber Error. Please Reinstall Universe And Reboot +++
+++Whoops! Here Comes The Cheese! +++
+++Oneoneoneoneoneoneone+++
</pre></div>
</div>
<p>–villuskilaboð tölvunnar Hex í Interesting Times eftir Terry Pratchett</p>
<section id="skekkja">
<span id="index-13"></span><h3><span class="section-number">6.3.1. </span>Skekkja<a class="headerlink" href="#skekkja" title="Permalink to this heading"></a></h3>
<p>Fyrir eins skrefs aðferð skilgreinum við <em>staðarskekkju</em> við tímann
<span class="math notranslate nohighlight">\(t_n\)</span> sem</p>
<div class="math notranslate nohighlight">
\[\tau_n = \dfrac{x(t_n)-x(t_{n-1})}{h_n} -
\varphi(f,t_{n-1},t_n,x(t_{n-1}),x(t_{n}))\]</div>
<p>Hér er réttu lausninni stungið inn í nálgunarformúluna. Munum að hún
uppfyllir</p>
<div class="math notranslate nohighlight">
\[\dfrac{x(t_n)-x(t_{n-1})}{h_n}
=\int_0^1 f(t_{n-1}+sh_n,x(t_{n-1}+sh_n))\, ds\]</div>
<p>Viljum geta metið <span class="math notranslate nohighlight">\(\tau_n\)</span> sem fall af <span class="math notranslate nohighlight">\(h_n\)</span>, t.d.</p>
<div class="math notranslate nohighlight">
\[\tau_n = O(h_n^k)\]</div>
<p>Almennt batna aðferðir eftir því sem veldisvísirinn <span class="math notranslate nohighlight">\(k\)</span> í
staðarskekkjunni verður stærri.</p>
<p>Staðarskekkja er hlutfallsleg skekkja við að fara úr <span class="math notranslate nohighlight">\(w_{n-1}\)</span>
yfir í <span class="math notranslate nohighlight">\(w_n\)</span>. Einnig má skoða uppsafnaða skekkju frá
upphafstímanum <span class="math notranslate nohighlight">\(t_0\)</span>, hún er skilgreind með
<span class="math notranslate nohighlight">\(e_n = x(t_j)-w_j\)</span> og kallast <em>heildarskekkja</em>.</p>
</section>
<section id="staarskekkja-i-afer-eulers">
<h3><span class="section-number">6.3.2. </span>Staðarskekkja í aðferð Eulers<a class="headerlink" href="#staarskekkja-i-afer-eulers" title="Permalink to this heading"></a></h3>
<p>Aðferð Eulers er sett fram með formúlunni</p>
<div class="math notranslate nohighlight">
\[w_n=w_{n-1}+h_nf(t_{n-1},w_{n-1})\]</div>
<p>Staðarskekkjan er því</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \tau_n&amp;=\dfrac{x(t_n)-x(t_{n-1})}{h_n}-f(t_{n-1},x(t_{n-1}))\\
&amp;=\dfrac{x(t_n)-x(t_{n-1})-x'(t_{n-1})h_n}{h_n}\\
&amp;=\dfrac{\tfrac 12 x''(\xi_{n})h_{n-1}^2}{h_n}
=\tfrac 12 x''(\xi_{n})h_{n-1}=O(h_n)\end{aligned}\end{split}\]</div>
<p>Aðferð Eulers er því fyrsta stigs aðferð.</p>
</section>
<section id="styring-a-staarskekkju-og-breytileg-skrefastaer">
<h3><span class="section-number">6.3.3. </span>Stýring á staðarskekkju og breytileg skrefastærð<a class="headerlink" href="#styring-a-staarskekkju-og-breytileg-skrefastaer" title="Permalink to this heading"></a></h3>
<p>Hingað til þá höfum við ekki fengið neinar upplýsingar til að finna heppilegustu skrefastærð.
Eftir því sem skrefastærðin er minni er staðarskekkjan sennilega minni, en þá komumst við
hægar yfir og það er hætta á að heildarskekkjan hækki við að taka mörg skref.
Í <a class="reference internal" href="#aferir-me-breytilega-skrefastaer">Aðferðir með breytilega skrefastærð</a> munum við reyna að stilla
skrefastærðina þannig að við tökum eins stór skref og mögulegt en þó
þannig að staðarskekkjan sé ekki of há.
Þá munum við þurfa eftirfarandi útleiðslu.</p>
<p>Hugsum okkur að við höfum tvær beinar nálgunaraðferðir</p>
<div class="math notranslate nohighlight">
\[w_{n} = w_{n-1} + h_n\varphi(f,t_{n-1},t_n,w_{n-1})\]</div>
<p>og</p>
<div class="math notranslate nohighlight">
\[\tilde w_{n} = w_{n-1} + h_n\tilde\varphi(f,t_{n-1},t_n,w_{n-1})\]</div>
<p>Skilgreinum tilsvarandi staðarskekkjur</p>
<div class="math notranslate nohighlight">
\[\tau_n(h_n) = k_1h_n^{\alpha_1} + o(h_i^{\alpha_1})\]</div>
<p>og</p>
<div class="math notranslate nohighlight">
\[\tilde\tau_n(h_n) = k_2h_n^{\alpha_2} + o(h_i^{\alpha_2}),\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(\alpha_2&gt;\alpha_1\)</span>. Við tímann <span class="math notranslate nohighlight">\(t_{n-1}\)</span> hafa
nálgunargildin <span class="math notranslate nohighlight">\(w_0,\ldots,w_{n-1}\)</span> hafi verið valin samkvæmt
fyrri aðferðinni.</p>
<p>Meiningin að velja næsta tímapunkt <span class="math notranslate nohighlight">\(t_n\)</span> og þar með tímaskref
<span class="math notranslate nohighlight">\(h_n\)</span> þannig að <span class="math notranslate nohighlight">\(\tau_n(h_n)\leq \delta\)</span>, en að
<span class="math notranslate nohighlight">\(\tau_n(h_n)\)</span> haldi sig sem næst <span class="math notranslate nohighlight">\(\delta\)</span>, þar sem
<span class="math notranslate nohighlight">\(\delta\)</span> er gefið efra mark á staðarskekkjunni í fyrri
aðferðinni.</p>
<p>Stærðin <span class="math notranslate nohighlight">\(\delta\)</span> er kölluð <em>þolmörk</em> (e. tolerance) fyrir
staðarskekkjuna og er oft táknuð með <span class="math notranslate nohighlight">\(TOL\)</span>.</p>
<p>Við byrjum á að setja <span class="math notranslate nohighlight">\(h=h_{n}\)</span> inn í báðar aðferðirnar og bera
útkomurnar saman</p>
<div class="math notranslate nohighlight">
\[w_{n} = w_{n-1} + h\varphi(f,t_{n-1},t_{n-1}+h,w_{n-1})\]</div>
<div class="math notranslate nohighlight">
\[\tilde w_{n} = \tilde w_{n-1} +
h\tilde\varphi(f,t_{n-1},t_{n-1}+h,w_{n-1})\]</div>
<p>Við látum <span class="math notranslate nohighlight">\(\hat w_{n}\)</span> tákna rétt gildi lausnarinnar á
upphafsgildisverkefninu</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x'(t)=f(t,x(t))\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(x(t_{n-1})=w_{n-1}\)</span>,</p></li>
</ul>
<p>í punktinum <span class="math notranslate nohighlight">\(t_{n-1}+h\)</span>.</p>
<p>Þá höfum við</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
 \tau_n(h)&amp;=\dfrac{\hat
w_{n}-w_{n-1}}{h}-\varphi(f,t_{n-1},t_{n-1}+h,w_{n-1})\\
&amp;=\dfrac{\hat
w_{n}-w_{n-1}-h\varphi(f,t_{n-1},t_{n-1}+h,w_{n-1})}{h}
=\dfrac {\hat w_{n}-w_{n}}{h}\end{aligned}\end{split}\]</div>
<p>og eins fæst</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\tilde \tau_n(h)
&amp;=\dfrac{\hat
w_{n}-w_{n-1}}{h}-\tilde \varphi(f,t_{n-1},t_{n-1}+h,w_{n-1})\\
&amp;=\dfrac{\hat
w_{n}-w_{n-1}-h\tilde \varphi(f,t_{n-1},t_{n-1}+h,w_{n-1})}{h}
=\dfrac {\hat w_{n}-\tilde w_{n}}{h}. \end{aligned}\end{split}\]</div>
<p>Nú tökum við mismuninn og skilgreinum</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\varepsilon
&amp;= \left|\frac{\tilde w_{n}-w_{n}}{h}\right|=|\tau_n(h)-\tilde
  \tau_n(h)|\\
&amp;=|k_1|h^{\alpha_1}+o(h^{\alpha_1}) \approx |k_1|h^{\alpha_1}  \end{aligned}\end{split}\]</div>
<p>Munum að hér er skreflengdin <span class="math notranslate nohighlight">\(h=h_{n}\)</span>. Þessi nálgunarformúla
gefur okkur möguleika á því að meta fastann</p>
<div class="math notranslate nohighlight">
\[|k_1|\approx
\dfrac\varepsilon{h_{n}^{\alpha_1}}.\]</div>
</section>
<section id="mat-a-skrefastaer">
<h3><span class="section-number">6.3.4. </span>Mat á skrefastærð<a class="headerlink" href="#mat-a-skrefastaer" title="Permalink to this heading"></a></h3>
<p>Segjum nú að við viljum halda staðarskekkjunni innan markanna
<span class="math notranslate nohighlight">\(\delta/2\)</span> og hafa skreflengdina í næsta skrefi
<span class="math notranslate nohighlight">\(h_{n}=qh_{n-1}\)</span>, þá höfum við nálgunarjöfnuna</p>
<div class="math notranslate nohighlight">
\[|\tau_n(qh_{n-1})|\approx |k_1|(qh_{n-1})^{\alpha_1}=
\varepsilon {q^{\alpha_1}} \approx  \frac{\delta} 2.\]</div>
<p>Við tökum</p>
<div class="math notranslate nohighlight">
\[q = \left(\frac{\delta}{2\varepsilon}\right)^{1/{\alpha_1}}\]</div>
<p>veljum síðan skrefstærðina <span class="math notranslate nohighlight">\(h_n = qh_{n-1}\)</span> og reiknum út næsta
gildi</p>
<div class="math notranslate nohighlight">
\[w_{n} = w_{n-1} + h_n\varphi(f,t_{n-1},t_n,w_{n-1})\]</div>
</section>
</section>
<section id="aferir-me-breytilega-skrefastaer">
<span id="index-14"></span><h2><span class="section-number">6.4. </span>Aðferðir með breytilega skrefastærð<a class="headerlink" href="#aferir-me-breytilega-skrefastaer" title="Permalink to this heading"></a></h2>
<p>Dæmi um aðferðir sem notast við breytilega skrefastærð.</p>
<ul class="simple">
<li><p>Einfaldast væri að nota Heun aðferðina (annars stigs) til að meta
skrefastærðina í Euler aðferðinni (fyrsta stigs).</p></li>
<li><p>Algengasta aðferðin er Runge-Kutta-Fehlberg (RKF45) sem notar
5. stigs nálgun til þess að meta staðarskekkjuna í 4. stigs aðferð.</p></li>
<li><p>Endurbót á RKF45 er Runge-Kutta-Verner (RKV56) sem notar 6. stigs
aðferð til að meta skekkjuna í 5. stigs aðferð.</p></li>
<li><p>Fleiri aðferðir: Bogacki–Shampine (3. og 2. stigs), Cash–Karp (5. og
4. stigs) og Dormand–Prince (5. og 4. stigs).</p></li>
</ul>
<section id="reiknirit-fyrir-runge-kutta-fehlberg-rkf45">
<span id="index-15"></span><h3><span class="section-number">6.4.1. </span>Reiknirit fyrir Runge-Kutta-Fehlberg (RKF45)<a class="headerlink" href="#reiknirit-fyrir-runge-kutta-fehlberg-rkf45" title="Permalink to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  \tilde w_j &amp;= w_{j-1} \frac{16}{135} k_1 + \frac{6656}{12825}k_3 + \frac{28561}{56430}k_4
  - \frac{9}{50}k_5 + \frac{2}{55}k_6\\
  w_j &amp;= w_{j-1} + \frac{25}{216}k_1 + \frac{1408}{2565}k_3 + \frac{2197}{4104}k_4 - \frac 15 k_5
 \end{aligned}\end{split}\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  k_1 &amp;= hf(t_{j-1},w_{j-1}) \\
  k_2 &amp;= hf\left( t_{j-1}+\frac 14h, w_{j-1}+\frac 14k_1          \right)\\
  k_3 &amp;= hf\left( t_{j-1}+\frac 38h, w_{j-1}+\frac 3{32}k_1 + \frac 9{32}k_2\right)\\
  k_4 &amp;= hf\left( t_{j-1}+\frac{12}{13}h, w_{j-1} + \frac{1932}{2197}k_1
  - \frac{7200}{2197}k_2 + \frac{7296}{2197}k_3 \right)\\
  k_5 &amp;= hf\left( t_{j-1} +h, w_{j-1} + \frac{439}{216}k_1 - 8k_2+\frac{3680}{513}k_3
  -\frac{845}{4104}k_4\right)\\
  k_6 &amp;= hf\left( t_{j-1} +\frac 12h, w_{j-1} - \frac 8{27}k_1 + 2k_2 -\frac{3544}{2565}k_3
  +\frac{1859}{4104}k_4 - \frac{11}{40}k_5\right)\\
 \end{aligned}\end{split}\]</div>
</section>
<section id="runge-kutte-fehlberg-rkf45-profu">
<h3><span class="section-number">6.4.2. </span>Runge-Kutte-Fehlberg (RKF45) prófuð<a class="headerlink" href="#runge-kutte-fehlberg-rkf45-profu" title="Permalink to this heading"></a></h3>
<p>Höldum áfram með dæmi sem við beittum <a class="reference external" href="AðferðEulers:Dæmi">aðferð Eulers</a> og
<a class="reference external" href="KlassískaRunge-Kuttaaðferðin:Dæmi">klassísku Runge-Kutta</a> hér á undan</p>
<p>Þá gefur eftirfarandi mynd af skekkjunni. Hér er 0.01 minnsta leyfilega
skrefastærðin, 0.1 stærsta leyfilega skrefastærðin og þolmörkin eru
<span class="math notranslate nohighlight">\(10^{-10}\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="n">t</span><span class="o">./</span><span class="n">x</span><span class="p">;</span>
<span class="o">&gt;&gt;</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">rkf45</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1E-10</span><span class="p">]);</span>
<span class="o">&gt;&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="o">.^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/7rkf45.png" src="../_images/7rkf45.png" />
<p>Hér á undan þá notðum við þolmörkin <span class="math notranslate nohighlight">\(10^{-10}\)</span> sem skilaði okkur
103 misstórum tímagildum á bilinu <span class="math notranslate nohighlight">\([0,5]\)</span>. Svona getum við teiknað
upp stærðina á tímaskrefunum.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;</span> <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">end</span><span class="p">)</span><span class="o">-</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">end</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/7rkf45t.png" src="../_images/7rkf45t.png" />
</section>
</section>
<section id="fjolskrefaaferir">
<span id="index-16"></span><h2><span class="section-number">6.5. </span>Fjölskrefaaðferðir<a class="headerlink" href="#fjolskrefaaferir" title="Permalink to this heading"></a></h2>
<p>Þær aðferðir sem við höfum séð eiga allar sameiginlegt að ákvarða
nálgunargildi <span class="math notranslate nohighlight">\(w_{n}\)</span> aðeins út frá gildinu <span class="math notranslate nohighlight">\(w_{n-1}\)</span> næst á
undan. Hægt er að nota fleiri gildi <span class="math notranslate nohighlight">\(w_{n-1}\)</span>, <span class="math notranslate nohighlight">\(w_{n-2}\)</span>,
<span class="math notranslate nohighlight">\(\ldots\)</span> og fá þannig betri nákvæmni, en aðferðirnar verða að sama
skapi flóknari í notkun.</p>
<p>Eins og alltaf höfum við verkefnið</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
    \begin{array}{l}
      x'(t) = f(t,x(t)) \\
      x(t_0) = w_0
    \end{array}
  \right.\end{split}\]</div>
<p>og viljum nálga gildi lausnarinnar <span class="math notranslate nohighlight">\(x\)</span> á bili <span class="math notranslate nohighlight">\([a,b]\)</span> þar
sem <span class="math notranslate nohighlight">\(a =t_0\)</span> eða <span class="math notranslate nohighlight">\(b = t_0\)</span>. Látum <span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(t_1\)</span>,
<span class="math notranslate nohighlight">\(\ldots\)</span>, <span class="math notranslate nohighlight">\(t_n\)</span> vera skiptingu á bilinu <span class="math notranslate nohighlight">\([a,b]\)</span> og
gerum til einföldunar ráð fyrir að hún hafi jafna billengd
<span class="math notranslate nohighlight">\(h=t_{j} - t_{j-1}\)</span> fyrir <span class="math notranslate nohighlight">\(j= 1, \ldots, n\)</span>.</p>
<section id="k-skrefa-adams-bashforth-afer">
<span id="index-17"></span><h3><span class="section-number">6.5.1. </span><span class="math notranslate nohighlight">\(k\)</span>-skrefa Adams-Bashforth aðferð<a class="headerlink" href="#k-skrefa-adams-bashforth-afer" title="Permalink to this heading"></a></h3>
<p>Við vitum að lausnin <span class="math notranslate nohighlight">\(x\)</span> uppfyllir</p>
<div class="math notranslate nohighlight">
\[x(t_{n}) - x(t_{n-1}) =
  \int\limits_{t_{n-1}}^{t_n} f(t,x(t)) \, dt\]</div>
<p>Skrifum nú</p>
<div class="math notranslate nohighlight">
\[f(t,x(t)) = P_{k-1}(t) + R_{k-1}(t)\]</div>
<p>þar sem</p>
<div class="math notranslate nohighlight">
\[P_{k-1}(t) = \sum\limits_{j=1}^k f(t_{n-j},x(t_{n-j})) \cdot
  \ell_{k-1,j}(t)\]</div>
<p>er brúunarmargliðan gegnum punktana <span class="math notranslate nohighlight">\((t_{n-k},x(t_{n-k}))\)</span>,
<span class="math notranslate nohighlight">\((t_{n+1-k},x(t_{n+1-k}))\)</span>, <span class="math notranslate nohighlight">\(\ldots\)</span>,
<span class="math notranslate nohighlight">\((t_{n-1},x(t_{n-1}))\)</span>, þ.e. gegnum síðustu <span class="math notranslate nohighlight">\(k\)</span> punkta á
undan <span class="math notranslate nohighlight">\((t_n,x(t_n))\)</span>.</p>
<p>Þetta eru <span class="math notranslate nohighlight">\(k\)</span> punktar og því er aðferðin kölluð <span class="math notranslate nohighlight">\(k\)</span>-skrefa
aðferð.</p>
<p><a class="reference external" href="kafli03.html#id9">Munum</a> að til er <span class="math notranslate nohighlight">\(\xi\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[R_{k-1}(t) = \frac{f^{(k)}(\xi,x(\xi))}{k!}
  \prod\limits_{j=1}^m (t-t_{n-j}).\]</div>
<p>Við nálgum nú heildið af <span class="math notranslate nohighlight">\(f\)</span> yfir bilið <span class="math notranslate nohighlight">\([t_{n-1},t_n]\)</span> með
heildi <span class="math notranslate nohighlight">\(P_{k-1}\)</span> og fáum</p>
<div class="math notranslate nohighlight">
\[w_{i+1} = w_i +
  \int\limits_{t_i}^{t_{i+1}} P_{k-1}(t) \, dt\]</div>
<p>og með beinum útreikningum má sjá að skekkjan í þessari nálgun er
<span class="math notranslate nohighlight">\(O(h^{k+1})\)</span>. Þessir útreikninga flækjast auðvitað eftir því sem
<span class="math notranslate nohighlight">\(k\)</span> stækkar.</p>
<p>Augljóslega getum við ekki notað <span class="math notranslate nohighlight">\(k\)</span> skrefa Adams-Bashforth
aðferðir um leið og við sjáum upphafsgildisverkefni, því við þurfum
<span class="math notranslate nohighlight">\(k\)</span> ágiskunargildi <span class="math notranslate nohighlight">\(w_0, w_1, \ldots, w_{k-1}\)</span> til að byrja
að nota aðferðina. Þessi gildi má fá með hverri sem er af aðferðunum sem
við höfum séð hingað til.</p>
<p>Ákveðin sértilfelli Adams-Bashforth aðferðanna eru meira notuð en önnur,
það eru tveggja, þriggja og fjögurra skrefa aðferðirnar. Áhugasömum
verður ekki skotaskuld úr að leiða út formúlurnar fyrir þær, en við
birtum bara niðurstöðurnar.</p>
<p>Til styttingar skilgreinum við <span class="math notranslate nohighlight">\(f_j = f(t_j,w_j)\)</span>.</p>
</section>
<section id="tveggja-skrefa-adams-bashforth-afer">
<h3><span class="section-number">6.5.2. </span>Tveggja skrefa Adams-Bashforth-aðferð<a class="headerlink" href="#tveggja-skrefa-adams-bashforth-afer" title="Permalink to this heading"></a></h3>
<p>Þegar gildin <span class="math notranslate nohighlight">\(w_{n-1}\)</span> og <span class="math notranslate nohighlight">\(w_{n-2}\)</span> hafa verið fundin fæst
næsta nálgunargildi með</p>
<div class="math notranslate nohighlight">
\[w_{n} = w_{n-1} + h\big(\tfrac 32 f_{n-1} - \tfrac 12 f_{n-2}\big)\]</div>
<p>og skekkjan í nálguninni er <span class="math notranslate nohighlight">\(O(h^3)\)</span>.</p>
</section>
<section id="forrit-fyrir-tveggja-skrefa-adams-bashforth-afer">
<h3><span class="section-number">6.5.3. </span>Forrit fyrir tveggja skrefa Adams-Bashforth-aðferð<a class="headerlink" href="#forrit-fyrir-tveggja-skrefa-adams-bashforth-afer" title="Permalink to this heading"></a></h3>
<p>Aðferðin er útfærð í forritinu hér að neðan; það skýrir sig að mestu
sjálft en við skulum taka eftir þrennu:</p>
<p>(i) Við krefjumst þess að notandinn gefi nálgunargildi á x(t(2)), þetta
gerum við því til eru margar mismunandi aðferðir til að fá slíkt gildi
og þær henta mis vel hverju sinni.</p>
<p>(ii) Við gerum ekki sérstaklega ráð fyrir að jafnt bil sé á milli
stakanna í vigrinum t þó við höfum gert það hingað til. Það var aðeins
gert til að einfalda útreikninga; aðferðin virkar nákvæmlega eins ef það
er ekki jafnt bil á milli stakanna, svo sjálfsagt er að forrita hana
þannig.</p>
<p>(iii) Við lágmörkum fjölda skipta sem við reiknum gildi f með að geyma
alltaf gildið frá síðustu ítrun og nota það aftur, þetta getur sparað
nokkurn tíma í útreikningum ef f er flókið fall.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">w</span> <span class="o">=</span> <span class="n">adams_bashforth_2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
<span class="o">%</span>   <span class="n">w</span> <span class="o">=</span> <span class="n">adams</span><span class="p">{</span><span class="n">_</span><span class="p">}</span><span class="n">bashforth</span><span class="p">{</span><span class="n">_</span><span class="p">}</span><span class="mi">2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">)</span>
<span class="o">%</span> <span class="n">Nálgar</span> <span class="n">lausn</span> <span class="n">upphafsgildisverkefnisins</span>
<span class="o">%</span>   <span class="n">x</span><span class="s1">&#39; = f(t,x)</span>
<span class="o">%</span>   <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="n">x1</span>
<span class="o">%</span> <span class="n">í</span> <span class="n">punktunum</span> <span class="n">í</span> <span class="n">t</span> <span class="n">með</span> <span class="mi">2</span><span class="n">ja</span> <span class="n">þrepa</span> <span class="n">Adams</span><span class="o">-</span><span class="n">Bashforth</span> <span class="n">aðferð</span><span class="o">.</span>
<span class="o">%</span> <span class="n">Stakið</span> <span class="n">x2</span> <span class="n">er</span> <span class="n">nálgunargildi</span> <span class="n">á</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span>

<span class="n">N</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>  <span class="n">M</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x1</span><span class="p">);</span> <span class="n">w</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
<span class="o">%</span> <span class="n">Upphafsstillum</span> <span class="n">gildi</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="n">og</span> <span class="n">w</span>
<span class="n">fx1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">x1</span><span class="p">);</span> <span class="n">fx2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">x2</span><span class="p">);</span>
<span class="n">w</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">x1</span><span class="p">;</span> <span class="n">w</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">x2</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">:</span><span class="n">N</span>
  <span class="o">%</span> <span class="n">Reiknum</span> <span class="n">nálgunargildi</span>
  <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="n">t</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="n">w</span><span class="p">(:,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">w</span><span class="p">(:,</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">fx2</span> <span class="o">-</span> <span class="n">fx1</span><span class="p">);</span>
  <span class="n">fx1</span> <span class="o">=</span> <span class="n">fx2</span><span class="p">;</span> <span class="n">fx2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">w</span><span class="p">(:,</span><span class="n">i</span><span class="p">));</span>
<span class="n">end</span>
</pre></div>
</div>
</section>
<section id="riggja-skrefa-adams-bashforth">
<h3><span class="section-number">6.5.4. </span>Þriggja skrefa Adams-Bashforth<a class="headerlink" href="#riggja-skrefa-adams-bashforth" title="Permalink to this heading"></a></h3>
<p>Gefin <span class="math notranslate nohighlight">\(w_{n-1}\)</span>, <span class="math notranslate nohighlight">\(w_{n-2}\)</span> og <span class="math notranslate nohighlight">\(w_{n-3}\)</span> fæst næsta
nálgunargildi með</p>
<div class="math notranslate nohighlight">
\[w_{n} = w_{n-1} + {h}(\tfrac{23}{12} f_{n-1} - \tfrac {16}{12}
  f_{n-2} + \tfrac 5{12} f_{n-2})\]</div>
<p>og staðarskekkjan er <span class="math notranslate nohighlight">\(O(h^4)\)</span></p>
</section>
<section id="fjogurra-skrefa-adams-bashforth">
<h3><span class="section-number">6.5.5. </span>Fjögurra skrefa Adams-Bashforth<a class="headerlink" href="#fjogurra-skrefa-adams-bashforth" title="Permalink to this heading"></a></h3>
<p>Þegar við þekkjum <span class="math notranslate nohighlight">\(w_{n-1}\)</span>, <span class="math notranslate nohighlight">\(w_{n-2}\)</span>, <span class="math notranslate nohighlight">\(w_{n-3}\)</span> og
<span class="math notranslate nohighlight">\(w_{n-4}\)</span> reiknum við næsta gildi með</p>
<div class="math notranslate nohighlight">
\[w_{n} = w_{n-1} + h\big(\tfrac{55}{24}f_{n-1} - \tfrac{59}{24}f_{n-2} +
\tfrac {37}{24}f_{n-3} -\tfrac 9{24}f_{n-4}\big)\]</div>
<p>og skekkjan í nálguninni er <span class="math notranslate nohighlight">\(O(h^5)\)</span>.</p>
</section>
</section>
<section id="greining-a-samleitni-og-stougleika">
<h2><span class="section-number">6.6. </span>Greining á samleitni og stöðugleika<a class="headerlink" href="#greining-a-samleitni-og-stougleika" title="Permalink to this heading"></a></h2>
<p>Lítum aftur á upphafsgildisverkefnið okkar</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
  x'(t)=f(t,x(t)),\\
x(t_0)=w_0.
\end{cases}\end{split}\]</div>
<p>Við hugsum okkur að nálgun sé fundin í tímapunktunum</p>
<div class="math notranslate nohighlight">
\[a=t_0&lt;t_1&lt;t_2&lt;\cdots&lt;t_N=b.\]</div>
<p>Við táknum nálgunargildi á <span class="math notranslate nohighlight">\(x(t_j)\)</span> með <span class="math notranslate nohighlight">\(w_j\)</span>. Það er gefið
með</p>
<div class="math notranslate nohighlight">
\[w_n=w_{n-1}+h_n\varphi(f,t_{0},\dots,t_n,w_{0},\dots,w_{n})\]</div>
<p>þar sem fallið <span class="math notranslate nohighlight">\(\varphi(f,t_{0},\dots,t_n,w_{0},\dots,w_{n})\)</span> er
skilgreint með einhverjum hætti.</p>
<p>Við köllum þetta <em>nálgunaraðferðina sem fallið</em> <span class="math notranslate nohighlight">\(\varphi\)</span> <em>gefur af
sér.</em></p>
<section id="id3">
<h3><span class="section-number">6.6.1. </span>Skekkja<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<p><em>Skekkja</em> (e. error) eða <em>heildarskekkja</em> (e. total error) í nálgun á
<span class="math notranslate nohighlight">\(x(t_n)\)</span> með <span class="math notranslate nohighlight">\(w_n\)</span> er</p>
<div class="math notranslate nohighlight">
\[e_n=x(t_n)-w_n,\]</div>
<p>og <em>staðarskekkja</em> (e. local truncation error) nálgunaraðferðarinnar við tímann <span class="math notranslate nohighlight">\(t_n\)</span>
er</p>
<div class="math notranslate nohighlight">
\[\tau_n=\dfrac{x(t_n)-x(t_{n-1})}{h_n}
-\varphi(f,t_{0},\dots,t_n,x(t_{0}),\dots,x(t_{n}))\]</div>
<div class="admonition note">
<p class="admonition-title">Athugasemd</p>
<p>Munið að hér er <em>rétta lausnin</em> sett inn í nálgunaraðferðina.</p>
</div>
</section>
<section id="samleitni">
<span id="index-18"></span><h3><span class="section-number">6.6.2. </span>Samleitni<a class="headerlink" href="#samleitni" title="Permalink to this heading"></a></h3>
<p>Hugsum okkur nú að fjöldi tímapunktanna <span class="math notranslate nohighlight">\(N\)</span> stefni á óendanlegt.
Við segjum að nálgunaraðferðin <span class="math notranslate nohighlight">\(\varphi\)</span> sé <em>samleitin</em> ef</p>
<div class="math notranslate nohighlight">
\[\lim_{N\to \infty} \max\limits_{1\leq n\leq N} |e_n|=0\]</div>
<p>þar sem <span class="math notranslate nohighlight">\(e_n=x(t_n)-w_n\)</span> táknar skekkjuna í <span class="math notranslate nohighlight">\(n\)</span>-ta
tímaskrefinu.</p>
</section>
<section id="samraemi">
<span id="index-19"></span><h3><span class="section-number">6.6.3. </span>Samræmi<a class="headerlink" href="#samraemi" title="Permalink to this heading"></a></h3>
<p>Við segjum að nálgunaraðferðin <span class="math notranslate nohighlight">\(\varphi\)</span> <em>samræmist</em>
upphafsgildisverkefninu ef um sérhvern tímapunkt <span class="math notranslate nohighlight">\(t_{n-1}\)</span> gildir
að</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
\lim_{h_n\to 0}\tau_n\\
=\lim_{t_n\to t_{n-1}}\bigg(\dfrac{x(t_n)-x(t_{n-1})}{t_n-t_{n-1}}
-\varphi(f,t_{0},\dots,t_n,x(t_{0}),\dots,x(t_{n}))\bigg)
=0  \end{gathered}\end{split}\]</div>
</section>
<section id="samraemi-endurbaettu-euler-aferarinnar">
<h3><span class="section-number">6.6.4. </span>Samræmi endurbættu Euler-aðferðarinnar<a class="headerlink" href="#samraemi-endurbaettu-euler-aferarinnar" title="Permalink to this heading"></a></h3>
<p>Munum að endurbætta Euler-aðferðin er</p>
<div class="math notranslate nohighlight">
\[w_n=w_{n-1}+h_nf(t_{n-1}+\tfrac 12 h_n,w_{n-1}+\tfrac 12 hf(t_{n-1},w_{n-1}))\]</div>
<p>sem gefur staðarskekkjuna</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
\tau_n=\dfrac{x(t_{n-1}+h_n)-x(t_{n-1})}{h_n}\\
-f(t_{n-1}+\tfrac 12 h_n,x(t_{n-1})+\tfrac 12 h_nf(t_{n-1},x(t_{n-1}))).
  \end{gathered}\end{split}\]</div>
<p>Nú hugsum við okkur að <span class="math notranslate nohighlight">\(t_{n-1}\)</span> sé haldið föstu og látum
billengdina <span class="math notranslate nohighlight">\(h_n=t_n-t_{n-1}\)</span> stefna á <span class="math notranslate nohighlight">\(0\)</span>. Þá fæst</p>
<div class="math notranslate nohighlight">
\[\lim_{h_n\to 0} \tau_n= x'(t_{n-1})-f(t_{n-1},x(t_{n-1}))=0\]</div>
<p>Þetta segir okkur að endurbætta Euler-aðferðin samræmist
upphafsgildisverkefninu.</p>
</section>
<section id="samraemi-beinna-eins-skrefs-afera">
<h3><span class="section-number">6.6.5. </span>Samræmi beinna eins skrefs aðferða<a class="headerlink" href="#samraemi-beinna-eins-skrefs-afera" title="Permalink to this heading"></a></h3>
<p>Þessi röksemdafærla alhæfist á allar beinar eins skrefs aðferðir, því
staðarskekkja þeirra er</p>
<div class="math notranslate nohighlight">
\[\tau_n=\dfrac{x(t_{n-1}+h_n)-x(t_{n-1})}{h_n}
-\varphi(f,t_{n-1},t_{n-1}+h_n,x(t_{n-1}))\]</div>
<p>Nú er eðlilegt að gefa sér að <span class="math notranslate nohighlight">\(\varphi\)</span> sé samfellt fall og þá
verður markgildið af staðarskekkjunni</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gathered}
x'(t_{n-1})-\varphi(f,t_{n-1},t_{n-1},x(t_{n-1}))\\
=f(t_{n-1},x(t_{n-1}))-\varphi(f,t_{n-1},t_{n-1},x(t_{n-1})).\end{gathered}\end{split}\]</div>
<p>Eins skrefs aðferðin sem fallið <span class="math notranslate nohighlight">\(\varphi\)</span> gefur af sér er því
stöðug ef og aðeins ef</p>
<div class="math notranslate nohighlight">
\[\varphi(f,t_{n-1},t_{n-1},x(t_{n-1}))
=f(t_{n-1},x(t_{n-1})).\]</div>
</section>
<section id="stougleiki">
<span id="index-20"></span><h3><span class="section-number">6.6.6. </span>Stöðugleiki<a class="headerlink" href="#stougleiki" title="Permalink to this heading"></a></h3>
<p>Gerum nú ráð fyrir að upphafsgildinu <span class="math notranslate nohighlight">\(w_0\)</span> sé breytt í
<span class="math notranslate nohighlight">\(\tilde w_0\)</span> og að <span class="math notranslate nohighlight">\(\tilde x(t)\)</span> uppfylli</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
  \tilde x'(t)=f(t,\tilde x(t)),\\
\tilde x(t_0)=\tilde w_0.
\end{cases}\end{split}\]</div>
<p>Lítum síðan á tilsvarandi nálgunarrunu</p>
<div class="math notranslate nohighlight">
\[\tilde w_n=\tilde w_{n-1}+h_n\varphi(f,t_0,\dots,t_n,\tilde
w_0,\dots,\tilde w_n).\]</div>
<p>Við segjum að nálgunaraðferðin sem <span class="math notranslate nohighlight">\(\varphi\)</span>
gefur af sér sé <em>stöðug</em> ef til er fall <span class="math notranslate nohighlight">\(k(t)&gt;0\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[|\tilde w_n-w_n|\leq k(t_n)|\tilde w_0-w_0|, \qquad n=1,2,3\dots.\]</div>
</section>
<section id="lipschitz-samfelldni">
<span id="index-21"></span><h3><span class="section-number">6.6.7. </span>Lipschitz-samfelldni<a class="headerlink" href="#lipschitz-samfelldni" title="Permalink to this heading"></a></h3>
<p>Rifjum nú upp að við gerum ráð fyrir að fallið <span class="math notranslate nohighlight">\(f(t,x)\)</span> sé
skilgreint á svæði <span class="math notranslate nohighlight">\(D\)</span> sem inniheldur</p>
<div class="math notranslate nohighlight">
\[\{(t,x)\in {{\mathbb  R}}^2 \, ;\, a\leq t\leq b, x\in {{\mathbb  R}}\}.\]</div>
<p>Við segjum að <span class="math notranslate nohighlight">\(f\)</span> sé <em>Lipschitz samfellt á</em> <span class="math notranslate nohighlight">\(D\)</span> <em>með tilliti
til</em> <span class="math notranslate nohighlight">\(x\)</span> ef til er fasti <span class="math notranslate nohighlight">\(C_f\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[|f(t,x)-f(t,y)|\leq C_f|x-y|, \qquad x,y\in {{\mathbb  R}}.\]</div>
<p>Hugsum okkur að <span class="math notranslate nohighlight">\(\varphi(f,s,t,x)\)</span> sé fall sem gefur af sér beina
eins skrefs nálgunaraðferð fyrir upphafsgildisverkefnið
<span class="math notranslate nohighlight">\(x'(t)=f(t,x(t))\)</span> með <span class="math notranslate nohighlight">\(x(t_0)=w_0\)</span>.</p>
<p>Við segjum að <span class="math notranslate nohighlight">\(\varphi\)</span> sé <em>Lipschitz-samfellt með tilliti til</em>
<span class="math notranslate nohighlight">\(x\)</span> ef um sérhvert Lipschitz-samfellt fall <span class="math notranslate nohighlight">\(f\)</span>, tölur
<span class="math notranslate nohighlight">\(s,t\in [a,b]\)</span> og <span class="math notranslate nohighlight">\(x,y\in {{\mathbb  R}}\)</span> gildir að til er
fasti <span class="math notranslate nohighlight">\(L_\varphi\)</span> þannig að</p>
<div class="math notranslate nohighlight">
\[|\varphi(f,s,t,x)-\varphi(f,s,t,y)|\leq L_\varphi|x-y|, \qquad x,y\in {{\mathbb  R}}.\]</div>
</section>
<section id="setning-um-stougleika-og-samleitni">
<h3><span class="section-number">6.6.8. </span>Setning um stöðugleika og samleitni<a class="headerlink" href="#setning-um-stougleika-og-samleitni" title="Permalink to this heading"></a></h3>
<p>Gefum okkur jafna skiptingu á tímabilinu <span class="math notranslate nohighlight">\([a,b]\)</span>,
<span class="math notranslate nohighlight">\(t_n=a+nh\)</span>, þar sem <span class="math notranslate nohighlight">\(n=0,1,2,\dots,N\)</span> og <span class="math notranslate nohighlight">\(h=(b-a)/N\)</span>.</p>
<p>Ef fallið <span class="math notranslate nohighlight">\(\varphi\)</span> er Lipschitz-samfellt með tilliti til
<span class="math notranslate nohighlight">\(x\)</span> með Lipschitz-fastann <span class="math notranslate nohighlight">\(L_\varphi\)</span>, þá gildir:</p>
<ol class="arabic">
<li><p>Eins skrefs aðferðin sem <span class="math notranslate nohighlight">\(\varphi\)</span> gefur af sér er stöðug,</p>
<div class="math notranslate nohighlight">
\[|\tilde w_n-w_n|\leq e^{L_\varphi(t_n-a)}|\tilde w_0-w_0|, \qquad
n=1,2,3,\dots.\]</div>
</li>
<li><p>Ef til eru fastar <span class="math notranslate nohighlight">\(c\)</span> og <span class="math notranslate nohighlight">\(p\)</span> þannig að staðarskekkjan
uppfyllir <span class="math notranslate nohighlight">\(|\tau_n|\leq c\, h^p\)</span>, fyrir öll
<span class="math notranslate nohighlight">\(n=1,2,3,\dots\)</span> og <span class="math notranslate nohighlight">\(h\in ]0,h_0]\)</span>, þá er aðferðin
samleitin og við höfum</p>
<div class="math notranslate nohighlight">
\[|e_n|=|x(t_n)-w_n|\leq \dfrac{ch^p}{L_\varphi}
\bigg(e^{L_\varphi(t_n-a)}-1\bigg).\]</div>
</li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../kafli05/" class="btn btn-neutral float-left" title="5. Töluleg heildun" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../kafli07/" class="btn btn-neutral float-right" title="7. Jaðargildisverkefni" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

<style>
    /* Sidebar header (and topbar for mobile) */
    
    .wy-side-nav-search,
    .wy-nav-top {
        background: #10099F;
    }
    /* Sidebar */
    
    .wy-nav-side {
        background: #262626;
    }
</style>


</body>
</html>