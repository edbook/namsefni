<!DOCTYPE html>
<html class="writer-html5" lang="is" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3 Flokkun vigra &mdash; Valin efni í stærðfræði og reiknifræði 2021</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/python.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/edbook.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon_2.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script src="../_static/translations.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>

<!-- hoverrole.py css code -->
<style type="text/css">
    a.tooltip {
        outline: none;
        border-bottom: thin dotted;
        background: #ffeedd
    }

    a.tooltip strong {
        line-height: 30px;
    }

    a.tooltip:hover {
        text-decoration: none;
    }

    a.tooltip span {
        z-index: 10;
        display: none;
        padding: 14px 20px;
        margin-top: -30px;
        margin-left: 12px;
        width: 310px;
        line-height: 16px;
    }

    a.tooltip:hover span {
        display: inline;
        position: absolute;
        color: #111;
        border: 1px solid #DCA;
        background: #fffAF0;
    }

    .callout {
        z-index: 20;
        position: absolute;
        top: 30px;
        border: 0;
        left: -12px;
    }

    /*CSS3*/
    a.tooltip span {
        border-radius: 4px;
        box-shadow: 5px 5px 8px #CCC;
    }
</style>
<!-- End hoverrole.py css code -->

<style type="text/css">
    .sagecell .CodeMirror-scroll {
        overflow-y: hidden;
        overflow-x: auto;
    }

    .sagecell .CodeMirror {
        height: auto;
    }

    /* - Begin equation reference style - */
    h6.eqno {
        display: inline-block;
        padding-left: 10px;
    }

    h6 .headerlink {
        display: inline-block !important;
    }

    h6 .headerlink:after {
        visibility: hidden !important;
    }

    h6 .headerlink:hover:after {
        visibility: visible !important;
    }

    .eqno:hover>.headerlink:after {
        visibility: visible !important;
    }

    table>caption>.headerlink {
        visibility: hidden !important;
    }

    table>caption>.headerlink {
        visibility: hidden !important;
    }

    /* - End - */
</style>
<style type="text/css">
    /* .ace_content .ace_layer .ace_line_group .ace_line * { */
    /*     font-size: 15px !important; */
    /* } */
    /* div[class^='highlight'] pre {font-size:15px} */
    div.code-block-caption {
        margin-bottom: 4px
    }
</style>

    <link rel="index" title="Atriðaskrá" href="../genindex/" />
    <link rel="search" title="Leit" href="../search/" />
    <link rel="next" title="VIÐAUKI A: Python-teikning tvívíðra falla" href="../vidauki-A/" />
    <link rel="prev" title="2 Línuleg algebra" href="../kafli02/" />



<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script type="text/javascript" src="https://cdn.geogebra.org/apps/deployggb.js"></script>


 

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Valin efni í stærðfræði og reiknifræði
              <img src="../_static/hi_horiz_raunvisindadeild.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2021
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../kafli01/">1  Föll af mörgum breytistærðum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kafli02/">2  Línuleg algebra</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3  Flokkun vigra</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#daemi-um-flokkun-tvivira-vigra">3.1  Dæmi um flokkun tvívíðra vigra</a></li>
<li class="toctree-l2"><a class="reference internal" href="#daemi-um-hagnytingu-flokkunar">3.2  Dæmi um hagnýtingu flokkunar</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rithattur-fyrir-flokkun">3.3  Ritháttur fyrir flokkun</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mipunktar-hopa">3.4  Miðpunktar hópa</a></li>
<li class="toctree-l2"><a class="reference internal" href="#besta-hopaskipting">3.5  Besta hópaskipting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#k-means-reikniriti">3.6  k-means reikniritið</a></li>
<li class="toctree-l2"><a class="reference internal" href="#daemi-um-nokkrar-k-means-itrekanir">3.7  Dæmi um nokkrar k-means-ítrekanir</a></li>
<li class="toctree-l2"><a class="reference internal" href="#forvinnsla-vigra-me-whiten">3.8  Forvinnsla vigra með <code class="code docutils literal notranslate"><span class="pre">whiten</span></code></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vidauki-A/">VIÐAUKI A: Python-teikning tvívíðra falla</a></li>
<li class="toctree-l1"><a class="reference internal" href="../verkefni/">VERKEFNI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Valin efni í stærðfræði og reiknifræði</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">3  </span>Flokkun vigra</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/kafli03.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flokkun-vigra">
<h1><span class="section-number">3  </span>Flokkun vigra<a class="headerlink" href="#flokkun-vigra" title="Permalink to this heading"></a></h1>
<p>Í þessari grein verður fjallað um aðferðir til að <strong>flokka</strong> (<em>cluster</em>,
<em>partition</em>) vigra í <strong>hópa</strong> (<em>groups</em>) þannig að vigrarnir í hverjum hóp séu
líkir hver öðrum, en vigrar í mismunandi hópum séu ekki eins líkir. Verkefni af
þessu tagi er nefnt <em>clustering</em> á ensku. Sér í lagi verður farið í hið
velþekkta <strong>k-means</strong> reiknirit (oftast er bara talað um <em>k-means</em> og ekki reynt
að þýða). Stundum er talað um að flokka <em>mælingar</em> (<em>observations</em>), <em>punkta</em>,
<em>einstaklinga</em> eða <em>hluti</em>, og þegar búið er að flokka má tala um <em>meðlimi</em> í
hópum. Orðið <strong>einkenni</strong> (<em>feature</em>) er oft notað um einstök stök í vigrunum
sem eru flokkaðir.</p>
<section id="daemi-um-flokkun-tvivira-vigra">
<h2><span class="section-number">3.1  </span>Dæmi um flokkun tvívíðra vigra<a class="headerlink" href="#daemi-um-flokkun-tvivira-vigra" title="Permalink to this heading"></a></h2>
<p>Á eftirfarandi mynd er dæmi um flokkun tvívíðra vigra, sem sé punkta í planinu.</p>
<figure class="align-center" id="flokkun300" style="width: 12cm">
<img alt="../_images/flokkunard%C3%A6mi300.png" src="../_images/flokkunard%C3%A6mi300.png" />
<figcaption>
<p><span class="caption-number">Mynd 3.1: </span><span class="caption-text">Skipting 300 punkta í þrjá hópa</span><a class="headerlink" href="#flokkun300" title="Varanlegur hlekkur á þessa mynd"></a></p>
</figcaption>
</figure>
<p>Einn vandi við slíka flokkun er að ákvarða hópafjöldann, sem hefðbundið er að
nefna <span class="math notranslate nohighlight">\(k\)</span>. Það sem er óvenjulegt við dæmið á myndinni er að vídd punktanna
er <span class="math notranslate nohighlight">\(n = 2\)</span> og því er auðvelt að teikna punktasafnið. Í þessu dæmi er líka
auðvelt að sjá af myndinni að <span class="math notranslate nohighlight">\(k = 3\)</span> er góð tala, en þetta er ekki svona
auðvelt fyrir hærri víddir og jafnvel heldur ekki fyrir önnur tvívíð dæmi.</p>
</section>
<section id="daemi-um-hagnytingu-flokkunar">
<h2><span class="section-number">3.2  </span>Dæmi um hagnýtingu flokkunar<a class="headerlink" href="#daemi-um-hagnytingu-flokkunar" title="Permalink to this heading"></a></h2>
<p><strong>Flokkun texta eftir umfjöllunarefni.</strong> Hér er nærtækt að taka dæmið um
Wikipedia-greinarnar sem voru á dagskrá í Skilaverkefni 7, þar sem unnið var með
tíðni 1000 orða í 300 Wikipedia-greinum sem fjölluðu um fimm mismunandi
efnisflokka, Pokemon, veðurfræði, listir, stofnanir Sameinuðu þjóðanna, og
rafmagnsverkfræði. Góður flokkari ætti að geta fundið (endurskapað) flokkunina,
a.m.k. komist nálægt henni útfrá orðtíðnigögnunum einum saman, sérstaklega ef
við festum <span class="math notranslate nohighlight">\(k = 5\)</span>.</p>
<p><strong>Flokkun sjúklinga.</strong> Ef <span class="math notranslate nohighlight">\(x_i\)</span> er vigur af einkennum sjúklings númer <span class="math notranslate nohighlight">\(i\)</span>
(t.d. aldur, kyn, BMI, og sjúkdómseinkenni af ýmsu tagi) þá gætti verið gagnlegt
að flokka sjúklingana í hópa með svipuð einkenni.</p>
<p><strong>Flokkun viðskiptavina.</strong> Gerum ráð fyrir að <span class="math notranslate nohighlight">\(j\)</span>-ta stak <span class="math notranslate nohighlight">\(x_i\)</span> sé
magn af vöru <span class="math notranslate nohighlight">\(j\)</span> sem kúnni númer <span class="math notranslate nohighlight">\(i\)</span> keypti á tilteknu tímabili. Þá
mætti flokka kúnnana í <span class="math notranslate nohighlight">\(k\)</span> hópa og svo mætti beina sömu auglýsingum til
þeirra sem eru í sama hóp, eða t.d. auglýsingum um það sem aðrir í hópnum hafa
keypt en þeir ekki.</p>
<p>Auðvelt er að búa til allskonar dæmi af sama tagi: Skipting nemenda í flokka
eftir einkunnum og námsbraut (þá mætti t.d. búa til verkefnahópa með einum úr
hverjum flokki til að fá fjölbreytni í hópana), flokkun svæða eftir veðurfari,
flokkun fyrirtækja eftir ýmsum eiginleikum, o.s.frv.</p>
<p>Í sumum tilvikum er ekkert unnið frekar með flokkana, heldur er tilgangur
flokkunarinnar einfaldlega sá að átta sig betur á gagnasafni.</p>
</section>
<section id="rithattur-fyrir-flokkun">
<h2><span class="section-number">3.3  </span>Ritháttur fyrir flokkun<a class="headerlink" href="#rithattur-fyrir-flokkun" title="Permalink to this heading"></a></h2>
<p>Við látum <span class="math notranslate nohighlight">\(N\)</span> tákna fjölda punkta eða <span class="math notranslate nohighlight">\(n\)</span>-vigra sem á að skipta í
<span class="math notranslate nohighlight">\(k\)</span> hópa og látum svo <span class="math notranslate nohighlight">\(G_j\)</span> vera mengi með númerum þeirra punkta
sem eru i <span class="math notranslate nohighlight">\(j\)</span>-ta hópnum. Tökum sem dæmi að 7 punktum sé skipt í 3
hópa, með <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_3\)</span> og <span class="math notranslate nohighlight">\(x_5\)</span> í fyrsta hópnum,
<span class="math notranslate nohighlight">\(x_2\)</span> og <span class="math notranslate nohighlight">\(x_4\)</span> í hópi 2 og <span class="math notranslate nohighlight">\(x_6\)</span> og <span class="math notranslate nohighlight">\(x_7\)</span> í þeim
þriðja. Þá verður:</p>
<div class="math notranslate nohighlight">
\[G_1 = \{1, 3, 5\},\quad G_2 = \{2, 4\}\quad\text{og}\quad G_3 = \{6, 7\}\]</div>
<p>Við skilgreinum líka vigur <span class="math notranslate nohighlight">\(c\)</span> með <span class="math notranslate nohighlight">\(c_i = {}\)</span> númer hópsins sem
<span class="math notranslate nohighlight">\(x_i\)</span> lendir í. Fyrir dæmið okkar verður</p>
<div class="math notranslate nohighlight">
\[c = (1, 2, 1, 2, 1, 3, 3)\]</div>
<p>Vigurinn <span class="math notranslate nohighlight">\(c\)</span> svarar til Python-breytunnar <code class="code docutils literal notranslate"><span class="pre">code</span></code> í grein <a class="reference internal" href="#kmeans"><span class="std std-numref">3.6</span></a>.</p>
</section>
<section id="mipunktar-hopa">
<span id="id1"></span><h2><span class="section-number">3.4  </span>Miðpunktar hópa<a class="headerlink" href="#mipunktar-hopa" title="Permalink to this heading"></a></h2>
<p><strong>Miðpunktur</strong> (<em>centroid</em>) fyrir hóp er punktur sem líkist punktunum í hópnum,
en hann þarf samt ekki að vera sjálfur í hópnum. Í k-means reikniritinu sem við
lýsum nákvæmlega hér að neðan er miðpunktur hóps reiknaður sem meðaltal af öllum
punktum í hópnum. Ef <span class="math notranslate nohighlight">\(G_1,\ldots,G_k\)</span> er flokkun <span class="math notranslate nohighlight">\(x_1,\ldots,x_N\)</span> og stærð
<span class="math notranslate nohighlight">\(j\)</span>-ta hópsins er <span class="math notranslate nohighlight">\(p_j\)</span> þá má reikna miðpunkta hópanna með:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\textit{Reikna-miðpunkta:}\\[3pt]
&amp;\textbf{Fyrir } j = 1,\ldots,k: \\
&amp;\qquad m_j := \frac{1}{p_j} \sum_{i \in G_j}{} x_i\end{split}\]</div>
<p>Í tvívíðu og þrívíðu rúmi þá er miðpunktur reiknaður með þessum hætti sá sami
og eðlisfræðileg þungamiðja punktasafnsins. Ef þungir hlutir væru festir á létt
(tvívítt) spjald, á staði sem svara til punktasafns, þá mundi spjaldið
ballansera á þungamiðjunni. Athugið að fyrir þrívíða punkta t.d. er hægt að láta
<span class="math notranslate nohighlight">\(\overline x\)</span>, <span class="math notranslate nohighlight">\(\overline y\)</span> og <span class="math notranslate nohighlight">\(\overline z\)</span> vera meðaltöl
<span class="math notranslate nohighlight">\(x\)</span>-, <span class="math notranslate nohighlight">\(y\)</span>- og <span class="math notranslate nohighlight">\(z\)</span>-hnita punktanna og þá verður
<span class="math notranslate nohighlight">\((\overline x, \overline y, \overline z)\)</span> miðpunkturinn.</p>
<figure class="align-center" id="id3" style="width: 7cm">
<img alt="../_images/%C3%BEungami%C3%B0ja.png" src="../_images/%C3%BEungami%C3%B0ja.png" />
<figcaption>
<p><span class="caption-number">Mynd 3.2: </span><span class="caption-text">Þungamiðja spjalds með punktmössum</span><a class="headerlink" href="#id3" title="Varanlegur hlekkur á þessa mynd"></a></p>
</figcaption>
</figure>
<div class="synidaemi admonition">
<p class="admonition-title">Sýnidæmi: Miðpunktur punktasafns</p>
<p>Miðpunktur eða meðaltal <span class="math notranslate nohighlight">\(\{(1,3,4), (2,6,8), (3,6,9)\}\)</span> er
<span class="math notranslate nohighlight">\(\frac{1}{3}(1 + 2 + 3, 3 + 6 + 6, 4 + 8 + 9)\)</span> =
<span class="math notranslate nohighlight">\(\frac{1}{3}(6,15,21)\)</span> = <span class="math notranslate nohighlight">\((2,5,7)\)</span>.</p>
</div>
<div class="aefing admonition">
<p class="admonition-title">Æfing: Punktar í planinu og miðpunktur þeirra</p>
<p>Finnið miðpunkt fyrir punktana <span class="math notranslate nohighlight">\((1,1), (1,2), (2,4)\)</span> og <span class="math notranslate nohighlight">\((4,5)\)</span>.
Merkið punktana og meðaltalið inn í hnitakerfi.</p>
</div>
</section>
<section id="besta-hopaskipting">
<span id="id2"></span><h2><span class="section-number">3.5  </span>Besta hópaskipting<a class="headerlink" href="#besta-hopaskipting" title="Permalink to this heading"></a></h2>
<p>Fyrir <span class="math notranslate nohighlight">\(N\)</span> punkta, <span class="math notranslate nohighlight">\(x_1, \ldots, x_N\)</span> og <span class="math notranslate nohighlight">\(k\)</span> gefna
miðpunkta, <span class="math notranslate nohighlight">\(m_1, \ldots, m_k\)</span> er hægt að reikna svokallaða bestu
hópaskiptingu með eftirfarandi reikniriti:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\DeclareMathOperator*{\argmin}{argmin}
&amp;\textit{Besta-skipting:}\\[3pt]
&amp;G_h := \varnothing\;\; (h = 1,\ldots, k) \\
&amp;\textbf{Fyrir } i = 1,\ldots,N: \\
&amp;\qquad h := \argmin_{1 \leq j\leq k} \|x_i - m_j\| \\
&amp;\qquad G_h := G_h \cup \{i\}\end{split}\]</div>
<p>Með öðrum orðum finnum við fyrir hvern punkt þann miðpunkt sem er næstur og
setjum svo punktinn í tilsvarandi hóp. Stundum eru miðpunktarnir kallaðir
<em>fulltrúar</em> og þá má segja að hver einstaklingur lendi í hópi þess fulltrúa
sem er líkastur honum. Þetta minnir á kosningapróf sem ýmsir vefmiðlar bjóða í
aðdraganda kosninga, þar sem hægt er að finna út hvaða flokk maður ætti að kjósa
með því bera svör manns saman við svör frambjóðenda við sömu spurningum.</p>
<div class="aefing admonition">
<p class="admonition-title">Æfing: Besta hópaskipting með blaði og blýanti</p>
<p>Merkið 10 punkta af handahófi á blað ásamt 3 miðpunktum og búið til bestu
hópaskiptingu.</p>
</div>
</section>
<section id="k-means-reikniriti">
<span id="kmeans"></span><h2><span class="section-number">3.6  </span>k-means reikniritið<a class="headerlink" href="#k-means-reikniriti" title="Permalink to this heading"></a></h2>
<p>Eftir undirbúning í síðustu tveimur greinum er framsetning <em>k-means</em>
reikniritsins afar einföld. Það felst einfaldlega í að reikna aftur og aftur
bestu skiptingu fyrir gefna miðpunkta, og endurreikna miðpunktana fyrir
skiptinguna sem kom út. Hér er þetta aðeins formlegra:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\textit{k-means:}\\[3pt]
&amp;\text{Veljum einhverja miðpunkta }m_1, \ldots, m_k \\
&amp;\textbf{Lykkja}\text{ þar til samleitni náð:} \\
&amp;\qquad \text{Ákvörðum skiptingu með reikniriti }\textit{Besta-skipting}\\
&amp;\qquad \text{Ákvörðum nýja miðpunkta með reikniriti }\textit{Reikna-miðpunkta}\end{split}\]</div>
<p>Það eru ýmsar aðferðir til að velja upphafsgildi miðpunktanna í fyrsta skrefinu.
Ein einföld leið er að velja þá af handahófi úr punktasafninu, og önnur er sú að
skipta safninu af handahófi í <span class="math notranslate nohighlight">\(k\)</span> hópa og velja upphafsgildi <span class="math notranslate nohighlight">\(m_j\)</span>
sem meðaltal <span class="math notranslate nohighlight">\(j\)</span>-ta hóps. Samkvæmt <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">Wikipedíugreininni um k-means</a> þá er aðferð kennd
við Bradley og Fayyad betri og sömuleiðis aðferð nefnd <em>k-means++</em>.</p>
<p>Markmiðið með reikniritinu er að reyna að finna skiptingu sem lágmarkar markfallið:</p>
<div class="math notranslate nohighlight">
\[d = \sum_{j=1}^k \sum_{i \in G_j} \|x_i - m_j\|^2\]</div>
<p>Hægt er að sýna fram á að markfallið minnkar eða stendur í stað í hverju skrefi,
og þar sem það er takmarkað að neðan (verður aldrei minna en 0) og það eru bara
endanlega margar flokkanir til þá kemur að því að við tökum skref sem breytir
markfallinu ekki. Oftast er ítrekuninni samt hætt fyrr, þegar markfallið
breytist um minna en einhver fyrirfram ákveðinn þröskuldur. Þetta gefur
nokkurskonar staðbundið lággildi, og stundum er reikniritið framkvæmt nokkrum
sinnum með mismunandi byrjunarval á miðpunktunum, og svo valin sú skipting sem
endar í besta gildi á markfallinu.</p>
<div class="python admonition">
<p class="admonition-title">Python:</p>
<p>Í Scipy er pakki sem heitir <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/cluster.vq.html">scipy.cluster.vq</a> sem geymir
föll til að flokka vigra. Aðalfallið heitir <code class="code docutils literal notranslate"><span class="pre">kmeans</span></code> en auk þess eru
hjálparföll, sér í lagi <code class="code docutils literal notranslate"><span class="pre">vq</span></code> og <code class="code docutils literal notranslate"><span class="pre">whiten</span></code>. Scipy skjölunin kallar
vigrana sem flokkaðir eru <em>observations</em> (a.m.k. stundum) og stökin í þeim
<em>features</em>. Vörpun frá miðpunktum yfir í hópa er kölluð <em>code book</em> sem þýðir
upphaflega <em>dulmálslykill</em>. Hún er útfærð með fylki þar sem röð nr. <span class="math notranslate nohighlight">\(i\)</span> er
miðpunktur fyrir hóp nr. <span class="math notranslate nohighlight">\(i\)</span>. Orðið <em>code</em> er svo notað um <em>hópnúmer</em>.
Markfallið er kallað <em>distortion</em>. Eins og sést hér á eftir skilar fallið
<cite>kmeans</cite> bara miðpunktum fyrir flokkunargögn og svo þarf að kalla á <cite>vq</cite> til
að finna hópnúmer hvers og eins. Hér er dæmigerð notkun þessara falla:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.vq</span> <span class="kn">import</span> <span class="n">kmeans</span><span class="p">,</span> <span class="n">vq</span>
<span class="n">X</span> <span class="o">=</span> <span class="o">...</span>                  <span class="c1"># búa til gögn / lesa úr skrá</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>                    <span class="c1"># Fjöldi hópa</span>
<span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># Skilar cb = codebook (5 línu fylki með miðpunktum)</span>
                         <span class="c1"># og d = lokagildi markfalls</span>
<span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">dvec</span><span class="p">)</span> <span class="o">=</span> <span class="n">vq</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">cb</span><span class="p">)</span> <span class="c1"># code[i] = hópnúmer vigurs í i-tu línu X,</span>
                         <span class="c1"># dvec[i] = fjarlægð hans frá sínum miðpunkti</span>
</pre></div>
</div>
</div>
<div class="athugid admonition">
<p class="admonition-title">Athugasemd: Um skömmtun</p>
<p><cite>Vq</cite> stendur fyrir <em>vector quantization</em>, en bein þýðing væri
<em>vigurskömmtun</em>. Skömmtun (<em>quantization</em>) er hugtak í eðlisfræði sem snýst
t.d. um að orka rafeindar í vetnisatómi getur bara tekið tiltekin strjál
(<em>discrete</em>) gildi. Sama hugtak er svo notað í tölvunarfræði, t.d. þegar við
fækkum litum í litmynd úr milljónum í 256 eða 16, eða þegar við látum
þungamiðju eða miðpunkt hóps koma í stað hópsins alls.</p>
</div>
<div class="synidaemi admonition">
<p class="admonition-title">Sýnidæmi: Hópaskipting með forriti</p>
<p>Hér er forrit sem býr til 30 slembipunkta í planinu og skiptir þeim svo í 3
hópa, og prentar út og teiknar niðurstöðuna. Miðpunktar eru teiknaðir með
stjörnum.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># UNDIRBÚNINGUR</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">numpy.random</span> <span class="k">as</span> <span class="nn">npr</span><span class="o">,</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.vq</span> <span class="kn">import</span> <span class="n">kmeans</span><span class="p">,</span> <span class="n">vq</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">floatmode</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">npr</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">npr</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># FLOKKUN</span>
<span class="p">(</span><span class="n">cb</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="n">code</span><span class="p">,</span><span class="n">dvec</span><span class="p">)</span> <span class="o">=</span> <span class="n">vq</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">cb</span><span class="p">)</span>

<span class="c1"># ÚTPRENTUN OG TEIKNING</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;codebook =</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">cb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;markfall = </span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;flokkun = </span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span>
<span class="p">(</span><span class="n">mx</span><span class="p">,</span><span class="n">my</span><span class="p">)</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># miðpunktar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">code</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Úttak:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">codebook</span> <span class="o">=</span>
 <span class="p">[[</span><span class="mf">0.461</span> <span class="mf">0.866</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.224</span> <span class="mf">0.291</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">0.815</span> <span class="mf">0.409</span><span class="p">]]</span>
<span class="n">markfall</span> <span class="o">=</span> <span class="mf">0.198</span>
<span class="n">flokkun</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<figure class="align-center" style="width: 9cm">
<img alt="../_images/kmeansd%C3%A6mi.png" src="../_images/kmeansd%C3%A6mi.png" />
</figure>
</div>
<div class="python admonition">
<p class="admonition-title">Python:</p>
<p>Til að fá góða liti á hópa sem teiknaðir eru með <em>scatter</em> er upplagt að nota
fallið <code class="docutils literal notranslate"><span class="pre">qcmap</span></code> úr <a class="reference internal" href="../vidauki-A/#litaskalar"><span class="std std-ref">kafla A4</span></a> í Viðauka A.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Æfing</p>
<ol class="arabic simple">
<li><p>Afritið forritið í sýnidæminu og prófið að keyra það með 5, 10 og 20
hópum með sjálfgefnu litunum.</p></li>
<li><p>Breytið nú forritinu þannig að <code class="docutils literal notranslate"><span class="pre">qcmap</span></code> sé notað til að velja liti og berið
saman við fyrri niðurstöðu.</p></li>
</ol>
</div>
</section>
<section id="daemi-um-nokkrar-k-means-itrekanir">
<h2><span class="section-number">3.7  </span>Dæmi um nokkrar k-means-ítrekanir<a class="headerlink" href="#daemi-um-nokkrar-k-means-itrekanir" title="Permalink to this heading"></a></h2>
<p>Til glöggvunar fylgja hér nokkrar myndir af niðurstöðum reikniritanna
<em>Besta-skipting</em> (t.v. í hverri mynd; sjá grein <a class="reference internal" href="#besta-hopaskipting"><span class="std std-numref">3.5</span></a>) og
<em>Reikna-miðpunkta</em> (t.h. í hverri mynd; sjá grein <a class="reference internal" href="#mipunktar-hopa"><span class="std std-numref">3.4</span></a>) þegar
k-means reikniritinu er beitt á dæmið sem sýnt er á <a class="reference internal" href="#flokkun300"><span class="std std-numref">Mynd 3.1:</span></a>.
Miðpunktar eru sýndir með ferningum</p>
<figure class="align-center" id="id4" style="width: 13cm">
<img alt="../_images/%C3%ADtrekun1.png" src="../_images/%C3%ADtrekun1.png" />
<figcaption>
<p><span class="caption-number">Mynd 3.3: </span><span class="caption-text">Dæmi um k-means, ítrekun 1</span><a class="headerlink" href="#id4" title="Varanlegur hlekkur á þessa mynd"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id5" style="width: 13cm">
<img alt="../_images/%C3%ADtrekun2.png" src="../_images/%C3%ADtrekun2.png" />
<figcaption>
<p><span class="caption-number">Mynd 3.4: </span><span class="caption-text">Dæmi um k-means, ítrekun 2</span><a class="headerlink" href="#id5" title="Varanlegur hlekkur á þessa mynd"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id6" style="width: 13cm">
<img alt="../_images/%C3%ADtrekun10.png" src="../_images/%C3%ADtrekun10.png" />
<figcaption>
<p><span class="caption-number">Mynd 3.5: </span><span class="caption-text">Dæmi um k-means, ítrekun 10</span><a class="headerlink" href="#id6" title="Varanlegur hlekkur á þessa mynd"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id7" style="width: 6cm">
<img alt="../_images/eftir-%C3%ADtrekun-15.png" src="../_images/eftir-%C3%ADtrekun-15.png" />
<figcaption>
<p><span class="caption-number">Mynd 3.6: </span><span class="caption-text">Dæmi um k-means, eftir 15 ítrekanir</span><a class="headerlink" href="#id7" title="Varanlegur hlekkur á þessa mynd"></a></p>
</figcaption>
</figure>
<p>Lokamyndin er sú sama og er í byrjun kaflans (<a class="reference internal" href="#flokkun300"><span class="std std-numref">Mynd 3.1:</span></a>). Hér er mynd sem sýnir hvernig markfallið (á <span class="math notranslate nohighlight">\(y\)</span>-ás) þróast með númeri
ítrekunar (á <span class="math notranslate nohighlight">\(x\)</span>-ás).</p>
<figure class="align-center" id="id8" style="width: 7cm">
<img alt="../_images/kmeansmarkfall.png" src="../_images/kmeansmarkfall.png" />
<figcaption>
<p><span class="caption-number">Mynd 3.7: </span><span class="caption-text">Markfall í k-means sem fall af númeri ítrekunar</span><a class="headerlink" href="#id8" title="Varanlegur hlekkur á þessa mynd"></a></p>
</figcaption>
</figure>
</section>
<section id="forvinnsla-vigra-me-whiten">
<h2><span class="section-number">3.8  </span>Forvinnsla vigra með <code class="code docutils literal notranslate"><span class="pre">whiten</span></code><a class="headerlink" href="#forvinnsla-vigra-me-whiten" title="Permalink to this heading"></a></h2>
<p>Ef stökin í vigrunum sem á að flokka hafa mjög mismunandi stærðargráðu getur
borgað sig að skala þau. Tökum sem dæmi að við ætlum að flokka menn eftir hæð og
þyngd, og hæðin sé í metrum en þyngdin í kílóum. Ef ekkert er gert mundu hæðirnar
hafa lítil sem engin áhrif á röðun í hópa. Hér væri hægt að staðla hæð og þyngd
með því að deila með staðalfrávikum hvors um sig áður en flokkað er.</p>
<div class="admonition note">
<p class="admonition-title">Python</p>
<p>Eitt af því sem vq-pakkinn býður upp á er fallið <code class="code docutils literal notranslate"><span class="pre">whiten</span></code> sem staðlar
hvert einkenni (hnit) með því að deila með staðalfráviki þess, svo
öll einkennin hafi staðalfrávik 1. Þannig mætti byrja forritsbútinn í síðustu
grein á:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.cluster.vq</span> <span class="kn">import</span> <span class="n">kmeans</span><span class="p">,</span> <span class="n">vq</span><span class="p">,</span> <span class="n">whiten</span>
<span class="n">X</span> <span class="o">=</span> <span class="o">...</span>                  <span class="c1"># búa til gögn / lesa úr skrá</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">whiten</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>            <span class="c1"># staðla gögn</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="admonition attention">
<p class="admonition-title">Athugið</p>
<p>Annar vinsæll Python-pakki sem m.a. getur flokkað er <em>Scikit-learn</em> (fluttur
inn með <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">sklearn.cluster</span></code> o.fl.). Þar er m.a. að finna mjög
vinsælan flokkara sem heitir <em>DBSCAN</em>. Hér er áhgugaverð <a class="reference external" href="https://scikit-learn.org/stable/auto_examples/cluster/plot_cluster_comparison.html">vefsíða með
flokkunarmyndum</a>
sem búnar eru til með ýmsum flokkurum úr Scikit-learn.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../kafli02/" class="btn btn-neutral float-left" title="2 Línuleg algebra" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../vidauki-A/" class="btn btn-neutral float-right" title="VIÐAUKI A: Python-teikning tvívíðra falla" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

<style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search,
    .wy-nav-top {
        background: #01447B;
    }

    /* Sidebar */
    .wy-nav-side {
        background: #343131;
    }
</style>




</body>
</html>